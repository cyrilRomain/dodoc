"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(typeof self !== 'undefined' ? self : this)["webpackHotUpdateapp"]("app",{

/***/ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/adc-core/fields/collaborative-editor/CollaborativeEditor2.vue?vue&type=script&lang=js&":
/*!******************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/adc-core/fields/collaborative-editor/CollaborativeEditor2.vue?vue&type=script&lang=js& ***!
  \******************************************************************************************************************************************************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.array.includes.js */ \"./node_modules/core-js/modules/es.array.includes.js\");\n/* harmony import */ var core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! core-js/modules/es.array.push.js */ \"./node_modules/core-js/modules/es.array.push.js\");\n/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var core_js_modules_es_string_replace_all_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! core-js/modules/es.string.replace-all.js */ \"./node_modules/core-js/modules/es.string.replace-all.js\");\n/* harmony import */ var core_js_modules_es_string_replace_all_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_string_replace_all_js__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _TextVersioning_vue__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TextVersioning.vue */ \"./src/adc-core/fields/collaborative-editor/TextVersioning.vue\");\n/* harmony import */ var reconnectingwebsocket__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! reconnectingwebsocket */ \"./node_modules/reconnectingwebsocket/reconnecting-websocket.js\");\n/* harmony import */ var reconnectingwebsocket__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(reconnectingwebsocket__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var sharedb_lib_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! sharedb/lib/client */ \"./node_modules/sharedb/lib/client/index.js\");\n/* harmony import */ var quill__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! quill */ \"./node_modules/quill/dist/quill.js\");\n/* harmony import */ var quill__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(quill__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _imports_defaults_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./imports/defaults.js */ \"./src/adc-core/fields/collaborative-editor/imports/defaults.js\");\n/* harmony import */ var _imports_MediaBlot__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./imports/MediaBlot */ \"./src/adc-core/fields/collaborative-editor/imports/MediaBlot.js\");\n/* harmony import */ var _imports_CardEditableModule__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./imports/CardEditableModule */ \"./src/adc-core/fields/collaborative-editor/imports/CardEditableModule.js\");\n\n\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n\nsharedb_lib_client__WEBPACK_IMPORTED_MODULE_5__.types.register((__webpack_require__(/*! rich-text */ \"./node_modules/rich-text/index.js\").type));\n\nvar Parchment = quill__WEBPACK_IMPORTED_MODULE_6___default()[\"import\"](\"parchment\");\nvar lineHeightConfig = {\n  scope: Parchment.Scope.BLOCK,\n  whitelist: _imports_defaults_js__WEBPACK_IMPORTED_MODULE_7__.lineHeightArr\n};\nvar lineHeightClass = new Parchment.Attributor.Class(\"lineheight\", \"ql-line-height\", lineHeightConfig);\nvar lineHeightStyle = new Parchment.Attributor.Style(\"lineheight\", \"line-height\", lineHeightConfig);\nParchment.register(lineHeightClass);\nParchment.register(lineHeightStyle);\nvar Size = quill__WEBPACK_IMPORTED_MODULE_6___default()[\"import\"](\"attributors/style/size\");\nSize.whitelist = _imports_defaults_js__WEBPACK_IMPORTED_MODULE_7__.fontSizeArr;\nquill__WEBPACK_IMPORTED_MODULE_6___default().register(Size, true);\nconst FontAttributor = quill__WEBPACK_IMPORTED_MODULE_6___default()[\"import\"](\"attributors/style/font\");\nconst custom_fonts_titles = window.app_infos.custom_fonts.map(cf => cf.title);\nconst all_fonts = _imports_defaults_js__WEBPACK_IMPORTED_MODULE_7__.fonts.concat(custom_fonts_titles);\nFontAttributor.whitelist = all_fonts;\nquill__WEBPACK_IMPORTED_MODULE_6___default().register(FontAttributor, true);\nvar BlockEmbed = quill__WEBPACK_IMPORTED_MODULE_6___default()[\"import\"](\"blots/block/embed\");\nclass DividerBlot extends BlockEmbed {}\nDividerBlot.blotName = \"divider\";\nDividerBlot.tagName = \"hr\";\nquill__WEBPACK_IMPORTED_MODULE_6___default().register(DividerBlot);\n\n\nquill__WEBPACK_IMPORTED_MODULE_6___default().register(\"formats/media\", _imports_MediaBlot__WEBPACK_IMPORTED_MODULE_8__[\"default\"]);\nquill__WEBPACK_IMPORTED_MODULE_6___default().register(\"modules/cardEditable\", _imports_CardEditableModule__WEBPACK_IMPORTED_MODULE_9__[\"default\"]);\n\n// how it works:\n// -> disabled by default\n// -> if is_collaborative is true, it uses sharedb on the server to handle conflict-free editing\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  props: {\n    path: String,\n    content: String,\n    scrollingContainer: HTMLElement,\n    custom_formats: Array,\n    line_selected: [Boolean, Number],\n    edit_on_mounted: Boolean,\n    can_edit: Boolean\n    // enabled for page_by_page, this means that the edit button is located in the top right corner in absolute,\n    // and that the toolbar moves to the closest parent dedicated container after creation\n  },\n\n  components: {\n    TextVersioning: _TextVersioning_vue__WEBPACK_IMPORTED_MODULE_3__[\"default\"]\n  },\n  data() {\n    return {\n      editor: null,\n      text_deltas: null,\n      toolbar_el: null,\n      rtc: {\n        socket: null,\n        connection_state: null\n      },\n      show_archives: false,\n      debounce_textUpdate: undefined,\n      is_collaborative: true,\n      collaborative_is_loaded: false,\n      autosave: true,\n      editor_is_enabled: false,\n      doc: undefined,\n      is_loading_or_saving: false,\n      is_disabling_editor: false,\n      show_saved_icon: false,\n      currently_selected_eles: false,\n      editor_id: (Math.random().toString(36) + \"00000000000000000\").slice(2, 5 + 5)\n    };\n  },\n  created() {},\n  async mounted() {\n    await this.initEditor();\n    this.toolbar_el = this.$el.querySelector(\".ql-toolbar\");\n    if (this.edit_on_mounted === true) this.enableEditor();\n  },\n  beforeDestroy() {\n    this.disableEditor();\n  },\n  watch: {\n    content() {\n      if (!this.is_collaborative || this.is_collaborative && !this.editor_is_enabled) {\n        this.$nextTick(() => {\n          debugger;\n          this.editor.root.innerHTML = this.content;\n        });\n      }\n    },\n    line_selected: {\n      handler() {\n        if (this.line_selected) {\n          // let [line, offset] = quill.getLine(this.line_selected);\n          this.$nextTick(() => {\n            const selected_line = this.editor.container.querySelector(`.ql-editor > *:nth-child(${this.line_selected})`);\n            this.currently_selected_eles = [selected_line];\n            this.$nextTick(() => {\n              selected_line.scrollIntoView({\n                behavior: \"smooth\",\n                block: \"center\",\n                inline: \"nearest\"\n              });\n            });\n          });\n        }\n        this.currently_selected_eles = false;\n      },\n      immediate: true\n    },\n    can_edit() {\n      if (!this.can_edit && this.editor_is_enabled) this.disableEditor();\n    },\n    currently_selected_eles(newEles) {\n      this.editor.container.querySelectorAll(\".is--selected\").forEach(el => el.classList && el.classList.remove(\"is--selected\"));\n      if (newEles) newEles.forEach(el => el.classList && el.classList.add(\"is--selected\"));\n    }\n  },\n  computed: {\n    quill_styles() {\n      let css = \"\";\n      for (const font of all_fonts) {\n        css += `\n.ql-picker.ql-font .ql-picker-label[data-value=\"${font}\"]::before,\n.ql-picker.ql-font .ql-picker-item[data-value=\"${font}\"]::before {\n  content: \"${font}\";\n  font-family: \"${font}\";\n}\n        `;\n      }\n      return css;\n    }\n  },\n  methods: {\n    async initEditor() {\n      const toolbar = this.makeToolbar();\n      this.editor = new (quill__WEBPACK_IMPORTED_MODULE_6___default())(this.$refs.editor, {\n        // debug: \"info\",\n        modules: {\n          cardEditable: true,\n          toolbar: toolbar\n        },\n        bounds: this.$refs.editor,\n        theme: \"snow\",\n        formats: this.custom_formats || _imports_defaults_js__WEBPACK_IMPORTED_MODULE_7__.formats,\n        placeholder: \"\",\n        readOnly: !this.editor_is_enabled,\n        scrollingContainer: this.scrollingContainer\n      });\n      if (this.content) this.editor.root.innerHTML = this.content;\n      this.setStatusButton();\n      this.editor.on(\"selection-change\", () => {\n        console.log(`CollaborativeEditor / selection-change`);\n        this.updateSelectedLines();\n      });\n      this.editor.on(\"text-change\", (delta, oldDelta, source) => {\n        delta, oldDelta, source;\n        console.log(`CollaborativeEditor / text-change w source ${source}`);\n        this.$nextTick(() => {\n          // todo : only update if possibly changing line (backspace and enter)\n          this.updateSelectedLines();\n        });\n      });\n    },\n    makeToolbar() {\n      let container = [];\n      let reference_formats = this.custom_formats || _imports_defaults_js__WEBPACK_IMPORTED_MODULE_7__.formats;\n      if (reference_formats.includes(\"font\")) container.push([{\n        font: all_fonts\n      }]);\n      if (reference_formats.includes(\"header\")) container.push([{\n        header: [false, 1, 2, 3]\n      }]);\n      if (reference_formats.includes(\"size\")) container.push([{\n        size: _imports_defaults_js__WEBPACK_IMPORTED_MODULE_7__.fontSizeArr\n      }]);\n      if (reference_formats.includes(\"lineheight\")) container.push([{\n        lineheight: _imports_defaults_js__WEBPACK_IMPORTED_MODULE_7__.lineHeightArr\n      }]);\n      let formatting_opt = [];\n      const basic_formatting = [\"bold\", \"italic\", \"underline\", \"strike\", \"link\", \"blockquote\"];\n      basic_formatting.map(bf => {\n        if (reference_formats.includes(bf)) formatting_opt.push(bf);\n      });\n      container.push(formatting_opt);\n      if (reference_formats.includes(\"color\")) container.push([{\n        color: [\"#000000\", \"#353535\", \"#b9b9b9\", \"#fff\", \"#1d327f\", \"#52c5b9\", \"#ffbe32\", \"#fc4b60\", \"#ff3333\", \"#08cc11\", \"#1c52ee\", \"#ff9c33\", \"#000000\", \"#bdb3b3\", \"#ae1cee\", \"#fff933\", \"#a54a0f\"]\n      }]);\n      if (reference_formats.includes(\"background\")) container.push([{\n        background: [\"transparent\", \"#f1f1f1\", \"#b9b9b9\", \"#bec6e5\", \"#a5e5da\", \"#ffd892\", \"#ff808c\", \"#ff3333\", \"#08cc11\", \"#1c52ee\", \"#ff9c33\", \"#000000\", \"#bdb3b3\", \"#ae1cee\", \"#fff933\", \"#a54a0f\"]\n      }]);\n      if (reference_formats.includes(\"list\")) container.push([{\n        list: \"ordered\"\n      }, {\n        list: \"bullet\"\n      }]);\n      if (reference_formats.includes(\"align\")) container.push([{\n        align: \"\"\n      }, {\n        align: \"center\"\n      }, {\n        align: \"right\"\n      }, {\n        align: \"justify\"\n      }]);\n      if (reference_formats.includes(\"code-block\")) container.push([\"code-block\"]);\n\n      // todo divider\n      container.push([\"clean\"]);\n      let handlers = {\n        divider: function () {\n          var range = this.quill.getSelection();\n          if (range) {\n            this.quill.insertEmbed(range.index, \"divider\", \"null\", (quill__WEBPACK_IMPORTED_MODULE_6___default().sources.USER));\n          }\n        },\n        line_height_select: function (new_line_height) {\n          new_line_height;\n          // var range = this.quill.getSelection();\n          // if (range) {\n          //   debugger;\n          //   this.quill.format(\n          //     range.index,\n          //     range.length,\n          //     \"line-height\",\n          //     +new_line_height,\n          //     \"user\"\n          //   );\n          // }\n        }\n      };\n\n      return {\n        container,\n        handlers\n      };\n    },\n    getEditorContent() {\n      console.log(`CollaborativeEditor • getEditorContent`);\n      if (!this.editor.getText() || this.editor.getText() === \"\\n\") return \"\";\n      let html = this.editor.root.innerHTML;\n      html = this.cleanEditorContent(html);\n      return html;\n    },\n    cleanEditorContent(html) {\n      console.log(`CollaborativeEditor • cleanEditorContent`);\n      var t = document.createElement(\"template\");\n      t.innerHTML = html;\n\n      // used to make sure we don’t get weird stuff such as <p style=\"font-family: \"Avada\";\">plop</p>\n      // content = content.replace(/&quot;/g, \"'\");\n      // todo : remove status class like is--selected or is--dragover\n      t.content.querySelectorAll(\".is--selected\").forEach(el => el.classList && el.classList.remove(\"is--selected\"));\n      return t.innerHTML;\n    },\n    setStatusButton() {\n      if (this.$refs.editBtn) this.$el.querySelector(\".ql-toolbar\").appendChild(this.$refs.editBtn);\n    },\n    toggleEdit() {\n      if (!this.editor_is_enabled) this.enableEditor();else this.disableEditor();\n    },\n    async enableEditor() {\n      if (this.editor_is_enabled || !this.can_edit) return false;\n      console.log(`CollaborativeEditor2 • enableEditor`);\n      if (this.is_collaborative) await this.startCollaborative();\n      this.editor.enable();\n      this.editor.focus();\n\n      // todo select latest used font as selected font\n      if (this.editor.getLength() <= 1) {\n        const fontLastUsed = localStorage.getItem(\"fontLastUsed\");\n        this.editor.format(\"font\", fontLastUsed);\n      }\n      this.editor.setSelection(this.editor.getLength(), (quill__WEBPACK_IMPORTED_MODULE_6___default().sources.SILENT));\n      this.$emit(`contentIsEdited`, this.toolbar_el);\n      this.editor_is_enabled = true;\n    },\n    async disableEditor() {\n      if (!this.editor_is_enabled) return false;\n      console.log(`CollaborativeEditor2 • disableEditor`);\n      this.is_disabling_editor = true;\n      this.editor.setSelection(null);\n      this.editor.blur();\n      this.updateSelectedLines();\n      if (this.is_collaborative) this.endCollaborative();\n      await this.saveText();\n\n      // check if toolbar is away, get it back if it is\n      this.getToolbarBack();\n      this.$emit(`contentIsNotEdited`);\n      this.$nextTick(() => {\n        this.editor.disable();\n        this.editor_is_enabled = false;\n        this.is_disabling_editor = false;\n      });\n    },\n    getToolbarBack() {\n      if (!this.toolbar_el.parentElement.classList.contains(\"_toolbarAndEditorContainer\")) this.$el.querySelector(\"._toolbarAndEditorContainer\").prepend(this.toolbar_el);\n    },\n    restoreVersion(content) {\n      // TODO : with delta to allow for undo\n      // this.editor.root.innerHTML = content;\n      const value = content;\n      const delta = this.editor.clipboard.convert(value);\n      this.editor.setContents(delta, \"user\");\n      this.show_archives = false;\n    },\n    editorClick($event) {\n      // $event.preventDefault();\n      if ($event.target.parentElement && $event.target.parentElement.classList && $event.target.parentElement.classList.contains(\"ql-editor\")) {\n        // click on the left of the element\n        if ($event.offsetX < 0) {\n          const line_number = Array.from($event.target.parentElement.children).findIndex(c => c === $event.target);\n          this.$emit(\"lineClicked\", line_number + 1);\n        }\n      }\n    },\n    updateSelectedLines() {\n      // console.log(`CollaborativeEditor • updateSelectedLines`);\n      if (!this.editor_is_enabled) return;\n      const range = this.editor.getSelection();\n      if (range && range.index) {\n        // console.log(\n        //   `CollaborativeEditor • updateSelectedLines / range.index = ${range.index} et range.length = ${range.length} `\n        // );\n\n        let blots = [];\n        if (range.length === 0) blots = [this.editor.getLine(range.index)[0]];else blots = this.editor.getLines(range.index, range.length);\n        if (blots) {\n          this.currently_selected_eles = blots.map(b => b.domNode);\n          return;\n        }\n      }\n      this.currently_selected_eles = false;\n    },\n    async saveText() {\n      const new_meta = {\n        $content: this.getEditorContent()\n      };\n      try {\n        this.is_loading_or_saving = true;\n        await this.$api.updateMeta({\n          path: this.path,\n          new_meta\n        });\n        this.is_loading_or_saving = false;\n        this.show_saved_icon = true;\n        await new Promise(r => setTimeout(r, 1500));\n        this.show_saved_icon = false;\n      } catch (err) {\n        if (err.message === \"content not changed\") err;\n        this.is_loading_or_saving = false;\n      }\n    },\n    async startCollaborative() {\n      return new Promise((resolve, reject) => {\n        // const params = new URLSearchParams({\n        //   folder_type: this.folder_type,\n        //   folder_slug: this.folder_slug,\n        //   meta_slug: this.meta_slug,\n        // });\n\n        // const requested_querystring = \"?\" + params.toString();\n        const path_to_meta = this.path.replaceAll(\"/\", \"*\");\n        const requested_resource_url = (location.protocol === \"https:\" ? \"wss\" : \"ws\") + \"://\" + window.location.host + \"/isSharedb\" + `?path_to_meta=${path_to_meta}`;\n        console.log(`CollaborativeEditor / startCollaborative : will connect to ws server with ${requested_resource_url}`);\n        this.rtc.socket = new (reconnectingwebsocket__WEBPACK_IMPORTED_MODULE_4___default())(requested_resource_url);\n        const connection = new sharedb_lib_client__WEBPACK_IMPORTED_MODULE_5__.Connection(this.rtc.socket);\n        connection.on(\"state\", state => {\n          this.rtc.connection_state = state.toString();\n        });\n        console.log(`CollaborativeEditor / connecting to doc ${path_to_meta}`);\n        this.doc = connection.get(\"collaborative_texts\", path_to_meta);\n        this.doc.subscribe(err => {\n          if (err) console.error(`CollaborativeEditor / err ${err}`);\n          console.log(`CollaborativeEditor / doc subscribe`);\n          if (this.doc.type) {\n            console.log(`CollaborativeEditor / doc already exists and doc.data = ${JSON.stringify(this.doc.data)}`);\n            this.editor.setContents(this.doc.data, \"init\");\n          } else {\n            this.doc.create(this.editor.getContents(), \"rich-text\");\n          }\n          this.editor.history.clear();\n          this.editor.on(\"text-change\", this.submitOPAndSave);\n          this.doc.on(\"op\", (op, source) => {\n            console.log(`CollaborativeEditor / op applied`);\n            this.text_deltas = this.doc.data;\n            if (source === this.editor_id) return;\n            console.log(`CollaborativeEditor / outside op applied`);\n            this.editor.updateContents(op);\n          });\n          this.collaborative_is_loaded = true;\n          return resolve();\n        });\n        this.doc.on(\"error\", err => {\n          // err;\n          // soucis : les situations ou le serveur a été fermé et en le rouvrant il ne possède plus d’instance du doc dans sharedb…\n          console.error(`CollaborativeEditor / doc err ${err}`);\n          this.$alertify.delay(4000).error(err);\n          this.collaborative_is_loaded = true;\n          return reject(err);\n        });\n      });\n    },\n    endCollaborative() {\n      if (this.rtc.socket) this.rtc.socket.close();\n      if (this.doc) {\n        this.doc.unsubscribe();\n        this.doc = null;\n      }\n      this.editor.off(\"text-change\", this.submitOPAndSave);\n      this.collaborative_is_loaded = false;\n    },\n    submitOPAndSave(delta, oldDelta, source) {\n      console.log(`CollaborativeEditor / submitOPAndSave w source ${source}`);\n      if (source === \"user\") {\n        this.doc.submitOp(delta, {\n          source: this.editor_id\n        });\n        console.log(`CollaborativeEditor / submitted op to server ${JSON.stringify(delta)}`);\n        this.updateTextMedia();\n      }\n    },\n    updateTextMedia() {\n      if (this.debounce_textUpdate) clearTimeout(this.debounce_textUpdate);\n      this.is_loading_or_saving = true;\n      this.debounce_textUpdate = setTimeout(async () => {\n        console.log(`CollaborativeEditor • updateTextMedia: saving new snapshot`);\n        await this.saveText();\n        const {\n          font\n        } = this.editor.getFormat();\n        localStorage.setItem(\"fontLastUsed\", font);\n      }, 1000);\n    },\n    addMediaAtTheEnd(media) {\n      this.addMediaAtIndex(this.editor.getLength() - 1, media);\n    },\n    addMediaAtCaretPosition(media) {\n      const selection = this.editor.getSelection(true);\n      if (selection && selection.index) {\n        this.addMediaAtIndex(selection.index, media);\n        return;\n      }\n      this.addMediaAtTheEnd(media);\n    },\n    addMediaAtIndex(index, media) {\n      console.log(`CollaborativeEditor • addMediaAtIndex ${index}`);\n      // TODO fix\n      const mediaURL = `./${this.folder_slug}/${media.media_filename}`;\n      // const mediaURL =\n      //   this.$root.state.mode === \"export_publication\"\n      //     ? `./${this.folder_slug}/${media.media_filename}`\n      //     : `/${this.folder_slug}/${media.media_filename}`;\n\n      // setting editor focus and selection can cause the scroll to \"jump\"\n      // not exactly a good idea…\n      // this.editor.setSelection(index, Quill.sources.SILENT);\n      // this.editor.focus();\n\n      this.editor.blur();\n      const {\n        $type,\n        caption,\n        $path\n      } = media;\n      $path;\n      if ($type === \"image\") {\n        const thumb_path = media.$thumbs[1600];\n        if (thumb_path) {\n          // this.editor.insertText(index, \"\\n\", Quill.sources.USER);\n          this.editor.insertEmbed(index, \"media\", {\n            type: $type,\n            caption\n            // TODO update with $path\n            // meta_filename: $slug,\n            // src: `/thumbs/${this.folder_type}/${this.folder_slug}/${thumb_path}`,\n          }, (quill__WEBPACK_IMPORTED_MODULE_6___default().sources.USER));\n          // this.editor.setSelection(index + 1, Quill.sources.SILENT);\n        }\n      } else if ($type === \"video\") {\n        // this.editor.insertText(index, \"\\n\", Quill.sources.USER);\n        this.editor.insertEmbed(index, \"media\", {\n          type: $type,\n          caption,\n          // TODO update with $path\n          meta_filename: $path,\n          src: mediaURL\n        }, (quill__WEBPACK_IMPORTED_MODULE_6___default().sources.USER));\n        // this.editor.setSelection(index + 1, Quill.sources.SILENT);\n      } else if ($type === \"audio\") {\n        this.editor.insertEmbed(index, \"media\", {\n          type: $type,\n          caption,\n          // TODO update with $path\n          meta_filename: $path,\n          src: mediaURL\n        }, (quill__WEBPACK_IMPORTED_MODULE_6___default().sources.USER));\n      } else {\n        this.$alertify.closeLogOnClick(true).delay(4000).error(this.$t(\"notifications.media_type_not_handled\"));\n      }\n    },\n    onDragover($event) {\n      if (!this.editor_is_enabled) return;\n      console.log(`CollaborativeEditor2 / onDragover`);\n      $event.preventDefault();\n      // todo debounce dragover to trigger only a handful of times per seconds\n      // const el = $event.target;\n      let _blot = this.getBlockFromElement($event.target);\n      if (!_blot) return false;\n\n      // do nothing if dragover on\n      // if (el.classList.contains(\"ql-editor\")) return;\n\n      // if (el.parentElement.classList.contains(\"ql-editor\")) {\n      if (!_blot.domNode.classList.contains(\"is--dragover\")) {\n        _blot.domNode.classList.add(\"is--dragover\");\n        _blot.domNode.addEventListener(\"dragleave\", () => {\n          console.log(`CollaborativeEditor2 / dragleave`);\n          _blot.domNode.classList.remove(\"is--dragover\");\n        });\n      }\n    },\n    // onDragLeave($event) {},\n    onDrop($event) {\n      if (!this.editor_is_enabled) return;\n      console.log(`CollaborativeEditor2 / onDrop`);\n\n      // Prevent default behavior (Prevent file from being opened)\n      $event.preventDefault();\n      $event.dataTransfer.dropEffect = \"move\";\n      this.removeDragoverFromBlots();\n      if ($event.dataTransfer.getData(\"text/plain\") === \"media_in_quill\") {\n        console.log(`CollaborativeEditor2 / onDrop : : drag and dropped a media from quill`);\n        let _blot = this.getBlockFromElement($event.target);\n        const index = this.editor.getIndex(_blot);\n\n        // find which blot was dragged (A)\n        // find where it was dropped (B)\n        // move delta from A to B\n\n        console.log(`_blot is currently at index ${index}`);\n      } else if ($event.dataTransfer.getData(\"text/plain\")) {\n        console.log(`CollaborativeEditor2 / onDrop : : dropped a media from the library`);\n        const media = JSON.parse($event.dataTransfer.getData(\"text/plain\"));\n        console.log(media);\n        if (media.media_filename) {\n          // drop sur l’éditor et pas sur une ligne\n          if ($event.target.classList.contains(\"ql-editor\")) {\n            console.log(\"dropped on editor and not on line, will insert at the end of doc\");\n            this.addMediaAtIndex(this.editor.getLength() - 1, media);\n            return;\n          }\n          let _blot = this.getBlockFromElement($event.target);\n          if (!_blot) {\n            this.$alertify.closeLogOnClick(true).delay(4000).error(this.$t(\"notifications.failed_to_find_block_line\"));\n            return;\n          }\n          _blot = _blot.next !== null && _blot.next.domNode ? _blot.next : _blot;\n          const index = this.editor.getIndex(_blot);\n          this.addMediaAtIndex(index - 1, media);\n        }\n      } else {\n        console.log(`CollaborativeEditor2 / onDrop : missing meta for drop to occur`);\n      }\n    },\n    removeDragoverFromBlots() {\n      this.editor.getLines().map(b => {\n        while (b.parent !== b.scroll) {\n          b = b.parent;\n          if (b === b.scroll) {\n            break;\n          }\n        }\n        if (b !== b.scroll && b.domNode) {\n          b.domNode.classList.remove(\"is--dragover\");\n        }\n      });\n    },\n    getBlockFromElement(_target) {\n      while (!_target.parentElement.classList.contains(\"ql-editor\")) {\n        _target = _target.parentElement;\n        if (_target === null || !_target.parentElement) break;\n      }\n      let _blot = quill__WEBPACK_IMPORTED_MODULE_6___default().find(_target);\n      if (_blot) return _blot;\n      return false;\n    }\n  }\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYmFiZWwtbG9hZGVyL2xpYi9pbmRleC5qcz8/Y2xvbmVkUnVsZVNldC0zN1swXS5ydWxlc1swXS51c2VbMF0hLi9ub2RlX21vZHVsZXMvQHZ1ZS92dWUtbG9hZGVyLXYxNS9saWIvaW5kZXguanM/P3Z1ZS1sb2FkZXItb3B0aW9ucyEuL3NyYy9hZGMtY29yZS9maWVsZHMvY29sbGFib3JhdGl2ZS1lZGl0b3IvQ29sbGFib3JhdGl2ZUVkaXRvcjIudnVlP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBdUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFvQkE7QUFFQTtBQUdBO0FBbUJBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUdBOztBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFRQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFPQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBSUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFJQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2FwcC9zcmMvYWRjLWNvcmUvZmllbGRzL2NvbGxhYm9yYXRpdmUtZWRpdG9yL0NvbGxhYm9yYXRpdmVFZGl0b3IyLnZ1ZT9lMjJlIl0sInNvdXJjZXNDb250ZW50IjpbIjx0ZW1wbGF0ZT5cbiAgPGRpdlxuICAgIGNsYXNzPVwiX2NvbGxhYm9yYXRpdmVFZGl0b3JcIlxuICAgIDpjbGFzcz1cIntcbiAgICAgICdpcy0tZWRpdGFibGUnOiBjYW5fZWRpdCxcbiAgICAgICdpcy0tZWRpdGluZ19pc19lbmFibGVkJzogZWRpdG9yX2lzX2VuYWJsZWQsXG4gICAgfVwiXG4gICAgQGNsaWNrPVwiZWRpdG9yQ2xpY2tcIlxuICA+XG4gICAgPFRleHRWZXJzaW9uaW5nXG4gICAgICB2LWlmPVwic2hvd19hcmNoaXZlc1wiXG4gICAgICA6cGF0aD1cInBhdGhcIlxuICAgICAgOmN1cnJlbnRfY29udGVudD1cImNvbnRlbnRcIlxuICAgICAgQGNsb3NlPVwic2hvd19hcmNoaXZlcyA9IGZhbHNlXCJcbiAgICAgIEByZXN0b3JlPVwicmVzdG9yZVZlcnNpb25cIlxuICAgIC8+XG5cbiAgICA8Y29tcG9uZW50IDppcz1cImBzdHlsZWBcIj5cbiAgICAgIHt7IHF1aWxsX3N0eWxlcyB9fVxuICAgIDwvY29tcG9uZW50PlxuXG4gICAgPGRpdlxuICAgICAgcmVmPVwiZWRpdEJ0blwiXG4gICAgICBjbGFzcz1cIl9URWJ0bkNvbnRhaW5lclwiXG4gICAgICB2LXNob3c9XCJjYW5fZWRpdCAmJiBlZGl0b3JfaXNfZW5hYmxlZFwiXG4gICAgPlxuICAgICAgPGRpdiBjbGFzcz1cIlwiPlxuICAgICAgICA8dGVtcGxhdGUgdi1pZj1cImVkaXRvcl9pc19lbmFibGVkICYmICFpc19kaXNhYmxpbmdfZWRpdG9yXCI+XG4gICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJfZWRpdEJ0blwiIEBjbGljaz1cInRvZ2dsZUVkaXRcIj5cbiAgICAgICAgICAgIDxzbC1pY29uIG5hbWU9XCJjaGVjay1jaXJjbGUtZmlsbFwiIDpsYWJlbD1cIiR0KCdzdG9wX2VkaXQnKVwiIC8+XG4gICAgICAgICAgICB7eyAkdChcInN0b3BfZWRpdFwiKSB9fVxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgY2xhc3M9XCJ1LWJ1dHRvbiBfYXJjaGl2ZXNCdG5cIlxuICAgICAgICAgICAgdi1pZj1cImVkaXRvcl9pc19lbmFibGVkXCJcbiAgICAgICAgICAgIEBjbGljaz1cInNob3dfYXJjaGl2ZXMgPSAhc2hvd19hcmNoaXZlc1wiXG4gICAgICAgICAgPlxuICAgICAgICAgICAgPHNsLWljb24gc2xvdD1cInByZWZpeFwiIG5hbWU9XCJhcmNoaXZlXCIgLz5cbiAgICAgICAgICAgIHt7ICR0KFwiYXJjaGl2ZXNcIikgfX1cbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPC90ZW1wbGF0ZT5cblxuICAgICAgICA8ZGl2IGNsYXNzPVwiX2NvbGxhYkVkaXRvclN0YXR1c1wiIHYtaWY9XCJlZGl0b3JfaXNfZW5hYmxlZFwiPlxuICAgICAgICAgIDx0cmFuc2l0aW9uIG5hbWU9XCJmYWRlX2Zhc3RcIiBtb2RlPVwib3V0LWluXCI+XG4gICAgICAgICAgICA8c3BhbiB2LWlmPVwiaXNfbG9hZGluZ19vcl9zYXZpbmdcIiBrZXk9XCJzYXZpbmdcIj5cbiAgICAgICAgICAgICAgPHNsLXNwaW5uZXIgc3R5bGU9XCItLWluZGljYXRvci1jb2xvcjogY3VycmVudENvbG9yXCIgLz5cbiAgICAgICAgICAgICAge3sgJHQoXCJzYXZpbmdcIikgfX1cbiAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgIDxzcGFuIHYtZWxzZS1pZj1cInNob3dfc2F2ZWRfaWNvblwiIGtleT1cInNhdmVkXCI+XG4gICAgICAgICAgICAgIDxzbC1pY29uIG5hbWU9XCJjaGVjay1jaXJjbGVcIiAvPlxuICAgICAgICAgICAgICB7eyAkdChcInNhdmVkXCIpIH19XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICA8c3BhbiB2LWVsc2Uga2V5PVwiY29ubmVjdGVkXCI+XG4gICAgICAgICAgICAgIDxiPnt7ICR0KHJ0Yy5jb25uZWN0aW9uX3N0YXRlKSB9fTwvYj5cbiAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICA8L3RyYW5zaXRpb24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8IS0tIDxzbC1idXR0b24gdi1zaG93PVwiZWRpdG9yX2lzX2VuYWJsZWRcIiBAY2xpY2s9XCJzYXZlVGV4dFwiIHNpemU9XCJzbWFsbFwiPlxuICAgICAgICAgIEVucmVnaXN0cmVyXG4gICAgICAgIDwvc2wtYnV0dG9uPiAtLT5cbiAgICA8L2Rpdj5cblxuICAgIDxkaXYgY2xhc3M9XCJfZmxvYXRpbmdFZGl0QnRuXCIgdi1pZj1cImNhbl9lZGl0XCI+XG4gICAgICA8c2wtYnV0dG9uXG4gICAgICAgIHZhcmlhbnQ9XCJlZGl0XCJcbiAgICAgICAgOmRhdGEtYWN0aW9uPVwiZWRpdG9yX2lzX2VuYWJsZWQgPyAnZGlzYWJsZScgOiAnZW5hYmxlJ1wiXG4gICAgICAgIHNpemU9XCJzbWFsbFwiXG4gICAgICAgIGNpcmNsZVxuICAgICAgICBAY2xpY2s9XCJ0b2dnbGVFZGl0XCJcbiAgICAgID5cbiAgICAgICAgPHNsLWljb25cbiAgICAgICAgICB2LWlmPVwiIWVkaXRvcl9pc19lbmFibGVkXCJcbiAgICAgICAgICBuYW1lPVwicGVuY2lsLWZpbGxcIlxuICAgICAgICAgIDpsYWJlbD1cIiR0KCdlZGl0JylcIlxuICAgICAgICAvPlxuICAgICAgICA8c2wtaWNvbiB2LWVsc2UgbmFtZT1cImNoZWNrLWNpcmNsZS1maWxsXCIgLz5cbiAgICAgIDwvc2wtYnV0dG9uPlxuICAgIDwvZGl2PlxuXG4gICAgPGRpdiBjbGFzcz1cIl90b29sYmFyQW5kRWRpdG9yQ29udGFpbmVyXCI+XG4gICAgICA8ZGl2IHJlZj1cImVkaXRvclwiIEBkcmFnb3Zlcj1cIm9uRHJhZ292ZXJcIiBAZHJvcD1cIm9uRHJvcFwiIC8+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuPC90ZW1wbGF0ZT5cbjxzY3JpcHQ+XG5pbXBvcnQgVGV4dFZlcnNpb25pbmcgZnJvbSBcIi4vVGV4dFZlcnNpb25pbmcudnVlXCI7XG5pbXBvcnQgUmVjb25uZWN0aW5nV2ViU29ja2V0IGZyb20gXCJyZWNvbm5lY3Rpbmd3ZWJzb2NrZXRcIjtcbmltcG9ydCBTaGFyZURCIGZyb20gXCJzaGFyZWRiL2xpYi9jbGllbnRcIjtcbmltcG9ydCBRdWlsbCBmcm9tIFwicXVpbGxcIjtcblNoYXJlREIudHlwZXMucmVnaXN0ZXIocmVxdWlyZShcInJpY2gtdGV4dFwiKS50eXBlKTtcblxuaW1wb3J0IHtcbiAgZm9udHMgYXMgZGVmYXVsdF9mb250cyxcbiAgZm9ybWF0cyBhcyBkZWZhdWx0X2Zvcm1hdHMsXG4gIGZvbnRTaXplQXJyLFxuICBsaW5lSGVpZ2h0QXJyLFxufSBmcm9tIFwiLi9pbXBvcnRzL2RlZmF1bHRzLmpzXCI7XG5cbnZhciBQYXJjaG1lbnQgPSBRdWlsbC5pbXBvcnQoXCJwYXJjaG1lbnRcIik7XG52YXIgbGluZUhlaWdodENvbmZpZyA9IHtcbiAgc2NvcGU6IFBhcmNobWVudC5TY29wZS5CTE9DSyxcbiAgd2hpdGVsaXN0OiBsaW5lSGVpZ2h0QXJyLFxufTtcbnZhciBsaW5lSGVpZ2h0Q2xhc3MgPSBuZXcgUGFyY2htZW50LkF0dHJpYnV0b3IuQ2xhc3MoXG4gIFwibGluZWhlaWdodFwiLFxuICBcInFsLWxpbmUtaGVpZ2h0XCIsXG4gIGxpbmVIZWlnaHRDb25maWdcbik7XG52YXIgbGluZUhlaWdodFN0eWxlID0gbmV3IFBhcmNobWVudC5BdHRyaWJ1dG9yLlN0eWxlKFxuICBcImxpbmVoZWlnaHRcIixcbiAgXCJsaW5lLWhlaWdodFwiLFxuICBsaW5lSGVpZ2h0Q29uZmlnXG4pO1xuUGFyY2htZW50LnJlZ2lzdGVyKGxpbmVIZWlnaHRDbGFzcyk7XG5QYXJjaG1lbnQucmVnaXN0ZXIobGluZUhlaWdodFN0eWxlKTtcbnZhciBTaXplID0gUXVpbGwuaW1wb3J0KFwiYXR0cmlidXRvcnMvc3R5bGUvc2l6ZVwiKTtcblNpemUud2hpdGVsaXN0ID0gZm9udFNpemVBcnI7XG5RdWlsbC5yZWdpc3RlcihTaXplLCB0cnVlKTtcblxuY29uc3QgRm9udEF0dHJpYnV0b3IgPSBRdWlsbC5pbXBvcnQoXCJhdHRyaWJ1dG9ycy9zdHlsZS9mb250XCIpO1xuY29uc3QgY3VzdG9tX2ZvbnRzX3RpdGxlcyA9IHdpbmRvdy5hcHBfaW5mb3MuY3VzdG9tX2ZvbnRzLm1hcCgoY2YpID0+IGNmLnRpdGxlKTtcbmNvbnN0IGFsbF9mb250cyA9IGRlZmF1bHRfZm9udHMuY29uY2F0KGN1c3RvbV9mb250c190aXRsZXMpO1xuRm9udEF0dHJpYnV0b3Iud2hpdGVsaXN0ID0gYWxsX2ZvbnRzO1xuUXVpbGwucmVnaXN0ZXIoRm9udEF0dHJpYnV0b3IsIHRydWUpO1xuXG52YXIgQmxvY2tFbWJlZCA9IFF1aWxsLmltcG9ydChcImJsb3RzL2Jsb2NrL2VtYmVkXCIpO1xuY2xhc3MgRGl2aWRlckJsb3QgZXh0ZW5kcyBCbG9ja0VtYmVkIHt9XG5EaXZpZGVyQmxvdC5ibG90TmFtZSA9IFwiZGl2aWRlclwiO1xuRGl2aWRlckJsb3QudGFnTmFtZSA9IFwiaHJcIjtcblF1aWxsLnJlZ2lzdGVyKERpdmlkZXJCbG90KTtcblxuaW1wb3J0IE1lZGlhQmxvdCBmcm9tIFwiLi9pbXBvcnRzL01lZGlhQmxvdFwiO1xuaW1wb3J0IENhcmRFZGl0YWJsZU1vZHVsZSBmcm9tIFwiLi9pbXBvcnRzL0NhcmRFZGl0YWJsZU1vZHVsZVwiO1xuXG5RdWlsbC5yZWdpc3RlcihcImZvcm1hdHMvbWVkaWFcIiwgTWVkaWFCbG90KTtcblF1aWxsLnJlZ2lzdGVyKFwibW9kdWxlcy9jYXJkRWRpdGFibGVcIiwgQ2FyZEVkaXRhYmxlTW9kdWxlKTtcblxuLy8gaG93IGl0IHdvcmtzOlxuLy8gLT4gZGlzYWJsZWQgYnkgZGVmYXVsdFxuLy8gLT4gaWYgaXNfY29sbGFib3JhdGl2ZSBpcyB0cnVlLCBpdCB1c2VzIHNoYXJlZGIgb24gdGhlIHNlcnZlciB0byBoYW5kbGUgY29uZmxpY3QtZnJlZSBlZGl0aW5nXG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgcHJvcHM6IHtcbiAgICBwYXRoOiBTdHJpbmcsXG4gICAgY29udGVudDogU3RyaW5nLFxuICAgIHNjcm9sbGluZ0NvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgY3VzdG9tX2Zvcm1hdHM6IEFycmF5LFxuICAgIGxpbmVfc2VsZWN0ZWQ6IFtCb29sZWFuLCBOdW1iZXJdLFxuICAgIGVkaXRfb25fbW91bnRlZDogQm9vbGVhbixcbiAgICBjYW5fZWRpdDogQm9vbGVhbixcbiAgICAvLyBlbmFibGVkIGZvciBwYWdlX2J5X3BhZ2UsIHRoaXMgbWVhbnMgdGhhdCB0aGUgZWRpdCBidXR0b24gaXMgbG9jYXRlZCBpbiB0aGUgdG9wIHJpZ2h0IGNvcm5lciBpbiBhYnNvbHV0ZSxcbiAgICAvLyBhbmQgdGhhdCB0aGUgdG9vbGJhciBtb3ZlcyB0byB0aGUgY2xvc2VzdCBwYXJlbnQgZGVkaWNhdGVkIGNvbnRhaW5lciBhZnRlciBjcmVhdGlvblxuICB9LFxuICBjb21wb25lbnRzOiB7XG4gICAgVGV4dFZlcnNpb25pbmcsXG4gIH0sXG4gIGRhdGEoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGVkaXRvcjogbnVsbCxcbiAgICAgIHRleHRfZGVsdGFzOiBudWxsLFxuICAgICAgdG9vbGJhcl9lbDogbnVsbCxcblxuICAgICAgcnRjOiB7XG4gICAgICAgIHNvY2tldDogbnVsbCxcbiAgICAgICAgY29ubmVjdGlvbl9zdGF0ZTogbnVsbCxcbiAgICAgIH0sXG5cbiAgICAgIHNob3dfYXJjaGl2ZXM6IGZhbHNlLFxuXG4gICAgICBkZWJvdW5jZV90ZXh0VXBkYXRlOiB1bmRlZmluZWQsXG5cbiAgICAgIGlzX2NvbGxhYm9yYXRpdmU6IHRydWUsXG4gICAgICBjb2xsYWJvcmF0aXZlX2lzX2xvYWRlZDogZmFsc2UsXG5cbiAgICAgIGF1dG9zYXZlOiB0cnVlLFxuICAgICAgZWRpdG9yX2lzX2VuYWJsZWQ6IGZhbHNlLFxuICAgICAgZG9jOiB1bmRlZmluZWQsXG5cbiAgICAgIGlzX2xvYWRpbmdfb3Jfc2F2aW5nOiBmYWxzZSxcbiAgICAgIGlzX2Rpc2FibGluZ19lZGl0b3I6IGZhbHNlLFxuICAgICAgc2hvd19zYXZlZF9pY29uOiBmYWxzZSxcblxuICAgICAgY3VycmVudGx5X3NlbGVjdGVkX2VsZXM6IGZhbHNlLFxuXG4gICAgICBlZGl0b3JfaWQ6IChNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KSArIFwiMDAwMDAwMDAwMDAwMDAwMDBcIikuc2xpY2UoXG4gICAgICAgIDIsXG4gICAgICAgIDUgKyA1XG4gICAgICApLFxuICAgIH07XG4gIH0sXG4gIGNyZWF0ZWQoKSB7fSxcbiAgYXN5bmMgbW91bnRlZCgpIHtcbiAgICBhd2FpdCB0aGlzLmluaXRFZGl0b3IoKTtcbiAgICB0aGlzLnRvb2xiYXJfZWwgPSB0aGlzLiRlbC5xdWVyeVNlbGVjdG9yKFwiLnFsLXRvb2xiYXJcIik7XG4gICAgaWYgKHRoaXMuZWRpdF9vbl9tb3VudGVkID09PSB0cnVlKSB0aGlzLmVuYWJsZUVkaXRvcigpO1xuICB9LFxuICBiZWZvcmVEZXN0cm95KCkge1xuICAgIHRoaXMuZGlzYWJsZUVkaXRvcigpO1xuICB9LFxuICB3YXRjaDoge1xuICAgIGNvbnRlbnQoKSB7XG4gICAgICBpZiAoXG4gICAgICAgICF0aGlzLmlzX2NvbGxhYm9yYXRpdmUgfHxcbiAgICAgICAgKHRoaXMuaXNfY29sbGFib3JhdGl2ZSAmJiAhdGhpcy5lZGl0b3JfaXNfZW5hYmxlZClcbiAgICAgICkge1xuICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7XG4gICAgICAgICAgZGVidWdnZXI7XG4gICAgICAgICAgdGhpcy5lZGl0b3Iucm9vdC5pbm5lckhUTUwgPSB0aGlzLmNvbnRlbnQ7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgbGluZV9zZWxlY3RlZDoge1xuICAgICAgaGFuZGxlcigpIHtcbiAgICAgICAgaWYgKHRoaXMubGluZV9zZWxlY3RlZCkge1xuICAgICAgICAgIC8vIGxldCBbbGluZSwgb2Zmc2V0XSA9IHF1aWxsLmdldExpbmUodGhpcy5saW5lX3NlbGVjdGVkKTtcbiAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZF9saW5lID0gdGhpcy5lZGl0b3IuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAgIGAucWwtZWRpdG9yID4gKjpudGgtY2hpbGQoJHt0aGlzLmxpbmVfc2VsZWN0ZWR9KWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRseV9zZWxlY3RlZF9lbGVzID0gW3NlbGVjdGVkX2xpbmVdO1xuICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4ge1xuICAgICAgICAgICAgICBzZWxlY3RlZF9saW5lLnNjcm9sbEludG9WaWV3KHtcbiAgICAgICAgICAgICAgICBiZWhhdmlvcjogXCJzbW9vdGhcIixcbiAgICAgICAgICAgICAgICBibG9jazogXCJjZW50ZXJcIixcbiAgICAgICAgICAgICAgICBpbmxpbmU6IFwibmVhcmVzdFwiLFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY3VycmVudGx5X3NlbGVjdGVkX2VsZXMgPSBmYWxzZTtcbiAgICAgIH0sXG4gICAgICBpbW1lZGlhdGU6IHRydWUsXG4gICAgfSxcbiAgICBjYW5fZWRpdCgpIHtcbiAgICAgIGlmICghdGhpcy5jYW5fZWRpdCAmJiB0aGlzLmVkaXRvcl9pc19lbmFibGVkKSB0aGlzLmRpc2FibGVFZGl0b3IoKTtcbiAgICB9LFxuICAgIGN1cnJlbnRseV9zZWxlY3RlZF9lbGVzKG5ld0VsZXMpIHtcbiAgICAgIHRoaXMuZWRpdG9yLmNvbnRhaW5lclxuICAgICAgICAucXVlcnlTZWxlY3RvckFsbChcIi5pcy0tc2VsZWN0ZWRcIilcbiAgICAgICAgLmZvckVhY2goKGVsKSA9PiBlbC5jbGFzc0xpc3QgJiYgZWwuY2xhc3NMaXN0LnJlbW92ZShcImlzLS1zZWxlY3RlZFwiKSk7XG5cbiAgICAgIGlmIChuZXdFbGVzKVxuICAgICAgICBuZXdFbGVzLmZvckVhY2goXG4gICAgICAgICAgKGVsKSA9PiBlbC5jbGFzc0xpc3QgJiYgZWwuY2xhc3NMaXN0LmFkZChcImlzLS1zZWxlY3RlZFwiKVxuICAgICAgICApO1xuICAgIH0sXG4gIH0sXG4gIGNvbXB1dGVkOiB7XG4gICAgcXVpbGxfc3R5bGVzKCkge1xuICAgICAgbGV0IGNzcyA9IFwiXCI7XG4gICAgICBmb3IgKGNvbnN0IGZvbnQgb2YgYWxsX2ZvbnRzKSB7XG4gICAgICAgIGNzcyArPSBgXG4ucWwtcGlja2VyLnFsLWZvbnQgLnFsLXBpY2tlci1sYWJlbFtkYXRhLXZhbHVlPVwiJHtmb250fVwiXTo6YmVmb3JlLFxuLnFsLXBpY2tlci5xbC1mb250IC5xbC1waWNrZXItaXRlbVtkYXRhLXZhbHVlPVwiJHtmb250fVwiXTo6YmVmb3JlIHtcbiAgY29udGVudDogXCIke2ZvbnR9XCI7XG4gIGZvbnQtZmFtaWx5OiBcIiR7Zm9udH1cIjtcbn1cbiAgICAgICAgYDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjc3M7XG4gICAgfSxcbiAgfSxcbiAgbWV0aG9kczoge1xuICAgIGFzeW5jIGluaXRFZGl0b3IoKSB7XG4gICAgICBjb25zdCB0b29sYmFyID0gdGhpcy5tYWtlVG9vbGJhcigpO1xuXG4gICAgICB0aGlzLmVkaXRvciA9IG5ldyBRdWlsbCh0aGlzLiRyZWZzLmVkaXRvciwge1xuICAgICAgICAvLyBkZWJ1ZzogXCJpbmZvXCIsXG4gICAgICAgIG1vZHVsZXM6IHtcbiAgICAgICAgICBjYXJkRWRpdGFibGU6IHRydWUsXG4gICAgICAgICAgdG9vbGJhcjogdG9vbGJhcixcbiAgICAgICAgfSxcbiAgICAgICAgYm91bmRzOiB0aGlzLiRyZWZzLmVkaXRvcixcbiAgICAgICAgdGhlbWU6IFwic25vd1wiLFxuICAgICAgICBmb3JtYXRzOiB0aGlzLmN1c3RvbV9mb3JtYXRzIHx8IGRlZmF1bHRfZm9ybWF0cyxcbiAgICAgICAgcGxhY2Vob2xkZXI6IFwiXCIsXG4gICAgICAgIHJlYWRPbmx5OiAhdGhpcy5lZGl0b3JfaXNfZW5hYmxlZCxcbiAgICAgICAgc2Nyb2xsaW5nQ29udGFpbmVyOiB0aGlzLnNjcm9sbGluZ0NvbnRhaW5lcixcbiAgICAgIH0pO1xuICAgICAgaWYgKHRoaXMuY29udGVudCkgdGhpcy5lZGl0b3Iucm9vdC5pbm5lckhUTUwgPSB0aGlzLmNvbnRlbnQ7XG5cbiAgICAgIHRoaXMuc2V0U3RhdHVzQnV0dG9uKCk7XG5cbiAgICAgIHRoaXMuZWRpdG9yLm9uKFwic2VsZWN0aW9uLWNoYW5nZVwiLCAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBDb2xsYWJvcmF0aXZlRWRpdG9yIC8gc2VsZWN0aW9uLWNoYW5nZWApO1xuICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGVkTGluZXMoKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5lZGl0b3Iub24oXCJ0ZXh0LWNoYW5nZVwiLCAoZGVsdGEsIG9sZERlbHRhLCBzb3VyY2UpID0+IHtcbiAgICAgICAgZGVsdGEsIG9sZERlbHRhLCBzb3VyY2U7XG4gICAgICAgIGNvbnNvbGUubG9nKGBDb2xsYWJvcmF0aXZlRWRpdG9yIC8gdGV4dC1jaGFuZ2UgdyBzb3VyY2UgJHtzb3VyY2V9YCk7XG4gICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHtcbiAgICAgICAgICAvLyB0b2RvIDogb25seSB1cGRhdGUgaWYgcG9zc2libHkgY2hhbmdpbmcgbGluZSAoYmFja3NwYWNlIGFuZCBlbnRlcilcbiAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGVkTGluZXMoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgbWFrZVRvb2xiYXIoKSB7XG4gICAgICBsZXQgY29udGFpbmVyID0gW107XG4gICAgICBsZXQgcmVmZXJlbmNlX2Zvcm1hdHMgPSB0aGlzLmN1c3RvbV9mb3JtYXRzIHx8IGRlZmF1bHRfZm9ybWF0cztcblxuICAgICAgaWYgKHJlZmVyZW5jZV9mb3JtYXRzLmluY2x1ZGVzKFwiZm9udFwiKSlcbiAgICAgICAgY29udGFpbmVyLnB1c2goW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZvbnQ6IGFsbF9mb250cyxcbiAgICAgICAgICB9LFxuICAgICAgICBdKTtcbiAgICAgIGlmIChyZWZlcmVuY2VfZm9ybWF0cy5pbmNsdWRlcyhcImhlYWRlclwiKSlcbiAgICAgICAgY29udGFpbmVyLnB1c2goW3sgaGVhZGVyOiBbZmFsc2UsIDEsIDIsIDNdIH1dKTtcbiAgICAgIGlmIChyZWZlcmVuY2VfZm9ybWF0cy5pbmNsdWRlcyhcInNpemVcIikpXG4gICAgICAgIGNvbnRhaW5lci5wdXNoKFt7IHNpemU6IGZvbnRTaXplQXJyIH1dKTtcbiAgICAgIGlmIChyZWZlcmVuY2VfZm9ybWF0cy5pbmNsdWRlcyhcImxpbmVoZWlnaHRcIikpXG4gICAgICAgIGNvbnRhaW5lci5wdXNoKFt7IGxpbmVoZWlnaHQ6IGxpbmVIZWlnaHRBcnIgfV0pO1xuXG4gICAgICBsZXQgZm9ybWF0dGluZ19vcHQgPSBbXTtcbiAgICAgIGNvbnN0IGJhc2ljX2Zvcm1hdHRpbmcgPSBbXG4gICAgICAgIFwiYm9sZFwiLFxuICAgICAgICBcIml0YWxpY1wiLFxuICAgICAgICBcInVuZGVybGluZVwiLFxuICAgICAgICBcInN0cmlrZVwiLFxuICAgICAgICBcImxpbmtcIixcbiAgICAgICAgXCJibG9ja3F1b3RlXCIsXG4gICAgICBdO1xuICAgICAgYmFzaWNfZm9ybWF0dGluZy5tYXAoKGJmKSA9PiB7XG4gICAgICAgIGlmIChyZWZlcmVuY2VfZm9ybWF0cy5pbmNsdWRlcyhiZikpIGZvcm1hdHRpbmdfb3B0LnB1c2goYmYpO1xuICAgICAgfSk7XG4gICAgICBjb250YWluZXIucHVzaChmb3JtYXR0aW5nX29wdCk7XG5cbiAgICAgIGlmIChyZWZlcmVuY2VfZm9ybWF0cy5pbmNsdWRlcyhcImNvbG9yXCIpKVxuICAgICAgICBjb250YWluZXIucHVzaChbXG4gICAgICAgICAge1xuICAgICAgICAgICAgY29sb3I6IFtcbiAgICAgICAgICAgICAgXCIjMDAwMDAwXCIsXG4gICAgICAgICAgICAgIFwiIzM1MzUzNVwiLFxuICAgICAgICAgICAgICBcIiNiOWI5YjlcIixcbiAgICAgICAgICAgICAgXCIjZmZmXCIsXG4gICAgICAgICAgICAgIFwiIzFkMzI3ZlwiLFxuICAgICAgICAgICAgICBcIiM1MmM1YjlcIixcbiAgICAgICAgICAgICAgXCIjZmZiZTMyXCIsXG4gICAgICAgICAgICAgIFwiI2ZjNGI2MFwiLFxuXG4gICAgICAgICAgICAgIFwiI2ZmMzMzM1wiLFxuICAgICAgICAgICAgICBcIiMwOGNjMTFcIixcbiAgICAgICAgICAgICAgXCIjMWM1MmVlXCIsXG4gICAgICAgICAgICAgIFwiI2ZmOWMzM1wiLFxuICAgICAgICAgICAgICBcIiMwMDAwMDBcIixcbiAgICAgICAgICAgICAgXCIjYmRiM2IzXCIsXG4gICAgICAgICAgICAgIFwiI2FlMWNlZVwiLFxuICAgICAgICAgICAgICBcIiNmZmY5MzNcIixcbiAgICAgICAgICAgICAgXCIjYTU0YTBmXCIsXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0pO1xuICAgICAgaWYgKHJlZmVyZW5jZV9mb3JtYXRzLmluY2x1ZGVzKFwiYmFja2dyb3VuZFwiKSlcbiAgICAgICAgY29udGFpbmVyLnB1c2goW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IFtcbiAgICAgICAgICAgICAgXCJ0cmFuc3BhcmVudFwiLFxuICAgICAgICAgICAgICBcIiNmMWYxZjFcIixcbiAgICAgICAgICAgICAgXCIjYjliOWI5XCIsXG4gICAgICAgICAgICAgIFwiI2JlYzZlNVwiLFxuICAgICAgICAgICAgICBcIiNhNWU1ZGFcIixcbiAgICAgICAgICAgICAgXCIjZmZkODkyXCIsXG4gICAgICAgICAgICAgIFwiI2ZmODA4Y1wiLFxuXG4gICAgICAgICAgICAgIFwiI2ZmMzMzM1wiLFxuICAgICAgICAgICAgICBcIiMwOGNjMTFcIixcbiAgICAgICAgICAgICAgXCIjMWM1MmVlXCIsXG4gICAgICAgICAgICAgIFwiI2ZmOWMzM1wiLFxuICAgICAgICAgICAgICBcIiMwMDAwMDBcIixcbiAgICAgICAgICAgICAgXCIjYmRiM2IzXCIsXG4gICAgICAgICAgICAgIFwiI2FlMWNlZVwiLFxuICAgICAgICAgICAgICBcIiNmZmY5MzNcIixcbiAgICAgICAgICAgICAgXCIjYTU0YTBmXCIsXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0pO1xuXG4gICAgICBpZiAocmVmZXJlbmNlX2Zvcm1hdHMuaW5jbHVkZXMoXCJsaXN0XCIpKVxuICAgICAgICBjb250YWluZXIucHVzaChbeyBsaXN0OiBcIm9yZGVyZWRcIiB9LCB7IGxpc3Q6IFwiYnVsbGV0XCIgfV0pO1xuXG4gICAgICBpZiAocmVmZXJlbmNlX2Zvcm1hdHMuaW5jbHVkZXMoXCJhbGlnblwiKSlcbiAgICAgICAgY29udGFpbmVyLnB1c2goW1xuICAgICAgICAgIHsgYWxpZ246IFwiXCIgfSxcbiAgICAgICAgICB7IGFsaWduOiBcImNlbnRlclwiIH0sXG4gICAgICAgICAgeyBhbGlnbjogXCJyaWdodFwiIH0sXG4gICAgICAgICAgeyBhbGlnbjogXCJqdXN0aWZ5XCIgfSxcbiAgICAgICAgXSk7XG5cbiAgICAgIGlmIChyZWZlcmVuY2VfZm9ybWF0cy5pbmNsdWRlcyhcImNvZGUtYmxvY2tcIikpXG4gICAgICAgIGNvbnRhaW5lci5wdXNoKFtcImNvZGUtYmxvY2tcIl0pO1xuXG4gICAgICAvLyB0b2RvIGRpdmlkZXJcbiAgICAgIGNvbnRhaW5lci5wdXNoKFtcImNsZWFuXCJdKTtcblxuICAgICAgbGV0IGhhbmRsZXJzID0ge1xuICAgICAgICBkaXZpZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIHJhbmdlID0gdGhpcy5xdWlsbC5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICBpZiAocmFuZ2UpIHtcbiAgICAgICAgICAgIHRoaXMucXVpbGwuaW5zZXJ0RW1iZWQoXG4gICAgICAgICAgICAgIHJhbmdlLmluZGV4LFxuICAgICAgICAgICAgICBcImRpdmlkZXJcIixcbiAgICAgICAgICAgICAgXCJudWxsXCIsXG4gICAgICAgICAgICAgIFF1aWxsLnNvdXJjZXMuVVNFUlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGxpbmVfaGVpZ2h0X3NlbGVjdDogZnVuY3Rpb24gKG5ld19saW5lX2hlaWdodCkge1xuICAgICAgICAgIG5ld19saW5lX2hlaWdodDtcbiAgICAgICAgICAvLyB2YXIgcmFuZ2UgPSB0aGlzLnF1aWxsLmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgIC8vIGlmIChyYW5nZSkge1xuICAgICAgICAgIC8vICAgZGVidWdnZXI7XG4gICAgICAgICAgLy8gICB0aGlzLnF1aWxsLmZvcm1hdChcbiAgICAgICAgICAvLyAgICAgcmFuZ2UuaW5kZXgsXG4gICAgICAgICAgLy8gICAgIHJhbmdlLmxlbmd0aCxcbiAgICAgICAgICAvLyAgICAgXCJsaW5lLWhlaWdodFwiLFxuICAgICAgICAgIC8vICAgICArbmV3X2xpbmVfaGVpZ2h0LFxuICAgICAgICAgIC8vICAgICBcInVzZXJcIlxuICAgICAgICAgIC8vICAgKTtcbiAgICAgICAgICAvLyB9XG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb250YWluZXIsXG4gICAgICAgIGhhbmRsZXJzLFxuICAgICAgfTtcbiAgICB9LFxuICAgIGdldEVkaXRvckNvbnRlbnQoKSB7XG4gICAgICBjb25zb2xlLmxvZyhgQ29sbGFib3JhdGl2ZUVkaXRvciDigKIgZ2V0RWRpdG9yQ29udGVudGApO1xuICAgICAgaWYgKCF0aGlzLmVkaXRvci5nZXRUZXh0KCkgfHwgdGhpcy5lZGl0b3IuZ2V0VGV4dCgpID09PSBcIlxcblwiKSByZXR1cm4gXCJcIjtcbiAgICAgIGxldCBodG1sID0gdGhpcy5lZGl0b3Iucm9vdC5pbm5lckhUTUw7XG5cbiAgICAgIGh0bWwgPSB0aGlzLmNsZWFuRWRpdG9yQ29udGVudChodG1sKTtcblxuICAgICAgcmV0dXJuIGh0bWw7XG4gICAgfSxcbiAgICBjbGVhbkVkaXRvckNvbnRlbnQoaHRtbCkge1xuICAgICAgY29uc29sZS5sb2coYENvbGxhYm9yYXRpdmVFZGl0b3Ig4oCiIGNsZWFuRWRpdG9yQ29udGVudGApO1xuXG4gICAgICB2YXIgdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZW1wbGF0ZVwiKTtcbiAgICAgIHQuaW5uZXJIVE1MID0gaHRtbDtcblxuICAgICAgLy8gdXNlZCB0byBtYWtlIHN1cmUgd2UgZG9u4oCZdCBnZXQgd2VpcmQgc3R1ZmYgc3VjaCBhcyA8cCBzdHlsZT1cImZvbnQtZmFtaWx5OiBcIkF2YWRhXCI7XCI+cGxvcDwvcD5cbiAgICAgIC8vIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyZxdW90Oy9nLCBcIidcIik7XG4gICAgICAvLyB0b2RvIDogcmVtb3ZlIHN0YXR1cyBjbGFzcyBsaWtlIGlzLS1zZWxlY3RlZCBvciBpcy0tZHJhZ292ZXJcbiAgICAgIHQuY29udGVudFxuICAgICAgICAucXVlcnlTZWxlY3RvckFsbChcIi5pcy0tc2VsZWN0ZWRcIilcbiAgICAgICAgLmZvckVhY2goKGVsKSA9PiBlbC5jbGFzc0xpc3QgJiYgZWwuY2xhc3NMaXN0LnJlbW92ZShcImlzLS1zZWxlY3RlZFwiKSk7XG5cbiAgICAgIHJldHVybiB0LmlubmVySFRNTDtcbiAgICB9LFxuXG4gICAgc2V0U3RhdHVzQnV0dG9uKCkge1xuICAgICAgaWYgKHRoaXMuJHJlZnMuZWRpdEJ0bilcbiAgICAgICAgdGhpcy4kZWwucXVlcnlTZWxlY3RvcihcIi5xbC10b29sYmFyXCIpLmFwcGVuZENoaWxkKHRoaXMuJHJlZnMuZWRpdEJ0bik7XG4gICAgfSxcbiAgICB0b2dnbGVFZGl0KCkge1xuICAgICAgaWYgKCF0aGlzLmVkaXRvcl9pc19lbmFibGVkKSB0aGlzLmVuYWJsZUVkaXRvcigpO1xuICAgICAgZWxzZSB0aGlzLmRpc2FibGVFZGl0b3IoKTtcbiAgICB9LFxuICAgIGFzeW5jIGVuYWJsZUVkaXRvcigpIHtcbiAgICAgIGlmICh0aGlzLmVkaXRvcl9pc19lbmFibGVkIHx8ICF0aGlzLmNhbl9lZGl0KSByZXR1cm4gZmFsc2U7XG5cbiAgICAgIGNvbnNvbGUubG9nKGBDb2xsYWJvcmF0aXZlRWRpdG9yMiDigKIgZW5hYmxlRWRpdG9yYCk7XG5cbiAgICAgIGlmICh0aGlzLmlzX2NvbGxhYm9yYXRpdmUpIGF3YWl0IHRoaXMuc3RhcnRDb2xsYWJvcmF0aXZlKCk7XG5cbiAgICAgIHRoaXMuZWRpdG9yLmVuYWJsZSgpO1xuXG4gICAgICB0aGlzLmVkaXRvci5mb2N1cygpO1xuXG4gICAgICAvLyB0b2RvIHNlbGVjdCBsYXRlc3QgdXNlZCBmb250IGFzIHNlbGVjdGVkIGZvbnRcbiAgICAgIGlmICh0aGlzLmVkaXRvci5nZXRMZW5ndGgoKSA8PSAxKSB7XG4gICAgICAgIGNvbnN0IGZvbnRMYXN0VXNlZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiZm9udExhc3RVc2VkXCIpO1xuICAgICAgICB0aGlzLmVkaXRvci5mb3JtYXQoXCJmb250XCIsIGZvbnRMYXN0VXNlZCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZWRpdG9yLnNldFNlbGVjdGlvbih0aGlzLmVkaXRvci5nZXRMZW5ndGgoKSwgUXVpbGwuc291cmNlcy5TSUxFTlQpO1xuXG4gICAgICB0aGlzLiRlbWl0KGBjb250ZW50SXNFZGl0ZWRgLCB0aGlzLnRvb2xiYXJfZWwpO1xuICAgICAgdGhpcy5lZGl0b3JfaXNfZW5hYmxlZCA9IHRydWU7XG4gICAgfSxcbiAgICBhc3luYyBkaXNhYmxlRWRpdG9yKCkge1xuICAgICAgaWYgKCF0aGlzLmVkaXRvcl9pc19lbmFibGVkKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgIGNvbnNvbGUubG9nKGBDb2xsYWJvcmF0aXZlRWRpdG9yMiDigKIgZGlzYWJsZUVkaXRvcmApO1xuICAgICAgdGhpcy5pc19kaXNhYmxpbmdfZWRpdG9yID0gdHJ1ZTtcblxuICAgICAgdGhpcy5lZGl0b3Iuc2V0U2VsZWN0aW9uKG51bGwpO1xuICAgICAgdGhpcy5lZGl0b3IuYmx1cigpO1xuICAgICAgdGhpcy51cGRhdGVTZWxlY3RlZExpbmVzKCk7XG5cbiAgICAgIGlmICh0aGlzLmlzX2NvbGxhYm9yYXRpdmUpIHRoaXMuZW5kQ29sbGFib3JhdGl2ZSgpO1xuXG4gICAgICBhd2FpdCB0aGlzLnNhdmVUZXh0KCk7XG5cbiAgICAgIC8vIGNoZWNrIGlmIHRvb2xiYXIgaXMgYXdheSwgZ2V0IGl0IGJhY2sgaWYgaXQgaXNcbiAgICAgIHRoaXMuZ2V0VG9vbGJhckJhY2soKTtcbiAgICAgIHRoaXMuJGVtaXQoYGNvbnRlbnRJc05vdEVkaXRlZGApO1xuXG4gICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7XG4gICAgICAgIHRoaXMuZWRpdG9yLmRpc2FibGUoKTtcbiAgICAgICAgdGhpcy5lZGl0b3JfaXNfZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzX2Rpc2FibGluZ19lZGl0b3IgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICBnZXRUb29sYmFyQmFjaygpIHtcbiAgICAgIGlmIChcbiAgICAgICAgIXRoaXMudG9vbGJhcl9lbC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcbiAgICAgICAgICBcIl90b29sYmFyQW5kRWRpdG9yQ29udGFpbmVyXCJcbiAgICAgICAgKVxuICAgICAgKVxuICAgICAgICB0aGlzLiRlbFxuICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLl90b29sYmFyQW5kRWRpdG9yQ29udGFpbmVyXCIpXG4gICAgICAgICAgLnByZXBlbmQodGhpcy50b29sYmFyX2VsKTtcbiAgICB9LFxuXG4gICAgcmVzdG9yZVZlcnNpb24oY29udGVudCkge1xuICAgICAgLy8gVE9ETyA6IHdpdGggZGVsdGEgdG8gYWxsb3cgZm9yIHVuZG9cbiAgICAgIC8vIHRoaXMuZWRpdG9yLnJvb3QuaW5uZXJIVE1MID0gY29udGVudDtcbiAgICAgIGNvbnN0IHZhbHVlID0gY29udGVudDtcbiAgICAgIGNvbnN0IGRlbHRhID0gdGhpcy5lZGl0b3IuY2xpcGJvYXJkLmNvbnZlcnQodmFsdWUpO1xuXG4gICAgICB0aGlzLmVkaXRvci5zZXRDb250ZW50cyhkZWx0YSwgXCJ1c2VyXCIpO1xuXG4gICAgICB0aGlzLnNob3dfYXJjaGl2ZXMgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgZWRpdG9yQ2xpY2soJGV2ZW50KSB7XG4gICAgICAvLyAkZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGlmIChcbiAgICAgICAgJGV2ZW50LnRhcmdldC5wYXJlbnRFbGVtZW50ICYmXG4gICAgICAgICRldmVudC50YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QgJiZcbiAgICAgICAgJGV2ZW50LnRhcmdldC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcInFsLWVkaXRvclwiKVxuICAgICAgKSB7XG4gICAgICAgIC8vIGNsaWNrIG9uIHRoZSBsZWZ0IG9mIHRoZSBlbGVtZW50XG4gICAgICAgIGlmICgkZXZlbnQub2Zmc2V0WCA8IDApIHtcbiAgICAgICAgICBjb25zdCBsaW5lX251bWJlciA9IEFycmF5LmZyb20oXG4gICAgICAgICAgICAkZXZlbnQudGFyZ2V0LnBhcmVudEVsZW1lbnQuY2hpbGRyZW5cbiAgICAgICAgICApLmZpbmRJbmRleCgoYykgPT4gYyA9PT0gJGV2ZW50LnRhcmdldCk7XG4gICAgICAgICAgdGhpcy4kZW1pdChcImxpbmVDbGlja2VkXCIsIGxpbmVfbnVtYmVyICsgMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgdXBkYXRlU2VsZWN0ZWRMaW5lcygpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKGBDb2xsYWJvcmF0aXZlRWRpdG9yIOKAoiB1cGRhdGVTZWxlY3RlZExpbmVzYCk7XG4gICAgICBpZiAoIXRoaXMuZWRpdG9yX2lzX2VuYWJsZWQpIHJldHVybjtcblxuICAgICAgY29uc3QgcmFuZ2UgPSB0aGlzLmVkaXRvci5nZXRTZWxlY3Rpb24oKTtcblxuICAgICAgaWYgKHJhbmdlICYmIHJhbmdlLmluZGV4KSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFxuICAgICAgICAvLyAgIGBDb2xsYWJvcmF0aXZlRWRpdG9yIOKAoiB1cGRhdGVTZWxlY3RlZExpbmVzIC8gcmFuZ2UuaW5kZXggPSAke3JhbmdlLmluZGV4fSBldCByYW5nZS5sZW5ndGggPSAke3JhbmdlLmxlbmd0aH0gYFxuICAgICAgICAvLyApO1xuXG4gICAgICAgIGxldCBibG90cyA9IFtdO1xuICAgICAgICBpZiAocmFuZ2UubGVuZ3RoID09PSAwKSBibG90cyA9IFt0aGlzLmVkaXRvci5nZXRMaW5lKHJhbmdlLmluZGV4KVswXV07XG4gICAgICAgIGVsc2UgYmxvdHMgPSB0aGlzLmVkaXRvci5nZXRMaW5lcyhyYW5nZS5pbmRleCwgcmFuZ2UubGVuZ3RoKTtcblxuICAgICAgICBpZiAoYmxvdHMpIHtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRseV9zZWxlY3RlZF9lbGVzID0gYmxvdHMubWFwKChiKSA9PiBiLmRvbU5vZGUpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLmN1cnJlbnRseV9zZWxlY3RlZF9lbGVzID0gZmFsc2U7XG4gICAgfSxcblxuICAgIGFzeW5jIHNhdmVUZXh0KCkge1xuICAgICAgY29uc3QgbmV3X21ldGEgPSB7XG4gICAgICAgICRjb250ZW50OiB0aGlzLmdldEVkaXRvckNvbnRlbnQoKSxcbiAgICAgIH07XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIHRoaXMuaXNfbG9hZGluZ19vcl9zYXZpbmcgPSB0cnVlO1xuICAgICAgICBhd2FpdCB0aGlzLiRhcGkudXBkYXRlTWV0YSh7XG4gICAgICAgICAgcGF0aDogdGhpcy5wYXRoLFxuICAgICAgICAgIG5ld19tZXRhLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pc19sb2FkaW5nX29yX3NhdmluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNob3dfc2F2ZWRfaWNvbiA9IHRydWU7XG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyKSA9PiBzZXRUaW1lb3V0KHIsIDE1MDApKTtcbiAgICAgICAgdGhpcy5zaG93X3NhdmVkX2ljb24gPSBmYWxzZTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBpZiAoZXJyLm1lc3NhZ2UgPT09IFwiY29udGVudCBub3QgY2hhbmdlZFwiKSBlcnI7XG4gICAgICAgIHRoaXMuaXNfbG9hZGluZ19vcl9zYXZpbmcgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgYXN5bmMgc3RhcnRDb2xsYWJvcmF0aXZlKCkge1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgLy8gY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgIC8vICAgZm9sZGVyX3R5cGU6IHRoaXMuZm9sZGVyX3R5cGUsXG4gICAgICAgIC8vICAgZm9sZGVyX3NsdWc6IHRoaXMuZm9sZGVyX3NsdWcsXG4gICAgICAgIC8vICAgbWV0YV9zbHVnOiB0aGlzLm1ldGFfc2x1ZyxcbiAgICAgICAgLy8gfSk7XG5cbiAgICAgICAgLy8gY29uc3QgcmVxdWVzdGVkX3F1ZXJ5c3RyaW5nID0gXCI/XCIgKyBwYXJhbXMudG9TdHJpbmcoKTtcbiAgICAgICAgY29uc3QgcGF0aF90b19tZXRhID0gdGhpcy5wYXRoLnJlcGxhY2VBbGwoXCIvXCIsIFwiKlwiKTtcblxuICAgICAgICBjb25zdCByZXF1ZXN0ZWRfcmVzb3VyY2VfdXJsID1cbiAgICAgICAgICAobG9jYXRpb24ucHJvdG9jb2wgPT09IFwiaHR0cHM6XCIgPyBcIndzc1wiIDogXCJ3c1wiKSArXG4gICAgICAgICAgXCI6Ly9cIiArXG4gICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhvc3QgK1xuICAgICAgICAgIFwiL2lzU2hhcmVkYlwiICtcbiAgICAgICAgICBgP3BhdGhfdG9fbWV0YT0ke3BhdGhfdG9fbWV0YX1gO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgIGBDb2xsYWJvcmF0aXZlRWRpdG9yIC8gc3RhcnRDb2xsYWJvcmF0aXZlIDogd2lsbCBjb25uZWN0IHRvIHdzIHNlcnZlciB3aXRoICR7cmVxdWVzdGVkX3Jlc291cmNlX3VybH1gXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5ydGMuc29ja2V0ID0gbmV3IFJlY29ubmVjdGluZ1dlYlNvY2tldChyZXF1ZXN0ZWRfcmVzb3VyY2VfdXJsKTtcbiAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IG5ldyBTaGFyZURCLkNvbm5lY3Rpb24odGhpcy5ydGMuc29ja2V0KTtcbiAgICAgICAgY29ubmVjdGlvbi5vbihcInN0YXRlXCIsIChzdGF0ZSkgPT4ge1xuICAgICAgICAgIHRoaXMucnRjLmNvbm5lY3Rpb25fc3RhdGUgPSBzdGF0ZS50b1N0cmluZygpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zb2xlLmxvZyhgQ29sbGFib3JhdGl2ZUVkaXRvciAvIGNvbm5lY3RpbmcgdG8gZG9jICR7cGF0aF90b19tZXRhfWApO1xuICAgICAgICB0aGlzLmRvYyA9IGNvbm5lY3Rpb24uZ2V0KFwiY29sbGFib3JhdGl2ZV90ZXh0c1wiLCBwYXRoX3RvX21ldGEpO1xuXG4gICAgICAgIHRoaXMuZG9jLnN1YnNjcmliZSgoZXJyKSA9PiB7XG4gICAgICAgICAgaWYgKGVycikgY29uc29sZS5lcnJvcihgQ29sbGFib3JhdGl2ZUVkaXRvciAvIGVyciAke2Vycn1gKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgQ29sbGFib3JhdGl2ZUVkaXRvciAvIGRvYyBzdWJzY3JpYmVgKTtcblxuICAgICAgICAgIGlmICh0aGlzLmRvYy50eXBlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICAgICAgYENvbGxhYm9yYXRpdmVFZGl0b3IgLyBkb2MgYWxyZWFkeSBleGlzdHMgYW5kIGRvYy5kYXRhID0gJHtKU09OLnN0cmluZ2lmeShcbiAgICAgICAgICAgICAgICB0aGlzLmRvYy5kYXRhXG4gICAgICAgICAgICAgICl9YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLnNldENvbnRlbnRzKHRoaXMuZG9jLmRhdGEsIFwiaW5pdFwiKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5kb2MuY3JlYXRlKHRoaXMuZWRpdG9yLmdldENvbnRlbnRzKCksIFwicmljaC10ZXh0XCIpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMuZWRpdG9yLmhpc3RvcnkuY2xlYXIoKTtcblxuICAgICAgICAgIHRoaXMuZWRpdG9yLm9uKFwidGV4dC1jaGFuZ2VcIiwgdGhpcy5zdWJtaXRPUEFuZFNhdmUpO1xuICAgICAgICAgIHRoaXMuZG9jLm9uKFwib3BcIiwgKG9wLCBzb3VyY2UpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBDb2xsYWJvcmF0aXZlRWRpdG9yIC8gb3AgYXBwbGllZGApO1xuICAgICAgICAgICAgdGhpcy50ZXh0X2RlbHRhcyA9IHRoaXMuZG9jLmRhdGE7XG4gICAgICAgICAgICBpZiAoc291cmNlID09PSB0aGlzLmVkaXRvcl9pZCkgcmV0dXJuO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYENvbGxhYm9yYXRpdmVFZGl0b3IgLyBvdXRzaWRlIG9wIGFwcGxpZWRgKTtcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLnVwZGF0ZUNvbnRlbnRzKG9wKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHRoaXMuY29sbGFib3JhdGl2ZV9pc19sb2FkZWQgPSB0cnVlO1xuXG4gICAgICAgICAgcmV0dXJuIHJlc29sdmUoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5kb2Mub24oXCJlcnJvclwiLCAoZXJyKSA9PiB7XG4gICAgICAgICAgLy8gZXJyO1xuICAgICAgICAgIC8vIHNvdWNpcyA6IGxlcyBzaXR1YXRpb25zIG91IGxlIHNlcnZldXIgYSDDqXTDqSBmZXJtw6kgZXQgZW4gbGUgcm91dnJhbnQgaWwgbmUgcG9zc8OoZGUgcGx1cyBk4oCZaW5zdGFuY2UgZHUgZG9jIGRhbnMgc2hhcmVkYuKAplxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYENvbGxhYm9yYXRpdmVFZGl0b3IgLyBkb2MgZXJyICR7ZXJyfWApO1xuICAgICAgICAgIHRoaXMuJGFsZXJ0aWZ5LmRlbGF5KDQwMDApLmVycm9yKGVycik7XG5cbiAgICAgICAgICB0aGlzLmNvbGxhYm9yYXRpdmVfaXNfbG9hZGVkID0gdHJ1ZTtcblxuICAgICAgICAgIHJldHVybiByZWplY3QoZXJyKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGVuZENvbGxhYm9yYXRpdmUoKSB7XG4gICAgICBpZiAodGhpcy5ydGMuc29ja2V0KSB0aGlzLnJ0Yy5zb2NrZXQuY2xvc2UoKTtcbiAgICAgIGlmICh0aGlzLmRvYykge1xuICAgICAgICB0aGlzLmRvYy51bnN1YnNjcmliZSgpO1xuICAgICAgICB0aGlzLmRvYyA9IG51bGw7XG4gICAgICB9XG4gICAgICB0aGlzLmVkaXRvci5vZmYoXCJ0ZXh0LWNoYW5nZVwiLCB0aGlzLnN1Ym1pdE9QQW5kU2F2ZSk7XG5cbiAgICAgIHRoaXMuY29sbGFib3JhdGl2ZV9pc19sb2FkZWQgPSBmYWxzZTtcbiAgICB9LFxuICAgIHN1Ym1pdE9QQW5kU2F2ZShkZWx0YSwgb2xkRGVsdGEsIHNvdXJjZSkge1xuICAgICAgY29uc29sZS5sb2coYENvbGxhYm9yYXRpdmVFZGl0b3IgLyBzdWJtaXRPUEFuZFNhdmUgdyBzb3VyY2UgJHtzb3VyY2V9YCk7XG4gICAgICBpZiAoc291cmNlID09PSBcInVzZXJcIikge1xuICAgICAgICB0aGlzLmRvYy5zdWJtaXRPcChkZWx0YSwgeyBzb3VyY2U6IHRoaXMuZWRpdG9yX2lkIH0pO1xuICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICBgQ29sbGFib3JhdGl2ZUVkaXRvciAvIHN1Ym1pdHRlZCBvcCB0byBzZXJ2ZXIgJHtKU09OLnN0cmluZ2lmeShcbiAgICAgICAgICAgIGRlbHRhXG4gICAgICAgICAgKX1gXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMudXBkYXRlVGV4dE1lZGlhKCk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHVwZGF0ZVRleHRNZWRpYSgpIHtcbiAgICAgIGlmICh0aGlzLmRlYm91bmNlX3RleHRVcGRhdGUpIGNsZWFyVGltZW91dCh0aGlzLmRlYm91bmNlX3RleHRVcGRhdGUpO1xuICAgICAgdGhpcy5pc19sb2FkaW5nX29yX3NhdmluZyA9IHRydWU7XG4gICAgICB0aGlzLmRlYm91bmNlX3RleHRVcGRhdGUgPSBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgYENvbGxhYm9yYXRpdmVFZGl0b3Ig4oCiIHVwZGF0ZVRleHRNZWRpYTogc2F2aW5nIG5ldyBzbmFwc2hvdGBcbiAgICAgICAgKTtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlVGV4dCgpO1xuXG4gICAgICAgIGNvbnN0IHsgZm9udCB9ID0gdGhpcy5lZGl0b3IuZ2V0Rm9ybWF0KCk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiZm9udExhc3RVc2VkXCIsIGZvbnQpO1xuICAgICAgfSwgMTAwMCk7XG4gICAgfSxcblxuICAgIGFkZE1lZGlhQXRUaGVFbmQobWVkaWEpIHtcbiAgICAgIHRoaXMuYWRkTWVkaWFBdEluZGV4KHRoaXMuZWRpdG9yLmdldExlbmd0aCgpIC0gMSwgbWVkaWEpO1xuICAgIH0sXG4gICAgYWRkTWVkaWFBdENhcmV0UG9zaXRpb24obWVkaWEpIHtcbiAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IHRoaXMuZWRpdG9yLmdldFNlbGVjdGlvbih0cnVlKTtcbiAgICAgIGlmIChzZWxlY3Rpb24gJiYgc2VsZWN0aW9uLmluZGV4KSB7XG4gICAgICAgIHRoaXMuYWRkTWVkaWFBdEluZGV4KHNlbGVjdGlvbi5pbmRleCwgbWVkaWEpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLmFkZE1lZGlhQXRUaGVFbmQobWVkaWEpO1xuICAgIH0sXG4gICAgYWRkTWVkaWFBdEluZGV4KGluZGV4LCBtZWRpYSkge1xuICAgICAgY29uc29sZS5sb2coYENvbGxhYm9yYXRpdmVFZGl0b3Ig4oCiIGFkZE1lZGlhQXRJbmRleCAke2luZGV4fWApO1xuICAgICAgLy8gVE9ETyBmaXhcbiAgICAgIGNvbnN0IG1lZGlhVVJMID0gYC4vJHt0aGlzLmZvbGRlcl9zbHVnfS8ke21lZGlhLm1lZGlhX2ZpbGVuYW1lfWA7XG4gICAgICAvLyBjb25zdCBtZWRpYVVSTCA9XG4gICAgICAvLyAgIHRoaXMuJHJvb3Quc3RhdGUubW9kZSA9PT0gXCJleHBvcnRfcHVibGljYXRpb25cIlxuICAgICAgLy8gICAgID8gYC4vJHt0aGlzLmZvbGRlcl9zbHVnfS8ke21lZGlhLm1lZGlhX2ZpbGVuYW1lfWBcbiAgICAgIC8vICAgICA6IGAvJHt0aGlzLmZvbGRlcl9zbHVnfS8ke21lZGlhLm1lZGlhX2ZpbGVuYW1lfWA7XG5cbiAgICAgIC8vIHNldHRpbmcgZWRpdG9yIGZvY3VzIGFuZCBzZWxlY3Rpb24gY2FuIGNhdXNlIHRoZSBzY3JvbGwgdG8gXCJqdW1wXCJcbiAgICAgIC8vIG5vdCBleGFjdGx5IGEgZ29vZCBpZGVh4oCmXG4gICAgICAvLyB0aGlzLmVkaXRvci5zZXRTZWxlY3Rpb24oaW5kZXgsIFF1aWxsLnNvdXJjZXMuU0lMRU5UKTtcbiAgICAgIC8vIHRoaXMuZWRpdG9yLmZvY3VzKCk7XG5cbiAgICAgIHRoaXMuZWRpdG9yLmJsdXIoKTtcblxuICAgICAgY29uc3QgeyAkdHlwZSwgY2FwdGlvbiwgJHBhdGggfSA9IG1lZGlhO1xuICAgICAgJHBhdGg7XG5cbiAgICAgIGlmICgkdHlwZSA9PT0gXCJpbWFnZVwiKSB7XG4gICAgICAgIGNvbnN0IHRodW1iX3BhdGggPSBtZWRpYS4kdGh1bWJzWzE2MDBdO1xuICAgICAgICBpZiAodGh1bWJfcGF0aCkge1xuICAgICAgICAgIC8vIHRoaXMuZWRpdG9yLmluc2VydFRleHQoaW5kZXgsIFwiXFxuXCIsIFF1aWxsLnNvdXJjZXMuVVNFUik7XG4gICAgICAgICAgdGhpcy5lZGl0b3IuaW5zZXJ0RW1iZWQoXG4gICAgICAgICAgICBpbmRleCxcbiAgICAgICAgICAgIFwibWVkaWFcIixcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdHlwZTogJHR5cGUsXG4gICAgICAgICAgICAgIGNhcHRpb24sXG4gICAgICAgICAgICAgIC8vIFRPRE8gdXBkYXRlIHdpdGggJHBhdGhcbiAgICAgICAgICAgICAgLy8gbWV0YV9maWxlbmFtZTogJHNsdWcsXG4gICAgICAgICAgICAgIC8vIHNyYzogYC90aHVtYnMvJHt0aGlzLmZvbGRlcl90eXBlfS8ke3RoaXMuZm9sZGVyX3NsdWd9LyR7dGh1bWJfcGF0aH1gLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFF1aWxsLnNvdXJjZXMuVVNFUlxuICAgICAgICAgICk7XG4gICAgICAgICAgLy8gdGhpcy5lZGl0b3Iuc2V0U2VsZWN0aW9uKGluZGV4ICsgMSwgUXVpbGwuc291cmNlcy5TSUxFTlQpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKCR0eXBlID09PSBcInZpZGVvXCIpIHtcbiAgICAgICAgLy8gdGhpcy5lZGl0b3IuaW5zZXJ0VGV4dChpbmRleCwgXCJcXG5cIiwgUXVpbGwuc291cmNlcy5VU0VSKTtcbiAgICAgICAgdGhpcy5lZGl0b3IuaW5zZXJ0RW1iZWQoXG4gICAgICAgICAgaW5kZXgsXG4gICAgICAgICAgXCJtZWRpYVwiLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICR0eXBlLFxuICAgICAgICAgICAgY2FwdGlvbixcbiAgICAgICAgICAgIC8vIFRPRE8gdXBkYXRlIHdpdGggJHBhdGhcbiAgICAgICAgICAgIG1ldGFfZmlsZW5hbWU6ICRwYXRoLFxuICAgICAgICAgICAgc3JjOiBtZWRpYVVSTCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIFF1aWxsLnNvdXJjZXMuVVNFUlxuICAgICAgICApO1xuICAgICAgICAvLyB0aGlzLmVkaXRvci5zZXRTZWxlY3Rpb24oaW5kZXggKyAxLCBRdWlsbC5zb3VyY2VzLlNJTEVOVCk7XG4gICAgICB9IGVsc2UgaWYgKCR0eXBlID09PSBcImF1ZGlvXCIpIHtcbiAgICAgICAgdGhpcy5lZGl0b3IuaW5zZXJ0RW1iZWQoXG4gICAgICAgICAgaW5kZXgsXG4gICAgICAgICAgXCJtZWRpYVwiLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6ICR0eXBlLFxuICAgICAgICAgICAgY2FwdGlvbixcbiAgICAgICAgICAgIC8vIFRPRE8gdXBkYXRlIHdpdGggJHBhdGhcbiAgICAgICAgICAgIG1ldGFfZmlsZW5hbWU6ICRwYXRoLFxuICAgICAgICAgICAgc3JjOiBtZWRpYVVSTCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIFF1aWxsLnNvdXJjZXMuVVNFUlxuICAgICAgICApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy4kYWxlcnRpZnlcbiAgICAgICAgICAuY2xvc2VMb2dPbkNsaWNrKHRydWUpXG4gICAgICAgICAgLmRlbGF5KDQwMDApXG4gICAgICAgICAgLmVycm9yKHRoaXMuJHQoXCJub3RpZmljYXRpb25zLm1lZGlhX3R5cGVfbm90X2hhbmRsZWRcIikpO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBvbkRyYWdvdmVyKCRldmVudCkge1xuICAgICAgaWYgKCF0aGlzLmVkaXRvcl9pc19lbmFibGVkKSByZXR1cm47XG4gICAgICBjb25zb2xlLmxvZyhgQ29sbGFib3JhdGl2ZUVkaXRvcjIgLyBvbkRyYWdvdmVyYCk7XG4gICAgICAkZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIC8vIHRvZG8gZGVib3VuY2UgZHJhZ292ZXIgdG8gdHJpZ2dlciBvbmx5IGEgaGFuZGZ1bCBvZiB0aW1lcyBwZXIgc2Vjb25kc1xuICAgICAgLy8gY29uc3QgZWwgPSAkZXZlbnQudGFyZ2V0O1xuICAgICAgbGV0IF9ibG90ID0gdGhpcy5nZXRCbG9ja0Zyb21FbGVtZW50KCRldmVudC50YXJnZXQpO1xuICAgICAgaWYgKCFfYmxvdCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAvLyBkbyBub3RoaW5nIGlmIGRyYWdvdmVyIG9uXG4gICAgICAvLyBpZiAoZWwuY2xhc3NMaXN0LmNvbnRhaW5zKFwicWwtZWRpdG9yXCIpKSByZXR1cm47XG5cbiAgICAgIC8vIGlmIChlbC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcInFsLWVkaXRvclwiKSkge1xuICAgICAgaWYgKCFfYmxvdC5kb21Ob2RlLmNsYXNzTGlzdC5jb250YWlucyhcImlzLS1kcmFnb3ZlclwiKSkge1xuICAgICAgICBfYmxvdC5kb21Ob2RlLmNsYXNzTGlzdC5hZGQoXCJpcy0tZHJhZ292ZXJcIik7XG4gICAgICAgIF9ibG90LmRvbU5vZGUuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdsZWF2ZVwiLCAoKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coYENvbGxhYm9yYXRpdmVFZGl0b3IyIC8gZHJhZ2xlYXZlYCk7XG4gICAgICAgICAgX2Jsb3QuZG9tTm9kZS5jbGFzc0xpc3QucmVtb3ZlKFwiaXMtLWRyYWdvdmVyXCIpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIC8vIG9uRHJhZ0xlYXZlKCRldmVudCkge30sXG4gICAgb25Ecm9wKCRldmVudCkge1xuICAgICAgaWYgKCF0aGlzLmVkaXRvcl9pc19lbmFibGVkKSByZXR1cm47XG4gICAgICBjb25zb2xlLmxvZyhgQ29sbGFib3JhdGl2ZUVkaXRvcjIgLyBvbkRyb3BgKTtcblxuICAgICAgLy8gUHJldmVudCBkZWZhdWx0IGJlaGF2aW9yIChQcmV2ZW50IGZpbGUgZnJvbSBiZWluZyBvcGVuZWQpXG4gICAgICAkZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICRldmVudC5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9IFwibW92ZVwiO1xuXG4gICAgICB0aGlzLnJlbW92ZURyYWdvdmVyRnJvbUJsb3RzKCk7XG5cbiAgICAgIGlmICgkZXZlbnQuZGF0YVRyYW5zZmVyLmdldERhdGEoXCJ0ZXh0L3BsYWluXCIpID09PSBcIm1lZGlhX2luX3F1aWxsXCIpIHtcbiAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgYENvbGxhYm9yYXRpdmVFZGl0b3IyIC8gb25Ecm9wIDogOiBkcmFnIGFuZCBkcm9wcGVkIGEgbWVkaWEgZnJvbSBxdWlsbGBcbiAgICAgICAgKTtcblxuICAgICAgICBsZXQgX2Jsb3QgPSB0aGlzLmdldEJsb2NrRnJvbUVsZW1lbnQoJGV2ZW50LnRhcmdldCk7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5lZGl0b3IuZ2V0SW5kZXgoX2Jsb3QpO1xuXG4gICAgICAgIC8vIGZpbmQgd2hpY2ggYmxvdCB3YXMgZHJhZ2dlZCAoQSlcbiAgICAgICAgLy8gZmluZCB3aGVyZSBpdCB3YXMgZHJvcHBlZCAoQilcbiAgICAgICAgLy8gbW92ZSBkZWx0YSBmcm9tIEEgdG8gQlxuXG4gICAgICAgIGNvbnNvbGUubG9nKGBfYmxvdCBpcyBjdXJyZW50bHkgYXQgaW5kZXggJHtpbmRleH1gKTtcbiAgICAgIH0gZWxzZSBpZiAoJGV2ZW50LmRhdGFUcmFuc2Zlci5nZXREYXRhKFwidGV4dC9wbGFpblwiKSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICBgQ29sbGFib3JhdGl2ZUVkaXRvcjIgLyBvbkRyb3AgOiA6IGRyb3BwZWQgYSBtZWRpYSBmcm9tIHRoZSBsaWJyYXJ5YFxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IG1lZGlhID0gSlNPTi5wYXJzZSgkZXZlbnQuZGF0YVRyYW5zZmVyLmdldERhdGEoXCJ0ZXh0L3BsYWluXCIpKTtcbiAgICAgICAgY29uc29sZS5sb2cobWVkaWEpO1xuXG4gICAgICAgIGlmIChtZWRpYS5tZWRpYV9maWxlbmFtZSkge1xuICAgICAgICAgIC8vIGRyb3Agc3VyIGzigJnDqWRpdG9yIGV0IHBhcyBzdXIgdW5lIGxpZ25lXG4gICAgICAgICAgaWYgKCRldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicWwtZWRpdG9yXCIpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICAgICAgXCJkcm9wcGVkIG9uIGVkaXRvciBhbmQgbm90IG9uIGxpbmUsIHdpbGwgaW5zZXJ0IGF0IHRoZSBlbmQgb2YgZG9jXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLmFkZE1lZGlhQXRJbmRleCh0aGlzLmVkaXRvci5nZXRMZW5ndGgoKSAtIDEsIG1lZGlhKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBsZXQgX2Jsb3QgPSB0aGlzLmdldEJsb2NrRnJvbUVsZW1lbnQoJGV2ZW50LnRhcmdldCk7XG5cbiAgICAgICAgICBpZiAoIV9ibG90KSB7XG4gICAgICAgICAgICB0aGlzLiRhbGVydGlmeVxuICAgICAgICAgICAgICAuY2xvc2VMb2dPbkNsaWNrKHRydWUpXG4gICAgICAgICAgICAgIC5kZWxheSg0MDAwKVxuICAgICAgICAgICAgICAuZXJyb3IodGhpcy4kdChcIm5vdGlmaWNhdGlvbnMuZmFpbGVkX3RvX2ZpbmRfYmxvY2tfbGluZVwiKSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgX2Jsb3QgPVxuICAgICAgICAgICAgX2Jsb3QubmV4dCAhPT0gbnVsbCAmJiBfYmxvdC5uZXh0LmRvbU5vZGUgPyBfYmxvdC5uZXh0IDogX2Jsb3Q7XG5cbiAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuZWRpdG9yLmdldEluZGV4KF9ibG90KTtcbiAgICAgICAgICB0aGlzLmFkZE1lZGlhQXRJbmRleChpbmRleCAtIDEsIG1lZGlhKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgYENvbGxhYm9yYXRpdmVFZGl0b3IyIC8gb25Ecm9wIDogbWlzc2luZyBtZXRhIGZvciBkcm9wIHRvIG9jY3VyYFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICByZW1vdmVEcmFnb3ZlckZyb21CbG90cygpIHtcbiAgICAgIHRoaXMuZWRpdG9yLmdldExpbmVzKCkubWFwKChiKSA9PiB7XG4gICAgICAgIHdoaWxlIChiLnBhcmVudCAhPT0gYi5zY3JvbGwpIHtcbiAgICAgICAgICBiID0gYi5wYXJlbnQ7XG4gICAgICAgICAgaWYgKGIgPT09IGIuc2Nyb2xsKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGIgIT09IGIuc2Nyb2xsICYmIGIuZG9tTm9kZSkge1xuICAgICAgICAgIGIuZG9tTm9kZS5jbGFzc0xpc3QucmVtb3ZlKFwiaXMtLWRyYWdvdmVyXCIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuXG4gICAgZ2V0QmxvY2tGcm9tRWxlbWVudChfdGFyZ2V0KSB7XG4gICAgICB3aGlsZSAoIV90YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoXCJxbC1lZGl0b3JcIikpIHtcbiAgICAgICAgX3RhcmdldCA9IF90YXJnZXQucGFyZW50RWxlbWVudDtcbiAgICAgICAgaWYgKF90YXJnZXQgPT09IG51bGwgfHwgIV90YXJnZXQucGFyZW50RWxlbWVudCkgYnJlYWs7XG4gICAgICB9XG4gICAgICBsZXQgX2Jsb3QgPSBRdWlsbC5maW5kKF90YXJnZXQpO1xuICAgICAgaWYgKF9ibG90KSByZXR1cm4gX2Jsb3Q7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSxcbiAgfSxcbn07XG48L3NjcmlwdD5cbjxzdHlsZSBzcmM9XCJxdWlsbC9kaXN0L3F1aWxsLnNub3cuY3NzXCI+PC9zdHlsZT5cbjxzdHlsZSBsYW5nPVwic2Nzc1wiIHNjb3BlZD5cbi5fY29sbGFib3JhdGl2ZUVkaXRvciB7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgZm9udC1zaXplOiAxMDAlO1xuXG4gICY6bm90KC5pcy0tZWRpdGFibGUpIHtcbiAgICBib3JkZXI6IG5vbmU7XG4gICAgOjp2LWRlZXAgLnFsLXRvb2xiYXIge1xuICAgICAgZGlzcGxheTogbm9uZTtcbiAgICB9XG4gIH1cblxuICA6OnYtZGVlcCB7XG4gICAgLnFsLWNvbnRhaW5lciB7XG4gICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgICBmb250LWZhbWlseTogaW5oZXJpdDtcbiAgICAgIGZvbnQtd2VpZ2h0OiBub3JtYWw7XG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcbiAgICAgIGJvcmRlcjogMDtcblxuICAgICAgJjpub3QoLnFsLWRpc2FibGVkKSB7XG4gICAgICAgIC5xbC1lZGl0b3Ige1xuICAgICAgICAgID4gKiB7XG4gICAgICAgICAgICAmOjpiZWZvcmUge1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC5xbC1lZGl0b3Ige1xuICAgICAgY291bnRlci1yZXNldDogbGlzdENvdW50ZXI7XG4gICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgICAgIGNvbG9yOiBpbmhlcml0O1xuXG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcblxuICAgICAgcGFkZGluZzogMHB4O1xuXG4gICAgICBAaW1wb3J0IFwiLi9pbXBvcnRzL21haW5UZXh0LnNjc3NcIjtcblxuICAgICAgJltjb250ZW50ZWRpdGFibGU9XCJ0cnVlXCJdIHtcbiAgICAgICAgLy8gcGFkZGluZzogMnB4O1xuICAgICAgICAvLyBwYWRkaW5nLWJvdHRvbTogY2FsYyh2YXIoLS1zcGFjaW5nKSAqIDEpO1xuICAgICAgfVxuXG4gICAgICA+ICoge1xuICAgICAgICAvLyBjb3VudGVyLWluY3JlbWVudDogbGlzdENvdW50ZXI7XG4gICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgICAgcGFkZGluZzogMDtcblxuICAgICAgICAmOjpiZWZvcmUge1xuICAgICAgICAgIC8vIGNvbnRlbnQ6IGNvdW50ZXIobGlzdENvdW50ZXIpO1xuICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcblxuICAgICAgICAgIC8qIG9sZCB3YXkgOiBwb3MgYWJzICovXG4gICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgIC8vIHBhZGRpbmctdG9wOiAwLjg1ZW07XG4gICAgICAgICAgcmlnaHQ6IDEwMCU7XG4gICAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7XG4gICAgICAgICAgaGVpZ2h0OiAxMDAlO1xuXG4gICAgICAgICAgZm9udC1zaXplOiAwLjZyZW07XG4gICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1xuICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICAgICAgICBsaW5lLWhlaWdodDogMztcbiAgICAgICAgICB3aWR0aDogY2FsYyh2YXIoLS1zcGFjaW5nKSAqIDIpO1xuICAgICAgICAgIG1heC13aWR0aDogMTAwcHg7XG4gICAgICAgICAgbGluZS1oZWlnaHQ6IDIuNTtcbiAgICAgICAgICBjb2xvcjogdHJhbnNwYXJlbnQ7XG4gICAgICAgICAgY29sb3I6IGhzbCgyMTAsIDExJSwgMTglKTtcblxuICAgICAgICAgIC8vIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgICAgICAvLyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgICAgICAgLy8gZm9udC1zaXplOiAwLjZyZW07XG4gICAgICAgICAgLy8gdmVydGljYWwtYWxpZ246IGJhc2VsaW5lO1xuICAgICAgICAgIC8vIHdpZHRoOiBjYWxjKHZhcigtLXNwYWNpbmcpICogMik7XG4gICAgICAgICAgLy8gbWFyZ2luLWxlZnQ6IGNhbGModmFyKC0tc3BhY2luZykgKiAyICogLTEpO1xuXG4gICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMjVzIGN1YmljLWJlemllcigwLjE5LCAxLCAwLjIyLCAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgICYuaXMtLXNlbGVjdGVkIHtcbiAgICAgICAgICAmOjpiZWZvcmUge1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYWN0aXZlLWNvbG9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAmOjphZnRlciB7XG4gICAgICAgICAgY29udGVudDogXCJcIjtcbiAgICAgICAgICBkaXNwbGF5OiBibG9jaztcbiAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICBoZWlnaHQ6IDA7XG4gICAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWFjdGl2ZS1jb2xvcik7XG4gICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMjVzIGN1YmljLWJlemllcigwLjE5LCAxLCAwLjIyLCAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgICYuaXMtLWRyYWdvdmVyIHtcbiAgICAgICAgICAmOjphZnRlciB7XG4gICAgICAgICAgICBtYXJnaW46IDRweCAwO1xuICAgICAgICAgICAgaGVpZ2h0OiA0cHg7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLnFsLXRvb2x0aXAge1xuICAgICAgei1pbmRleDogMTA7XG4gICAgfVxuXG4gICAgLnFsLWNvbnRhaW5lci5xbC1kaXNhYmxlZCB7XG4gICAgICAucWwtZWRpdG9yID4gKiB7XG4gICAgICAgIGN1cnNvcjogaW5oZXJpdDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbi5fY29sbGFib3JhdGl2ZUVkaXRvcjpub3QoLmlzLS1lZGl0aW5nX2lzX2VuYWJsZWQpIHtcbiAgOjp2LWRlZXAge1xuICAgIC5xbC10b29sYmFyIHtcbiAgICAgIHBhZGRpbmc6IDA7XG4gICAgfVxuICAgIC5xbC1mb3JtYXRzIHtcbiAgICAgIGRpc3BsYXk6IG5vbmU7XG4gICAgfVxuICB9XG59XG5cbi5fZmxvYXRpbmdFZGl0QnRuIHtcbiAgcG9zaXRpb246IHN0aWNreTtcbiAgei1pbmRleDogMTAxO1xuICB0b3A6IGNhbGModmFyKC0tc3BhY2luZykgLyA0KTtcbiAgbWFyZ2luLWxlZnQ6IGF1dG87XG4gIG1hcmdpbi1yaWdodDogY2FsYyh2YXIoLS1zcGFjaW5nKSAvIDQpO1xuXG4gID4gKiB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHRvcDogMDtcbiAgICByaWdodDogMDtcbiAgfVxufVxuPC9zdHlsZT5cbjxzdHlsZSBsYW5nPVwic2Nzc1wiPlxuLnFsLXRvb2xiYXIucWwtdG9vbGJhciB7XG4gIC0tdG9vbGJhci1iZzogdmFyKC0tZWRpdG9yLWJnKTtcbiAgLS1lZGl0b3ItYmc6ICNlZWU7XG4gIC0tYnV0dG9uLXNpemU6IDMycHg7XG4gIC0tYm9yZGVyLXNpemU6IDRweDtcbiAgLS1xdWlsbC1idXR0b25zLXNpemU6IDIwcHg7XG4gIC0tcXVpbGwtb3B0aW9ucy1zaXplOiAzNHB4O1xuXG4gIHBvc2l0aW9uOiBzdGlja3k7XG4gIHRvcDogMDtcbiAgei1pbmRleDogMjtcbiAgcGFkZGluZzogY2FsYyh2YXIoLS1zcGFjaW5nKSAvIDQpO1xuICBib3JkZXItcmFkaXVzOiAxNnB4O1xuICAvLyBoaWRlcyBzZWxlY3QsIGRvIG5vdCB1c2VcbiAgLy8gb3ZlcmZsb3c6IGhpZGRlbjtcblxuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWZsb3c6IHJvdyB3cmFwO1xuICAvLyBnYXA6IGNhbGModmFyKC0tc3BhY2luZykgLyA0KTtcbiAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuXG4gIGZvbnQtc2l6ZTogaW5oZXJpdDtcbiAgZm9udC1mYW1pbHk6IGluaGVyaXQ7XG4gIGZvbnQtd2VpZ2h0OiBub3JtYWw7XG4gIGJhY2tncm91bmQtY29sb3I6IHZhcigtLXRvb2xiYXItYmcpO1xuICBjb2xvcjogIzMzMyAhaW1wb3J0YW50O1xuXG4gIC8vIGJvcmRlci1yYWRpdXM6IDAuNWVtO1xuICBib3JkZXI6IG5vbmU7XG4gIC8vIGJvcmRlci1ib3R0b206IHZhcigtLWJvcmRlci1zaXplKSBkb3R0ZWQgdmFyKC0tZWRpdG9yLWJnKTtcbiAgLy8gYm9yZGVyLWJvdHRvbS1zdHlsZTogZG91YmxlO1xuXG4gICY6OmFmdGVyIHtcbiAgICBkaXNwbGF5OiBub25lO1xuICB9XG4gIGJ1dHRvbixcbiAgc3ZnIHtcbiAgICBjb2xvcjogY3VycmVudENvbG9yO1xuICB9XG5cbiAgYnV0dG9uLFxuICAuX2NvbGxhYkVkaXRvclN0YXR1cyB7XG4gICAgbWluLXdpZHRoOiB2YXIoLS1idXR0b24tc2l6ZSk7XG4gICAgd2lkdGg6IGF1dG87XG4gICAgaGVpZ2h0OiB2YXIoLS1idXR0b24tc2l6ZSk7XG4gICAgcGFkZGluZzogNnB4O1xuICB9XG5cbiAgLnFsLWZpbGwsXG4gIC5xbC1zdHJva2UucWwtZmlsbCB7XG4gICAgZmlsbDogY3VycmVudENvbG9yO1xuICB9XG5cbiAgLnFsLXN0cm9rZSB7XG4gICAgc3Ryb2tlOiBjdXJyZW50Q29sb3I7XG4gIH1cblxuICAucWwtY29sb3ItcGlja2VyIC5xbC1waWNrZXItb3B0aW9ucyB7XG4gICAgLy8gdG8gcHJldmVudCBvdmVyZmxvdyBpc3N1ZXMgd2l0aCBwYWdlbWVudSBvdmVyZmxvd1xuICAgIHdpZHRoOiB2YXIoLS1xdWlsbC1vcHRpb25zLXNpemUpO1xuICB9XG5cbiAgLnFsLXBpY2tlciB7XG4gICAgY29sb3I6IGN1cnJlbnRDb2xvcjtcblxuICAgICYucWwtbGluZWhlaWdodCB7XG4gICAgICB3aWR0aDogNzhweDtcbiAgICAgIC5xbC1waWNrZXItbGFiZWwsXG4gICAgICAucWwtcGlja2VyLWl0ZW0ge1xuICAgICAgICAmOjpiZWZvcmUge1xuICAgICAgICAgIGNvbnRlbnQ6IFwiTm9ybWFsICgxLjQyKVwiICFpbXBvcnRhbnQ7XG4gICAgICAgIH1cbiAgICAgICAgJltkYXRhLXZhbHVlXSxcbiAgICAgICAgJltkYXRhLXZhbHVlXSB7XG4gICAgICAgICAgJjo6YmVmb3JlIHtcbiAgICAgICAgICAgIGNvbnRlbnQ6IGF0dHIoZGF0YS12YWx1ZSkgIWltcG9ydGFudDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAucWwtcGlja2VyLnFsLWZvbnQge1xuICAgIHdpZHRoOiAxNDBweDtcbiAgfVxuICAucWwtY29sb3ItcGlja2VyLFxuICAucWwtaWNvbi1waWNrZXIge1xuICAgIHdpZHRoOiB2YXIoLS1xdWlsbC1vcHRpb25zLXNpemUpO1xuICB9XG5cbiAgLnFsLWZvcm1hdHMge1xuICAgIC8vIG1hcmdpbi1yaWdodDogY2FsYyh2YXIoLS1zcGFjaW5nKSAvIDIpO1xuICAgIC8vIG1hcmdpbi1ib3R0b206IGNhbGModmFyKC0tc3BhY2luZykgLyAyKTtcbiAgICBtYXJnaW46IDA7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWZsb3c6IHJvdyBub3dyYXA7XG4gICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tdG9vbGJhci1iZyk7XG4gICAgYm9yZGVyLXJhZGl1czogMTJweDtcbiAgICBiYWNrZ3JvdW5kOiAjZmZmO1xuXG4gICAgYnV0dG9uLFxuICAgID4gKjpub3QoLnFsLXNpemUpOm5vdCgucWwtbGluZWhlaWdodCk6bm90KC5xbC1oZWFkZXIpOm5vdCgucWwtZm9udClcbiAgICAgIC5xbC1waWNrZXItbGFiZWwge1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgIHN2ZyB7XG4gICAgICAgIHdpZHRoOiB2YXIoLS1xdWlsbC1idXR0b25zLXNpemUpO1xuICAgICAgICBoZWlnaHQ6IHZhcigtLXF1aWxsLWJ1dHRvbnMtc2l6ZSk7XG4gICAgICAgIGZsZXg6IDAgMCBhdXRvO1xuICAgICAgfVxuICAgIH1cblxuICAgIC5xbC1mb250IHtcbiAgICAgIGJhY2tncm91bmQ6IHZhcigtLWVkaXRvci1iZyk7XG4gICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgICB9XG4gICAgLnFsLWhlYWRlciB7XG4gICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1lZGl0b3ItYmcpO1xuICAgICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7XG4gICAgfVxuICAgIC5xbC1waWNrZXIge1xuICAgICAgaGVpZ2h0OiB2YXIoLS1idXR0b24tc2l6ZSk7XG5cbiAgICAgICYucWwtc2l6ZSB7XG4gICAgICAgIHdpZHRoOiAxMTVweDtcbiAgICAgICAgLnFsLXBpY2tlci1sYWJlbCxcbiAgICAgICAgLnFsLXBpY2tlci1pdGVtIHtcbiAgICAgICAgICAmOjpiZWZvcmUge1xuICAgICAgICAgICAgY29udGVudDogXCJQYXIgZMOpZmF1dFwiICFpbXBvcnRhbnQ7XG4gICAgICAgICAgfVxuICAgICAgICAgICZbZGF0YS12YWx1ZV0sXG4gICAgICAgICAgJltkYXRhLXZhbHVlXSB7XG4gICAgICAgICAgICAmOjpiZWZvcmUge1xuICAgICAgICAgICAgICBjb250ZW50OiBhdHRyKGRhdGEtdmFsdWUpICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICAmLnFsLWxpbmVoZWlnaHQge1xuICAgICAgICB3aWR0aDogMTE1cHg7XG4gICAgICAgIC5xbC1waWNrZXItbGFiZWwsXG4gICAgICAgIC5xbC1waWNrZXItaXRlbSB7XG4gICAgICAgICAgJjo6YmVmb3JlIHtcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwiTm9ybWFsICgxLjQyKVwiICFpbXBvcnRhbnQ7XG4gICAgICAgICAgfVxuICAgICAgICAgICZbZGF0YS12YWx1ZV0sXG4gICAgICAgICAgJltkYXRhLXZhbHVlXSB7XG4gICAgICAgICAgICAmOjpiZWZvcmUge1xuICAgICAgICAgICAgICBjb250ZW50OiBhdHRyKGRhdGEtdmFsdWUpICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIC5xbC1waWNrZXItbGFiZWwge1xuICAgICAgdGV4dC1hbGlnbjogbGVmdDtcbiAgICAgIHBhZGRpbmc6IDRweDtcbiAgICAgIC8vIGJhY2tncm91bmQ6IHdoaXRlO1xuICAgIH1cblxuICAgIC5xbC1waWNrZXItbGFiZWw6OmJlZm9yZSB7XG4gICAgICAvLyBsaW5lLWhlaWdodDogdmFyKC0tYnV0dG9uLXNpemUpO1xuICAgIH1cbiAgfVxuXG4gIC5xbC1waWNrZXIucWwtaGVhZGVyIHtcbiAgICB3aWR0aDogMTE1cHggIWltcG9ydGFudDtcbiAgfVxuICAucWwtcGlja2VyLnFsLWZvbnQge1xuICAgIHdpZHRoOiAxNjBweCAhaW1wb3J0YW50O1xuXG4gICAgJjo6YmVmb3JlIHtcbiAgICB9XG4gIH1cblxuICBodG1sICYgLnFsLXBpY2tlci5xbC1oZWFkZXIge1xuICAgIC5xbC1waWNrZXItbGFiZWwsXG4gICAgLnFsLXBpY2tlci1pdGVtIHtcbiAgICAgICY6OmJlZm9yZSB7XG4gICAgICAgIGNvbnRlbnQ6IFwiUmVndWxhciB0ZXh0XCI7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGh0bWxbbGFuZz1cImZyXCJdICYgLnFsLXBpY2tlci5xbC1oZWFkZXIge1xuICAgIC5xbC1waWNrZXItbGFiZWwsXG4gICAgLnFsLXBpY2tlci1pdGVtIHtcbiAgICAgICY6OmJlZm9yZSB7XG4gICAgICAgIGNvbnRlbnQ6IFwiVGV4dGUgY291cmFudFwiO1xuICAgICAgfVxuXG4gICAgICAmW2RhdGEtdmFsdWU9XCIxXCJdOjpiZWZvcmUge1xuICAgICAgICBjb250ZW50OiBcIlRpdHJlIDFcIjtcbiAgICAgICAgZm9udC13ZWlnaHQ6IDcwMDtcbiAgICAgIH1cbiAgICAgICZbZGF0YS12YWx1ZT1cIjJcIl06OmJlZm9yZSB7XG4gICAgICAgIGNvbnRlbnQ6IFwiVGl0cmUgMlwiO1xuICAgICAgICBmb250LXdlaWdodDogNzAwO1xuICAgICAgfVxuICAgICAgJltkYXRhLXZhbHVlPVwiM1wiXTo6YmVmb3JlIHtcbiAgICAgICAgY29udGVudDogXCJUaXRyZSAzXCI7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiA3MDA7XG4gICAgICB9XG4gICAgICAmW2RhdGEtdmFsdWU9XCI0XCJdOjpiZWZvcmUge1xuICAgICAgICBjb250ZW50OiBcIlRpdHJlIDRcIjtcbiAgICAgICAgZm9udC13ZWlnaHQ6IDcwMDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyAucWwtcGlja2VyLnFsLXNpemUgLnFsLXBpY2tlci1sYWJlbFtkYXRhLXZhbHVlPVwiNzUlXCJdOjpiZWZvcmUsXG4gIC8vIC5xbC1waWNrZXIucWwtc2l6ZSAucWwtcGlja2VyLWl0ZW1bZGF0YS12YWx1ZT1cIjc1JVwiXTo6YmVmb3JlIHtcbiAgLy8gICBjb250ZW50OiBcIlNtYWxsXCI7XG4gIC8vICAgZm9udC1zaXplOiA3MCUgIWltcG9ydGFudDtcblxuICAvLyAgIGh0bWxbbGFuZz1cImZyXCJdICYge1xuICAvLyAgICAgY29udGVudDogXCJQZXRpdFwiO1xuICAvLyAgIH1cbiAgLy8gfVxuICAvLyAucWwtcGlja2VyLnFsLXNpemUgLnFsLXBpY2tlci1sYWJlbDpub3QoW2RhdGEtdmFsdWVdKTo6YmVmb3JlLFxuICAvLyAucWwtcGlja2VyLnFsLXNpemUgLnFsLXBpY2tlci1pdGVtOm5vdChbZGF0YS12YWx1ZV0pOjpiZWZvcmUge1xuICAvLyAgIGNvbnRlbnQ6IFwiUmVndWxhclwiO1xuICAvLyAgIGZvbnQtc2l6ZTogMTAwJSAhaW1wb3J0YW50O1xuXG4gIC8vICAgaHRtbFtsYW5nPVwiZnJcIl0gJiB7XG4gIC8vICAgICBjb250ZW50OiBcIk5vcm1hbFwiO1xuICAvLyAgIH1cbiAgLy8gfVxuICAvLyAucWwtcGlja2VyLnFsLXNpemUgLnFsLXBpY2tlci1sYWJlbFtkYXRhLXZhbHVlPVwiMTUwJVwiXTo6YmVmb3JlLFxuICAvLyAucWwtcGlja2VyLnFsLXNpemUgLnFsLXBpY2tlci1pdGVtW2RhdGEtdmFsdWU9XCIxNTAlXCJdOjpiZWZvcmUge1xuICAvLyAgIGNvbnRlbnQ6IFwiTGFyZ2VcIjtcbiAgLy8gICBmb250LXNpemU6IDE1MCUgIWltcG9ydGFudDtcblxuICAvLyAgIGh0bWxbbGFuZz1cImZyXCJdICYge1xuICAvLyAgICAgY29udGVudDogXCJHcmFuZFwiO1xuICAvLyAgIH1cbiAgLy8gfVxuICAvLyAucWwtcGlja2VyLnFsLXNpemUgLnFsLXBpY2tlci1sYWJlbFtkYXRhLXZhbHVlPVwiMzAwJVwiXTo6YmVmb3JlLFxuICAvLyAucWwtcGlja2VyLnFsLXNpemUgLnFsLXBpY2tlci1pdGVtW2RhdGEtdmFsdWU9XCIzMDAlXCJdOjpiZWZvcmUge1xuICAvLyAgIGNvbnRlbnQ6IFwiSHVnZVwiO1xuICAvLyAgIGZvbnQtc2l6ZTogMzAwJSAhaW1wb3J0YW50O1xuXG4gIC8vICAgaHRtbFtsYW5nPVwiZnJcIl0gJiB7XG4gIC8vICAgICBjb250ZW50OiBcIsOJbm9ybWVcIjtcbiAgLy8gICB9XG4gIC8vIH1cblxuICAucWwtcGlja2VyLnFsLXNpemUgLnFsLXBpY2tlci1sYWJlbFtkYXRhLXZhbHVlXTo6YmVmb3JlIHtcbiAgICBmb250LXNpemU6IDEwMCUgIWltcG9ydGFudDtcbiAgfVxufVxuXG4uX1RFYnRuQ29udGFpbmVyIHtcbiAgd2lkdGg6IDEwMCU7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZmxvdzogcm93IHdyYXA7XG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuXG4gID4gKiB7XG4gICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tdG9vbGJhci1iZyk7XG4gICAgYm9yZGVyLXJhZGl1czogMTJweDtcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgIGJhY2tncm91bmQ6ICNmZmY7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWZsb3c6IHJvdyB3cmFwO1xuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuXG4gICAgLl9lZGl0QnRuIHtcbiAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWMtYmxldXZlcnQpO1xuICAgIH1cblxuICAgIC5fY29sbGFiRWRpdG9yU3RhdHVzIHtcbiAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWMtdmVydCk7XG4gICAgfVxuICB9XG4gIC8vIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWVkaXRvci1iZyk7XG59XG48L3N0eWxlPlxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/babel-loader/lib/index.js??clonedRuleSet-37[0].rules[0].use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./src/adc-core/fields/collaborative-editor/CollaborativeEditor2.vue?vue&type=script&lang=js&\n");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ !function() {
/******/ 	__webpack_require__.h = function() { return "3eadefbbffe5feb4"; }
/******/ }();
/******/ 
/******/ }
);