(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[947],{6427:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return ct}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"_lumaView"},[t.shared_folder_path?[s("div",{staticClass:"_panes"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.show_chutier,expression:"show_chutier"}],key:"myContent",staticClass:"_myContent"},[t.show_authors_modal?s("AuthorList",{on:{close:function(e){t.show_authors_modal=!1}}}):t._e(),t.connected_as?s("MyChutier",{attrs:{shared_space_path:t.shared_folder_path},on:{showAuthorModal:t.showAuthorModal,close:function(e){t.show_chutier=!1}}}):t._e()],1),t.show_chutier?t._e():s("button",{staticClass:"u-buttonLink _openChutier",attrs:{type:"button"},on:{click:function(e){t.show_chutier=!0}}},[t._v(" "+t._s(t.$t("chutier"))+" ")]),s("div",{key:"sharedContent",staticClass:"_sharedContent"},[s("SharedFolder",{attrs:{shared_folder_path:t.shared_folder_path}})],1)])]:s("LoaderSpinner")],2)},i=[],o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("BaseModal2",{attrs:{title:t.$t("contributors")},on:{close:function(e){return t.$emit("close")}}},[s("div",[t.connected_as?t.connected_as?s("fieldset",[s("legend",{staticClass:"u-label"},[t._v(t._s(t.$t("your_account")))]),s("AuthorCard",{key:t.connected_as.$path,attrs:{author:t.connected_as}})],1):t._e():[s("RadioSwitch",{attrs:{content:t.current_mode,options:[{label:t.$t("login"),value:"login"},{label:t.$t("create_account"),value:"create"}]},on:{"update:content":function(e){t.current_mode=e}}}),s("br"),"login"===t.current_mode?s("LoginAs",{attrs:{authors:t.authors},on:{close:function(e){return t.$emit("close")}}}):"create"===t.current_mode?s("CreateAuthor",{on:{close:function(e){return t.$emit("close")}}}):t._e(),s("br")],s("br"),t.connected_as?[s("button",{staticClass:"u-button u-button_red",attrs:{type:"button"},on:{click:t.logout}},[t._v(" "+t._s(t.$t("logout"))+" ")]),s("br"),s("br")]:t._e(),s("DLabel",{attrs:{str:t.$t("list_of_contributors")}}),0===t.authors.length?s("small",[t._v(" "+t._s(t.$t("no_accounts_yet"))+" ")]):s("button",{staticClass:"u-button",attrs:{type:"button"},on:{click:function(e){t.show_authors_list=!t.show_authors_list}}},[t._v(" "+t._s(t.$t("show_list"))+" ("+t._s(t.authors_except_self.length)+") ")]),t.show_authors_list?s("div",{staticClass:"_listOfAuthors"},t._l(t.authors_except_self,(function(t){return s("AuthorCard",{key:t.$path,attrs:{author:t}})})),1):t._e()],2)])},r=[],n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"_createAuthor"},[s("form",{staticClass:"input-validation-required",on:{submit:function(e){return e.preventDefault(),t.createAuthor.apply(null,arguments)}}},[s("fieldset",[s("legend",{staticClass:"u-label"},[t._v(t._s(t.$t("new_account")))]),s("TextInput",{attrs:{content:t.new_author_name,label_str:"name_or_pseudonym",required:!0,maxlength:40,autocomplete:"username"},on:{"update:content":function(e){t.new_author_name=e},toggleValidity:function(e){return t.allow_save=e}}}),s("br"),s("TextInput",{attrs:{content:t.new_author_email,label_str:"email",required:!1,input_type:"email",autocomplete:"email"},on:{"update:content":function(e){t.new_author_email=e},toggleValidity:function(e){return t.allow_save=e}}}),s("br"),s("TextInput",{attrs:{content:t.new_author_password,label_str:t.$t("password"),minlength:3,maxlength:20,required:!0,input_type:"password",autocomplete:"new-password"},on:{"update:content":function(e){t.new_author_password=e},toggleValidity:function(e){return t.allow_save=e}}}),s("br"),s("DLabel",{attrs:{str:t.$t("role")}}),s("select",{directives:[{name:"model",rawName:"v-model",value:t.new_author_role,expression:"new_author_role"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.new_author_role=e.target.multiple?s:s[0]}}},t._l(t.author_roles,(function(e){return s("option",{key:e,domProps:{value:e,textContent:t._s(t.$t(e))}})})),0),s("br"),s("button",{staticClass:"u-button u-button_bleuvert",attrs:{slot:"footer",loading:t.is_creating_author,type:"submit"},slot:"footer"},[t._v(" "+t._s(t.$t("create"))+" ")])],1),t.error_msg?[s("div",{staticClass:"u-errorMsg",domProps:{textContent:t._s(t.error_msg)}})]:t._e()],2)])},l=[],c={props:{},components:{},data(){return{new_author_email:"",new_author_name:"",new_author_password:"",new_author_role:"contributor",author_roles:["contributor","admin"],is_creating_author:!1,error_msg:""}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{async createAuthor(){this.is_creating_author=!0;try{const t=await this.$api.createFolder({path:"/authors",additional_meta:{email:this.new_author_email,name:this.new_author_name,requested_slug:this.new_author_name,role:this.new_author_role,$status:"public",$password:this.new_author_password}});this.new_author_name="",await this.$api.loginToFolder({path:"authors/"+t,auth_infos:{$password:this.new_author_password}}),this.$emit("close")}catch(t){this.error_msg="Error: "+t.message,setTimeout((()=>{this.error_msg=""}),5e3)}this.is_creating_author=!1}}},d=c,u=(s(7880),s(1001)),_=(0,u.Z)(d,n,l,!1,null,"3d4180e5",null),h=_.exports,p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"_authorCard"},[s("TitleField",{attrs:{field_name:"name",label:t.$t("name"),content:t.author.name,path:t.author.$path,required:!0,minlength:3,maxlength:40,tag:"h2",can_edit:t.is_self}}),s("small",[t._v(" "+t._s(t.author.$path)+" ")]),s("br"),s("SelectField",{attrs:{field_name:"role",content:t.author.role,path:t.author.$path,can_edit:t.is_self,options:[{key:"contributor",text:t.$t("contributor"),instruction:t.$t("contributor_instructions")},{key:"admin",text:t.$t("admin"),instruction:t.$t("admin_instructions")}]}}),s("br"),t.is_self||t.is_admin?s("RemoveMenu",{attrs:{remove_text:t.$t("remove")},on:{remove:t.removeAuthor}}):t._e()],1)},m=[],f={props:{author:Object},components:{},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{is_self(){return!!this.connected_as&&this.connected_as.$path===this.author.$path}},methods:{async removeAuthor(){await this.$api.deleteItem({path:this.author.$path}),this.is_self&&await this.$api.logoutFromFolder()}}},v=f,g=(s(2744),(0,u.Z)(v,p,m,!1,null,"8c54b0c8",null)),b=g.exports,w=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.connected_as?t._e():s("form",{on:{submit:function(e){return e.preventDefault(),t.login.apply(null,arguments)}}},[s("fieldset",[s("legend",{staticClass:"u-label"},[t._v(t._s(t.$t("your_account")))]),s("TextInput",{ref:"nameField",attrs:{content:t.name_of_account,label_str:"name_or_pseudonym",required:!0,input_type:"text",autocomplete:"username"},on:{"update:content":function(e){t.name_of_account=e},toggleValidity:function(e){return t.allow_save=e}}}),s("br"),s("TextInput",{ref:"passwordField",attrs:{label_str:t.$t("password"),content:t.input_password,required:!0,input_type:"password",autocomplete:"current-password"},on:{"update:content":function(e){t.input_password=e},toggleValidity:function(e){return t.allow_save=e}}}),s("button",{staticClass:"u-buttonLink",attrs:{type:"button"}},[t._v(" "+t._s(t.$t("recover_password"))+" ")]),s("br"),s("br"),s("button",{staticClass:"u-button u-button_bleuvert",attrs:{type:"submit"}},[t._v(" "+t._s(t.$t("login"))+" ")])],1)])])},y=[],$={props:{authors:Array},components:{},data(){return{name_of_account:"",input_password:""}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{async login(){const t=this.authors.find((t=>t.name===this.name_of_account));if(!t)return this.$refs.nameField.$el.querySelector("input").select(),void this.$alertify.delay(4e3).error(this.$t("account_doesnt_exist"));const e=t.$path;this.$api.loginToFolder({path:e,auth_infos:{$password:this.input_password}}).then((()=>{this.$alertify.delay(4e3).success(this.$t("logged_in")),this.$emit("close")})).catch((t=>{"submitted_password_is_wrong"===t&&(this.$refs.passwordField.$el.querySelector("input").select(),this.$alertify.delay(4e4).error(this.$t("submitted_password_is_wrong")))}))}}},k=$,C=(0,u.Z)(k,w,y,!1,null,"5d3cb9d8",null),x=C.exports,F={props:{},components:{CreateAuthor:h,AuthorCard:b,LoginAs:x},data(){return{current_mode:"login",show_authors_list:!1,authors:[]}},created(){},async mounted(){this.authors=await this.$api.getFolders({path:"authors"}),0===this.authors.length&&(this.current_mode="create")},beforeDestroy(){},watch:{},computed:{authors_except_self(){return this.connected_as?this.authors.filter((t=>t.$path!==this.connected_as.$path)):this.authors}},methods:{async logout(){try{this.reponse=await this.$api.logoutFromFolder()}catch(t){return this.response=t,this.$alertify.delay(4e3).error(t),!1}}}},M=F,S=(s(6093),(0,u.Z)(M,o,r,!1,null,"d03d2a68",null)),I=S.exports,j=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.chutier?s("div",{staticClass:"_myChutier",on:{click:function(e){t.last_clicked=!1}}},[s("div",{staticClass:"_topContent"},[s("div",{staticClass:"_subscribeBtn"},[s("button",{staticClass:"u-button u-button_bleumarine _authorBtn",attrs:{type:"button"},on:{click:function(e){return t.$emit("showAuthorModal")}}},[t.connected_as?[t._v(" "+t._s(t.connected_as.name)+" ")]:[t._v(t._s(t.$t("login")))]],2)]),s("div",{staticClass:"_importBtn"},[s("input",{staticClass:"inputfile-2",attrs:{type:"file",multiple:"multiple",id:t.id+"-add_file",name:"file",accept:""},on:{change:function(e){return t.updateInputFiles(e)}}}),s("label",{attrs:{for:t.id+"-add_file"}},[t._v(" "+t._s(t.$t("import"))+" ")]),t.selected_files.length>0?s("UploadFiles",{attrs:{selected_files:t.selected_files,path:t.path},on:{close:function(e){t.selected_files=[]},importedMedias:t.importedMedias}}):t._e()],1),s("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}},[t._v(" "+t._s(t.$t("fold"))+" ")])]),s("div",{staticClass:"_middleContent"},[s("label",{attrs:{for:""}},[t._v("Éléments à traiter : "+t._s(t.chutier_items.length)+" ")]),s("br"),t.chutier_items.length>0?s("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:t.selectAll}},[t._v(" Sélectionner tout ")]):t._e()]),s("div",{staticClass:"_items"},t._l(t.chutier_items_grouped,(function(e){return s("div",{key:e.label,staticClass:"_item"},[s("div",{staticClass:"_item--label"},[s("DateField",{attrs:{date:e.label,show_detail_initially:!1}}),t.rangeIsSelected(e.files.map((function(t){return t.$path})))?s("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(s){t.deselectRange(e.files.map((function(t){return t.$path})))}}},[t._v(" Déselectionner ")]):s("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(s){t.selectRange(e.files.map((function(t){return t.$path})))}}},[t._v(" Sélectionner tout ")])],1),s("transition-group",{attrs:{tag:"div",name:"listComplete"}},t._l(e.files,(function(e){return s("div",{key:e.$path,on:{click:function(s){s.stopPropagation(),t.last_clicked=e.$path}}},[s("ChutierItem",{attrs:{file:e,is_clicked:t.last_clicked===e.$path,is_selected:t.selected_items_slugs.includes(e.$path),shared_space_path:t.shared_space_path},on:{toggleSelect:function(s){return t.toggleSelect(e.$path)}}})],1)})),0)],1)})),0),t.selected_items_slugs.length>0?s("div",{staticClass:"_selectionBar"},[s("div",{staticClass:"_selectionBar--previews"},t._l(t.selected_items,(function(t){return s("MediaContent",{key:t.$path,staticClass:"_selectionBar--previews--preview",attrs:{file:t,context:"preview"}})})),1),s("button",{staticClass:"u-button u-button_bleuvert",attrs:{type:"button"},on:{click:t.setSelectionAsFocus}},[t._v(" "+t._s(t.$t("create_stack"))+" ("+t._s(t.selected_items_slugs.length)+") ")]),s("div",{staticClass:"u-sameRow"},[s("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:t.deselectAll}},[s("sl-icon",{attrs:{name:"dash-square-dotted"}}),t._v(" Déselectionner tout ")],1),s("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:t.removeItemsInSelection}},[s("sl-icon",{attrs:{name:"trash3"}}),t._v(" Supprimer la sélection ")],1)])]):t._e(),t.focused_items.length>0?s("MediaStack",{staticClass:"_mediaStack",attrs:{files:t.focused_items,shared_space_path:t.shared_space_path},on:{updateFocusedMedia:function(e){t.focused_items_slugs=e},close:function(e){t.focused_items_slugs=[]}}}):t._e()],1):t._e()},B=[],A=(s(5827),s(7658),s(6699),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"u-chutierItem",class:{"is--clicked":t.is_clicked}},[s("div",{staticClass:"u-chutierItem--rows"},[s("div",{staticClass:"u-sameRow _infos"},[t.$listeners&&t.$listeners.toggleSelect?s("label",{staticClass:"_selectBox",attrs:{for:t.id}},[s("input",{attrs:{type:"checkbox",name:t.id,id:t.id},domProps:{checked:t.is_selected},on:{change:function(e){return t.$emit("toggleSelect")}}})]):t._e(),s("div",{staticClass:"u-chutierItem--openLarge",on:{click:function(e){t.show_large=!0}}},[s("MediaContent",{staticClass:"u-chutierItem--preview",attrs:{file:t.file,context:"preview"}})],1),s("div",{staticClass:"_titleDateField"},[s("div",[s("div",{},[s("small",[t._v(" "+t._s(t.formatDateToHuman(t.file.$date_created))+" ")])]),t.edit_mode?[s("input",{directives:[{name:"model",rawName:"v-model",value:t.text_title,expression:"text_title"}],staticClass:"is--dark",attrs:{type:"text",required:"",placeholder:"Remplir pour partager"},domProps:{value:t.text_title},on:{input:function(e){e.target.composing||(t.text_title=e.target.value)}}})]:s("div",[t._v(" "+t._s(t.text_title)+" ")])],2)]),t.edit_mode?t._e():s("EditBtn",{on:{click:function(e){t.edit_mode=!0}}})],1),s("transition",{attrs:{name:"scaleInFade",mode:"out-in"}},[t.shared_space_path?s("sl-icon-button",{key:t.share_button_is_enabled,staticClass:"u-shareBtn",class:{"is--disabled":!t.share_button_is_enabled},staticStyle:{"font-size":"1rem"},attrs:{name:"arrow-right-square",label:t.$t("share"),circle:""},on:{click:t.shareButtonClicked}}):t._e()],1)],1),"stack"!==t.context&&(t.edit_mode||t.keywords||t.description)?s("div",{staticClass:"_keywords"},[t.edit_mode?[s("input",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"is--dark",attrs:{type:"text",placeholder:"Description"},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.keywords,expression:"keywords"}],staticClass:"is--dark",attrs:{type:"text",required:"",placeholder:"Mot-clé, matériaux, lieux, etc."},domProps:{value:t.keywords},on:{input:function(e){e.target.composing||(t.keywords=e.target.value)}}}),0===t.keywords.length?s("span",{staticClass:"u-instructions"},[t._v(" Corrigez ou complétez le titre et les mots-clés pour partager ce document. ")]):s("div",{staticClass:"_suggestions"},t._l(t.panes[0].categories,(function(e){return s("button",{key:e,staticClass:"u-button u-button_orange",attrs:{type:"button"}},[t._v(" "+t._s(e)+" ")])})),0)]:s("div",[t.description?s("div",{},[t._v(" "+t._s(t.description)+" ")]):t._e(),t.keywords?s("div",{},[s("span",{staticClass:"u-button u-button_orange"},[t._v(" "+t._s(t.keywords)+" ")])]):t._e()])],2):t._e(),t.show_large?s("div",{staticClass:"u-chutierItem--largePreview",on:{click:function(e){t.show_large=!1}}},[s("MediaContent",{attrs:{file:t.file,context:"full",resolution:1600}}),s("sl-button",{staticClass:"_closeBtn",attrs:{variant:"default",size:"medium",circle:""},on:{click:function(e){t.show_large=!1}}},[s("sl-icon",{attrs:{name:"x-lg",label:t.$t("close")}})],1)],1):t._e()])}),D=[],L={props:{file:Object,is_selected:Boolean,is_clicked:Boolean,shared_space_path:String,context:{type:String,default:"list"}},components:{},data(){return{opened_pane:void 0,show_large:!1,edit_mode:!1,id:`select_chutier_item_${(Math.random().toString(36)+"00000000000000000").slice(2,5)}`,panes:[{key:"materials",label:this.$t("materials"),categories:["abjection","abjections","abjectly","abjectness","abjectnesses","abjects","abjoint","abjointed","abjointing","abjoints","abjunction","abjunctions","abjuration","abjurations","abjure","abjured","abjurer","abjurers","abjures","abjuring"]},{key:"techniques",label:this.$t("techniques")},{key:"implementations",label:this.$t("implementations")}],text_title:this.file.title||this.cleanFilename(this.file.$media_filename)||"",description:this.file.description||"",keywords:this.file.keywords||""}},created(){},mounted(){},beforeDestroy(){},watch:{"file.title"(){this.text_title=this.file.title},is_clicked(){!this.is_clicked&&this.edit_mode&&(this.saveFields(),this.edit_mode=!1)}},computed:{share_button_is_enabled(){return this.text_title.length>0&&this.keywords.length>0}},methods:{async moveToSharedSpace(){const t=this.shared_space_path;await this.$api.copyFile({path:this.file.$path,destination_path_to_folder:t,new_meta:{$authors:[this.connected_as.$path]}}),await this.remove()},async remove(){this.$api.deleteItem({path:this.file.$path})},cleanFilename(){return this.file.$media_filename.substring(0,this.file.$media_filename.lastIndexOf("."))},async shareButtonClicked(){if(this.share_button_is_enabled){if(this.edit_mode)return await this.saveFields(),void await this.moveToSharedSpace();await this.moveToSharedSpace()}else this.edit_mode=!0},openLarge(){this.$emit("")},async saveFields(){await this.$api.updateMeta({path:this.file.$path,new_meta:{title:this.text_title,description:this.description,keywords:this.keywords}}).catch((t=>{throw this.$alertify.delay(4e3).error(t),t}))},save(){},cancel(){this.edit_mode=!1}}},q=L,O=(s(8899),(0,u.Z)(q,A,D,!1,null,"60809362",null)),T=O.exports,Z=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"_mediaFocus",on:{click:function(e){t.last_clicked=!1}}},[s("sl-button",{staticClass:"_closeBtn",attrs:{variant:"default",size:"medium",circle:""},on:{click:function(e){return t.$emit("close")}}},[s("sl-icon",{attrs:{name:"x-lg",label:t.$t("close")}})],1),s("div",{staticClass:"_fileStack"},[s("transition-group",{staticClass:"_itemsList",attrs:{tag:"div",name:"listComplete"}},t._l(t.files,(function(e,a){return s("div",{key:e.$path,staticClass:"u-sameRow",on:{click:function(s){s.stopPropagation(),t.last_clicked=e.$path}}},[s("select",{staticClass:"is--dark _changeOrderSelect",domProps:{value:a+1},on:{change:function(e){return t.changeMediaOrder(a,+e.target.value-1)}}},t._l(new Array(t.files.length).fill(null),(function(e,a){return s("option",{key:a+1,domProps:{textContent:t._s(a+1)}})})),0),s("ChutierItem",{attrs:{file:e,is_clicked:t.last_clicked===e.$path,is_selected:!1,context:"stack"}})],1)})),0)],1),s("div",{staticClass:"_fields"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"is--dark",attrs:{type:"text",required:"",placeholder:"Titre"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"is--dark",attrs:{type:"text",placeholder:"Description"},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.keywords,expression:"keywords"}],staticClass:"is--dark",attrs:{type:"text",required:"",placeholder:"Mot-clé, matériaux, lieux, etc."},domProps:{value:t.keywords},on:{input:function(e){e.target.composing||(t.keywords=e.target.value)}}}),0===t.keywords.length?s("span",{staticClass:"u-instructions"},[t._v(" Corrigez ou complétez le titre et les mots-clés pour partager cette pile. ")]):t._e()]),s("transition",{attrs:{name:"scaleInFade",mode:"out-in"}},[s("sl-icon-button",{key:t.share_button_is_enabled,staticClass:"u-shareBtn",class:{"is--disabled":!t.share_button_is_enabled},staticStyle:{"font-size":"1rem"},attrs:{name:"arrow-right-square",label:t.$t("share"),circle:""},on:{click:t.shareButtonClicked}})],1)],1)},P=[],z={props:{files:Array,shared_space_path:String},components:{ChutierItem:T},data(){return{last_clicked:void 0,title:"",description:"",keywords:""}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{share_button_is_enabled(){return this.title.length>0&&this.keywords.length>0}},methods:{changeMediaOrder(t,e){let s=this.files.map((t=>t.$path));function a(t,e,s){if(s>=t.length){var a=s-t.length+1;while(a--)t.push(void 0)}return t.splice(s,0,t.splice(e,1)[0]),t}a(s,t,e),this.$emit("updateFocusedMedia",s)},async shareButtonClicked(){const t=this.shared_space_path;this.title,this.description,this.keywords;const e={title:this.title,description:this.description,keywords:this.keywords,requested_slug:"stack",is_stack:!0,stack_files_metas:[]},s=await this.$api.uploadFile({path:t,additional_meta:e}).catch((t=>{throw this.$alertify.delay(4e3).error(t),t})),a=[];for(const i of this.files){const e=await this.$api.copyFile({path:i.$path,destination_path_to_folder:t,new_meta:{$authors:[this.connected_as.$path],belongs_to_stack:s}});a.push(e),await this.$api.deleteItem({path:i.$path})}await this.$api.updateMeta({path:t+"/"+s,new_meta:{stack_files_metas:a}}),this.$emit("close")}}},E=z,N=(s(2387),(0,u.Z)(E,Z,P,!1,null,"4e73af38",null)),R=N.exports,V={props:{shared_space_path:String},components:{ChutierItem:T,MediaStack:R},data(){return{chutier:void 0,selected_files:[],id:`image_select_${(Math.random().toString(36)+"00000000000000000").slice(2,5)}`,last_clicked:void 0,selected_items_slugs:[],focused_items_slugs:[]}},created(){},mounted(){this.listChutier(),this.$api.join({room:this.path})},beforeDestroy(){this.$api.leave({room:this.path})},watch:{chutier_items(){this.selected_items_slugs=this.selected_items_slugs.filter((t=>this.chutier_items.find((e=>e.$path===t))))}},computed:{path(){return this.connected_as.$path},focused_items(){return this.focused_items_slugs.map((t=>this.chutier_items.find((e=>e.$path===t))))},selected_items(){return this.selected_items_slugs.map((t=>this.chutier_items.find((e=>e.$path===t))))},chutier_items(){if(!this.chutier||!this.chutier.$files)return[];const t=JSON.parse(JSON.stringify(this.chutier.$files));return t.sort(((t,e)=>+new Date(e.$date_uploaded)-+new Date(t.$date_uploaded))),t},chutier_items_grouped(){const t=this.chutier_items.reduce(((t,e)=>{var s=new Date(e.$date_created),a=s.getUTCMonth()+1,i=s.getUTCDate(),o=s.getUTCFullYear();const r=o+"/"+a+"/"+i;return Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(e),t}),{});let e=[];for(const s in t)Object.prototype.hasOwnProperty.call(e,s)||e.push(s);return e.sort(),e.reverse(),e.map((e=>({label:e,files:t[e]})))}},methods:{async listChutier(){this.chutier=await this.$api.getFolder({path:this.path}).catch((t=>{this.fetch_project_error=t.response,this.is_loading=!1}))},toggleSelect(t){this.selected_items_slugs.includes(t)?this.selected_items_slugs=this.selected_items_slugs.filter((e=>e!==t)):this.selected_items_slugs.push(t)},setSelectionAsFocus(){this.focused_items_slugs=JSON.parse(JSON.stringify(this.selected_items_slugs))},updateInputFiles(t){this.selected_files=Array.from(t.target.files),t.target.value=""},async importedMedias(t){this.selected_items_slugs=t.map((t=>this.connected_as.$path+"/"+t))},selectAll(){this.selected_items_slugs=this.chutier_items.map((t=>t.$path))},deselectAll(){this.selected_items_slugs=[]},selectRange(t){this.selected_items_slugs=this.selected_items_slugs.concat(t),this.selected_items_slugs=[...new Set(this.selected_items_slugs)]},deselectRange(t){this.selected_items_slugs=this.selected_items_slugs.filter((e=>!t.includes(e)))},rangeIsSelected(t){return 0!==this.selected_items_slugs.length&&!t.find((t=>!1===this.selected_items_slugs.includes(t)))},async removeItemsInSelection(){for(const t of this.selected_items_slugs)await this.$api.deleteItem({path:t})}}},J=V,U=(s(9495),(0,u.Z)(J,j,B,!1,null,"d4a6c95e",null)),K=U.exports,H=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.shared_folder?s("div",{staticClass:"_sharedFolder"},[t._m(0),s("div",{staticClass:"_grid"},t._l(t.shared_items,(function(t){return s("SharedFolderItem",{key:t.$path,staticClass:"_item",attrs:{file:t}})})),1)]):t._e()},W=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"_floatingTopBtn"},[s("div",{},[t._v("Espace partagé")])])}],Y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"_sharedFolderItem"},[t.file.is_stack?s("div",{staticClass:"_sharedFolderItem--previewStack"},t._l(t.file._stack_files,(function(t){return s("MediaContent",{key:t.$path,attrs:{file:t,context:"preview"}})})),1):s("MediaContent",{staticClass:"_sharedFolderItem--preview",attrs:{file:t.file,context:"preview"}}),s("small",{staticClass:"_titleKeywords"},[t._v(" "+t._s(t.file.title)+" / "+t._s(t.file.description)+" / "+t._s(t.file.keywords)+" ")]),s("sl-icon-button",{staticClass:"_removeBtn",attrs:{name:"trash3",circle:""},on:{click:function(e){return t.removeMedia(t.file.$path)}}})],1)},G=[],Q={props:{file:Object},components:{},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{removeMedia(t){this.$api.deleteItem({path:t})}}},X=Q,tt=(s(389),(0,u.Z)(X,Y,G,!1,null,"93dd2598",null)),et=tt.exports,st={props:{shared_folder_path:String},components:{SharedFolderItem:et},data(){return{shared_folder:void 0}},created(){},async mounted(){this.shared_folder=await this.$api.getFolder({path:this.shared_folder_path}),this.$api.join({room:this.shared_folder_path})},beforeDestroy(){},watch:{},computed:{shared_items(){var t;if(null===(t=this.shared_folder)||void 0===t||!t.$files)return[];const e=JSON.parse(JSON.stringify(this.shared_folder.$files)),s=e.filter((t=>t.belongs_to_stack)),a=e.reduce(((t,e)=>(e.belongs_to_stack||(e.is_stack&&e.stack_files_metas&&(e._stack_files=e.stack_files_metas.map((t=>s.find((e=>e.$path.endsWith("/"+t)))))),t.push(e)),t)),[]);return a.sort(((t,e)=>+new Date(e.$date_uploaded)-+new Date(t.$date_uploaded))),a}},methods:{}},at=st,it=(s(3379),(0,u.Z)(at,H,W,!1,null,"577b3f13",null)),ot=it.exports,rt={props:{},components:{AuthorList:I,MyChutier:K,SharedFolder:ot},data(){return{path:"folders",folders:void 0,shared_folder_path:void 0,show_authors_modal:!1,show_chutier:!0}},created(){},async mounted(){this.$i18n.locale="fr",await this.loadFolder(),this.connected_as||this.showAuthorModal()},beforeDestroy(){},watch:{connected_as(){}},computed:{},methods:{async loadFolder(){this.folders=await this.$api.getFolders({path:this.path}).catch((t=>{this.fetch_spaces_error=t.response})),0===this.folders.length?(await this.createFolder(),window.location.reload()):this.shared_folder_path=this.folders[0].$path},async createFolder(){try{const t=await this.$api.createFolder({path:this.path});return t}catch(t){}},showAuthorModal(){this.show_authors_modal=!0}}},nt=rt,lt=(s(2428),(0,u.Z)(nt,a,i,!1,null,"564be527",null)),ct=lt.exports},9376:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),o=s(3645),r=s.n(o),n=r()(i());n.push([t.id,"._authorCard[data-v-8c54b0c8]{padding:calc(var(--spacing)/2)}",""]),e["default"]=n},2673:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),o=s(3645),r=s.n(o),n=r()(i());n.push([t.id,"._listOfAuthors[data-v-d03d2a68]{display:flex;flex-flow:column nowrap;gap:calc(var(--spacing)/4);margin:calc(var(--spacing)/4) 0}",""]),e["default"]=n},2748:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),o=s(3645),r=s.n(o),n=r()(i());n.push([t.id,"",""]),e["default"]=n},839:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),o=s(3645),r=s.n(o),n=r()(i());n.push([t.id,"._catBtn[data-v-60809362]{background:#ffbe32;border-radius:5px;margin:2px;padding:2px}._keywords[data-v-60809362]{display:flex;flex-flow:column nowrap;gap:calc(var(--spacing)/2);padding:calc(var(--spacing)/2);justify-content:center}._selectBox[data-v-60809362]{height:70px;display:flex;place-content:center}",""]),e["default"]=n},4845:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),o=s(3645),r=s.n(o),n=r()(i());n.push([t.id,"._mediaFocus[data-v-4e73af38]{background:var(--chutier-bg)}._itemsList[data-v-4e73af38],._mediaFocus[data-v-4e73af38]{padding:calc(var(--spacing)/2)}._itemsList[data-v-4e73af38]{border:2px solid #999}._closeBtn[data-v-4e73af38]{position:absolute;top:0;right:0}._openLarge[data-v-4e73af38]{display:block;cursor:pointer}._openLarge[data-v-4e73af38]:hover{opacity:.8}._docPreview[data-v-4e73af38]{position:relative;height:70px;border-radius:2px;width:70px;flex:0 0 auto;overflow:hidden}._docPreview[data-v-4e73af38]  ._mediaContent--image{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:center;object-position:center}._changeOrderSelect[data-v-4e73af38]{flex:0 0 50px}._fields[data-v-4e73af38]{padding:calc(var(--spacing)*2);display:flex;flex-flow:column nowrap;gap:calc(var(--spacing)/1)}",""]),e["default"]=n},3856:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),o=s(3645),r=s.n(o),n=r()(i());n.push([t.id,"._myChutier[data-v-d4a6c95e]{--chutier-bg:#252729;height:100%;overflow:auto;background:#f9f9f9;background:var(--chutier-bg);color:#fff}._topContent[data-v-d4a6c95e]{position:sticky;z-index:1;display:flex;gap:calc(var(--spacing)/2);top:0;padding:calc(var(--spacing)/1);-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px);-webkit-mask:linear-gradient(#000 75%,transparent);mask:linear-gradient(#000 75%,transparent)}._middleContent[data-v-d4a6c95e]{padding:0 calc(var(--spacing)/1)}._items[data-v-d4a6c95e]{padding:calc(var(--spacing)/1)}._item[data-v-d4a6c95e]{margin-bottom:calc(var(--spacing)/1)}._item--label[data-v-d4a6c95e]{font-weight:500;margin-bottom:2px}._selectionBar[data-v-d4a6c95e]{position:sticky;bottom:0;flex-flow:column nowrap;justify-content:center;align-items:center;box-shadow:0 2px 6px 0 #000;background:var(--chutier-bg);padding:calc(var(--spacing)/2)}._selectionBar[data-v-d4a6c95e],._selectionBar--previews[data-v-d4a6c95e]{width:100%;display:flex;gap:calc(var(--spacing)/2)}._selectionBar--previews[data-v-d4a6c95e]{flex-flow:row nowrap}._selectionBar--previews[data-v-d4a6c95e]  ._mediaContent--image{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:center;object-position:center}._selectionBar--previews--preview[data-v-d4a6c95e]{flex:0 1 50px;aspect-ratio:1/1}._mediaStack[data-v-d4a6c95e]{position:absolute;z-index:10;top:0;width:100%;height:100%;overflow:auto}",""]),e["default"]=n},3754:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),o=s(3645),r=s.n(o),n=r()(i());n.push([t.id,"._sharedFolder[data-v-577b3f13]{padding:calc(var(--spacing)*1)}._grid[data-v-577b3f13]{display:flex;flex-flow:row wrap;justify-content:center;align-items:flex-end;gap:calc(var(--spacing)*4) calc(var(--spacing)*1)}._item[data-v-577b3f13]{width:150px}._removeBtn[data-v-577b3f13]{position:absolute;top:0;right:0;z-index:1}._floatingTopBtn[data-v-577b3f13]{position:sticky;top:0;z-index:1;width:100%;display:flex;justify-content:center;padding:calc(var(--spacing)/1);pointer-events:none}._floatingTopBtn>*[data-v-577b3f13]{border-radius:25px;padding:calc(var(--spacing)/1) calc(var(--spacing)*2);background:#000;color:#fff;pointer-events:auto}",""]),e["default"]=n},9737:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),o=s(3645),r=s.n(o),n=r()(i());n.push([t.id,"._sharedFolderItem[data-v-93dd2598],._sharedFolderItem ._sharedFolderItem--previewStack[data-v-93dd2598]{position:relative}._sharedFolderItem ._sharedFolderItem--previewStack[data-v-93dd2598]>:last-child{position:relative;z-index:1}._sharedFolderItem ._sharedFolderItem--previewStack[data-v-93dd2598]>:not(:first-child){position:absolute;top:-10px}._sharedFolderItem ._sharedFolderItem--previewStack[data-v-93dd2598]>:nth-last-child(2){top:-20px}._sharedFolderItem ._sharedFolderItem--previewStack[data-v-93dd2598]>:nth-last-child(3){top:-30px}._sharedFolderItem[data-v-93dd2598]  ._mediaContent--image{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:center;object-position:center}._titleKeywords[data-v-93dd2598]{position:absolute;bottom:0;left:0;width:100%}._removeBtn[data-v-93dd2598]{position:absolute;bottom:0;right:0}",""]),e["default"]=n},721:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),o=s(3645),r=s.n(o),n=r()(i());n.push([t.id,"._lumaView[data-v-564be527],._panes[data-v-564be527]{height:100%}._panes[data-v-564be527]{display:flex;flex-flow:row nowrap}._myContent[data-v-564be527]{position:relative;z-index:1;flex:0 0 420px;height:100%;background:#fff;box-shadow:0 0 10px rgba(0,0,0,.52)}._sharedContent[data-v-564be527]{height:100%;flex:1 1 auto;overflow:auto}._openChutier[data-v-564be527]{position:absolute;top:0;left:0;padding:calc(var(--spacing)/2)}",""]),e["default"]=n},2744:function(t,e,s){var a=s(9376);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(1982).Z;i("9487f366",a,!0,{sourceMap:!1,shadowMode:!1})},6093:function(t,e,s){var a=s(2673);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(1982).Z;i("4f10f38e",a,!0,{sourceMap:!1,shadowMode:!1})},7880:function(t,e,s){var a=s(2748);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(1982).Z;i("121c10f6",a,!0,{sourceMap:!1,shadowMode:!1})},8899:function(t,e,s){var a=s(839);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(1982).Z;i("f8b68c1c",a,!0,{sourceMap:!1,shadowMode:!1})},2387:function(t,e,s){var a=s(4845);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(1982).Z;i("2ae91c43",a,!0,{sourceMap:!1,shadowMode:!1})},9495:function(t,e,s){var a=s(3856);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(1982).Z;i("3ca1a855",a,!0,{sourceMap:!1,shadowMode:!1})},3379:function(t,e,s){var a=s(3754);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(1982).Z;i("4e97d094",a,!0,{sourceMap:!1,shadowMode:!1})},389:function(t,e,s){var a=s(9737);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(1982).Z;i("de4fa17c",a,!0,{sourceMap:!1,shadowMode:!1})},2428:function(t,e,s){var a=s(721);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(1982).Z;i("5324757c",a,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=LumaView.js.map