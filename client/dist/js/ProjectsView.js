(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[614],{461:function(t,e,r){"use strict";r.d(e,{Z:function(){return A}});var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"_projectInfos",class:{"is--preview":"list"===t.context,"u-card":"list"===t.context}},[r("div",{ref:"coverImage",staticClass:"_projectInfos--cover",class:{"is--fullscreen":t.is_fullscreen,"is--empty":!t.cover_thumb}},[t.cover_thumb?[r("img",{attrs:{src:t.cover_thumb}}),"full"===t.context?r("sl-button",{staticClass:"_fsButton u-buttonLink",attrs:{size:"small",variant:"neutral"},on:{click:t.toggleFs}},[r("sl-icon",{attrs:{name:t.is_fullscreen?"fullscreen-exit":"arrows-fullscreen"}})],1):t._e()]:r("div",{staticClass:"_noImage"}),"full"===t.context&&t.can_edit_project?r("CoverField",{attrs:{cover:t.project.$cover,path:t.project.$path}}):t._e()],2),r("div",{staticClass:"_projectInfos--infos"},[r("div",{staticClass:"u-padding_round"},[r("AuthorField",{attrs:{label:"full"===t.context?t.$t("contributors"):"",authors_slugs:t.project.$authors,path:t.project.$path,can_edit:t.can_edit_project}}),r("TitleField",{attrs:{field_name:"title",label:"full"===t.context?t.$t("title"):"",content:t.project.title,path:t.project.$path,required:!0,maxlength:40,tag:"full"===t.context?"h1":"h2",can_edit:t.can_edit_project}}),r("TitleField",{attrs:{field_name:"description",label:"full"===t.context&&(t.project.description||t.can_edit_project)?t.$t("description"):"",content:t.project.description,path:t.project.$path,maxlength:280,can_edit:t.can_edit_project}})],1)]),"full"===t.context?r("div",{staticClass:"_projectInfos--meta"},[r("CardMeta",{attrs:{project:t.project,can_edit_project:t.can_edit_project}}),r("CardStatus",{attrs:{project:t.project,can_edit_project:t.can_edit_project}}),r("CardKeywords",{attrs:{project:t.project,can_edit_project:t.can_edit_project}}),r("CardMachines",{attrs:{project:t.project,can_edit_project:t.can_edit_project}}),r("CardLicense",{attrs:{project:t.project,can_edit_project:t.can_edit_project}})],1):t._e(),"list"===t.context?r("div",{staticClass:"_projectInfos--open"},[r("router-link",{staticClass:"u-button u-button_red",attrs:{to:{path:"/"+t.project.$path}}},[t._v(" ouvrir  "),r("sl-icon",{attrs:{name:"arrow-up-right"}})],1)],1):t._e()])},o=[],s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ProjectCard",[r("div",{attrs:{slot:"header"},slot:"header"},[t._v(" "+t._s(t.$t("informations"))+" ")]),r("DateField",{attrs:{title:"date_created",date:t.project.$date_created}}),r("br"),r("DateField",{attrs:{title:"date_modified",date:t.project.$date_modified}}),r("br"),t._v(" Supprimer ce projet "),r("button",{attrs:{type:"button"},on:{click:t.removeProject}},[t._v(" Confirmer la suppression ")])],1)},c=[],n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("sl-card",{staticClass:"_projectCard u-card"},[t.$slots["header"]?r("header",{attrs:{slot:"header"},slot:"header"},[t._t("header")],2):t._e(),t._t("default")],2)},i=[],l={props:{},components:{},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{}},p=l,d=(r(2655),r(1001)),u=(0,d.Z)(p,n,i,!1,null,"38fce0f1",null),_=u.exports,h={props:{project:Object,can_edit_project:Boolean},components:{ProjectCard:_},data(){return{edit_mode:!1}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{enableEditMode(){this.edit_mode=!0},async removeProject(){this.fetch_status="pending",this.fetch_error=null;try{const t=await this.$api.deleteItem({path:this.project.$path});this.response=t.data,this.fetch_status="success"}catch(t){this.fetch_status="error",this.fetch_error=t.response.data}}}},f=h,b=(0,d.Z)(f,s,c,!1,null,"692d4ef1",null),m=b.exports,j=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ProjectCard",[r("div",{attrs:{slot:"header"},slot:"header"},[t._v(" "+t._s(t.$t("keywords"))+" ")]),r("div",{},[r("TagsField",{attrs:{field_name:"keywords",content:t.project.keywords,path:t.project.$path,can_edit:t.can_edit_project}})],1)])},v=[],x={props:{project:Object,can_edit_project:Boolean},components:{ProjectCard:_},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{}},w=x,g=(0,d.Z)(w,j,v,!1,null,"733fe7a8",null),$=g.exports,y=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ProjectCard",[r("div",{attrs:{slot:"header"},slot:"header"},[t._v(" "+t._s(t.$t("machines_and_materials"))+" ")]),r("div",{},[r("TagsField",{attrs:{field_name:"materials",content:t.project.materials,path:t.project.$path,can_edit:t.can_edit_project}})],1)])},C=[],k={props:{project:Object,can_edit_project:Boolean},components:{ProjectCard:_},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{}},I=k,P=(0,d.Z)(I,y,C,!1,null,"15b186fb",null),M=P.exports,F=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ProjectCard",[r("div",{attrs:{slot:"header"},slot:"header"},[t._v(" "+t._s(t.$t("progress"))+" "),r("sl-icon",{attrs:{name:"globe"}})],1),r("div",{},[r("ToggleField",{attrs:{label:t.$t("public"),field_name:"$public",content:t.project.$public,path:t.project.$path,options:{true:t.$t("public_status_explanations"),false:t.$t("not_public_status_explanations")},can_edit:t.can_edit_project}}),r("br"),r("SelectField",{attrs:{field_name:"status",content:t.project.status,path:t.project.$path,can_edit:t.can_edit_project,options:t.status_options}}),r("div",{staticClass:"u-wips"})],1)])},T=[],E={props:{project:Object,can_edit_project:Boolean},components:{ProjectCard:_},data(){return{status_options:[{key:"draft",text:"draft_status_explanations"},{key:"finished",text:"finished_status_explanations"}],visible_value:this.project.status}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{}},Z=E,D=(0,d.Z)(Z,F,T,!1,null,"25a1491b",null),L=D.exports,S=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ProjectCard",[r("div",{attrs:{slot:"header"},slot:"header"},[t._v(" "+t._s(t.$t("license"))+" "),r("sl-icon",{attrs:{name:"file-earmark-spreadsheet"}})],1),r("div",{},[r("RadioField",{attrs:{field_name:"license",content:t.project.license,path:t.project.$path,can_edit:t.can_edit_project,options:t.license_options}})],1)])},B=[],z={props:{project:Object,can_edit_project:Boolean},components:{ProjectCard:_},data(){return{license_options:[{key:"creativecommons_by_nc_sa",text:"creativecommons_by_nc_sa_explanations"},{key:"all_rights_reserved",text:"all_rights_reserved_explanations"},{key:"copyleft",text:"copyleft_explanations"},{key:"custom_license",text:"custom_license_explanations"}]}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{}},R=z,O=(0,d.Z)(R,S,B,!1,null,"0e9d29e4",null),q=O.exports,N={props:{project:Object,context:String,can_edit_project:Boolean},components:{CardMeta:m,CardKeywords:$,CardMachines:M,CardStatus:L,CardLicense:q},data(){return{new_title:this.project.title,fetch_status:null,fetch_error:null,response:null,confirm_remove:!1,preview_rawdata:null,show_lib:!1,select_cover_image:!1,is_fullscreen:!1}},created(){},mounted(){document.addEventListener("fullscreenchange",this.detectFullScreen)},beforeDestroy(){document.removeEventListener("fullscreenchange",this.detectFullScreen)},watch:{},computed:{cover_thumb(){return this.makeRelativeURLFromThumbs({$thumbs:this.project.$cover,$type:"image",$path:this.project.$path,resolution:1200})}},methods:{detectFullScreen(){document.fullscreenElement?this.is_fullscreen=!0:(this.is_fullscreen=!1,this.$nextTick((()=>{})))},toggleFs(){const t=this.$refs.coverImage;this.is_fullscreen?document.exitFullscreen():t.requestFullscreen().catch((t=>t))},async updateProject(){this.fetch_status="pending",this.fetch_error=null;try{this.response=await this.$api.updateMeta({path:this.project.$path,new_meta:{title:this.new_title}}),this.fetch_status="success"}catch(t){this.fetch_status="error",this.fetch_error=t.response.data}}}},V=N,K=(r(4546),(0,d.Z)(V,a,o,!1,null,"05b52b33",null)),A=K.exports},1822:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return g}});var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"_projectsView"},[r("div",{staticClass:"_title"},[r("h1",[t._v("Les projets")]),r("br"),r("div",[t.$api.is_logged_in?r("button",{staticClass:"u-button u-button_red u-button_big",attrs:{type:"button"},on:{click:function(e){t.show_create_modal=!0}}},[r("svg",{staticStyle:{"enable-background":"new 0 0 168 168"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 168 168","xml:space":"preserve"}},[r("path",{staticStyle:{fill:"#fc4b60"},attrs:{d:"M24.6,24.4c-32.8,32.8-32.8,86.1,0,119c32.8,32.8,85.9,32.8,118.7,0c32.8-32.8,32.8-85.9,0-118.7\n\t\tC110.5-8.2,57.5-8.2,24.6,24.4z"}}),r("polygon",{staticStyle:{fill:"#ffbe32"},attrs:{points:"132.3,73.4 132.3,94.4 94.6,94.4 94.6,132.1 73.6,132.1 73.6,94.4 35.9,94.4 35.9,73.4 \n\t\t73.6,73.4 73.6,35.7 94.6,35.7 94.6,73.4 \t\t"}})]),t._v(" "+t._s(t.$t("create"))+" ")]):t._e(),r("br"),t.$api.debug_mode?r("ProjectsTester"):t._e(),r("br")],1)]),t.show_create_modal?r("CreateProject",{on:{close:function(e){t.show_create_modal=!1},openNewProject:t.openNewProject}}):t._e(),r("h3",[t._v("Finalisés")]),r("div",{staticClass:"_projectsList"},t._l(t.finalized_projects,(function(t){return r("ProjectPresentation",{key:t.$path,attrs:{project:t,context:"list"}})})),1),r("hr"),r("h3",[t._v("En cours")]),r("div",{staticClass:"_projectsList"},t._l(t.draft_projects,(function(t){return r("ProjectPresentation",{key:t.$path,attrs:{project:t,context:"list"}})})),1)],1)},o=[],s=(r(7658),r(461)),c=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("BaseModal2",{attrs:{title:t.$t("create_a_project")},on:{close:function(e){return t.$emit("close")}}},[r("form",{staticClass:"input-validation-required",on:{submit:function(e){return e.preventDefault(),t.createProject.apply(null,arguments)}}},[r("div",{staticClass:"_topLabel"},[r("label",{staticClass:"u-label",attrs:{for:""}},[t._v(t._s(t.$t("title")))])]),r("TextInput",{attrs:{content:t.new_project_title,maxlength:40,required:!0},on:{"update:content":function(e){t.new_project_title=e},toggleValidity:function(e){return t.allow_save=e}}}),r("br"),r("div",{},[r("ToggleInput",{attrs:{content:t.new_project_is_public,label:t.$t("public"),options:{true:t.$t("public_status_explanations"),false:t.$t("not_public_status_explanations")}},on:{"update:content":function(e){t.new_project_is_public=e}}})],1),r("br"),r("sl-button",{attrs:{slot:"footer",variant:"primary",loading:t.is_creating_project,type:"submit"},slot:"footer"},[t._v(" "+t._s(t.$t("create_and_open"))+" ")]),t.error_msg?[r("br"),r("br"),r("div",{staticClass:"u-errorMsg",domProps:{textContent:t._s(t.error_msg)}})]:t._e()],2)])},n=[],i={props:{},components:{},data(){return{new_project_title:"",new_project_is_public:!0,is_creating_project:!1,allow_save:!1,error_msg:""}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{async createProject(){this.is_creating_project=!0;try{const t=await this.$api.createFolder({path:"/projects",additional_meta:{title:this.new_project_title,requested_slug:this.new_project_title,status:"draft",license:"CC",$public:this.new_project_is_public,$authors:["louis","pauline"]}});setTimeout((()=>{this.$emit("openNewProject",t)}),50)}catch(t){this.error_msg="Error: "+t.message,setTimeout((()=>{this.error_msg=""}),5e3),this.is_creating_project=!1}}}},l=i,p=r(1001),d=(0,p.Z)(l,c,n,!1,null,"16de08ec",null),u=d.exports,_=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t._m(0),t.routine_is_started?[r("button",{staticClass:"u-button u-button_red u-button_big",attrs:{type:"button"},on:{click:t.stopRoutine}},[t._v(" stop routine ")])]:[r("button",{staticClass:"u-button u-button_red u-button_big",attrs:{type:"button"},on:{click:t.startRoutine}},[t._v(" start ")])]],2)},h=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"_topLabel"},[r("label",{staticClass:"u-label",attrs:{for:""}},[t._v("routine")])])}],f={props:{},components:{},data(){return{routine_is_started:!1}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{async startRoutine(){this.routine_is_started=!0;const t=await this.$api.createFolder({path:"projects",additional_meta:{title:"Z test project "+this.$api.socket.userID,$authors:["sarah"]}});await new Promise((t=>setTimeout(t,200))),await this.$api.updateMeta({path:`projects/${t}`,new_meta:{$authors:["louis","pauline"]}}),await new Promise((t=>setTimeout(t,200))),await this.$api.updateMeta({path:`/projects/${t}`,new_meta:{title:"Nouveau titre "+this.$api.socket.userID}}),await new Promise((t=>setTimeout(t,200))),await this.$api.updateMeta({path:`projects/${t}`,new_meta:{keywords:["plop"]}}),await new Promise((t=>setTimeout(t,200))),await this.$api.updateMeta({path:`projects/${t}`,new_meta:{keywords:["plip"]}}),await new Promise((t=>setTimeout(t,500))),await this.$api.deleteItem({path:`projects/${t}`}),await new Promise((t=>setTimeout(t,250))),this.routine_is_started&&this.startRoutine()},async stopRoutine(){this.routine_is_started=!1}}},b=f,m=(r(672),(0,p.Z)(b,_,h,!1,null,"53de7100",null)),j=m.exports,v={props:{},components:{ProjectPresentation:s.Z,CreateProject:u,ProjectsTester:j},data(){return{path:"projects",projects:[],show_create_modal:!1}},created(){},async mounted(){this.projects=await this.$api.getFolders({path:this.path}),this.$api.join({room:this.path})},beforeDestroy(){this.$api.leave({room:this.path})},watch:{},computed:{sorted_projects(){const t=this.projects.slice();return t.sort((function(t,e){let r=t.date_created,a=e.date_created;return r===a?0:r<a?-1:1}))},finalized_projects(){return this.sorted_projects.filter((t=>"finished"===t.status))},draft_projects(){return this.sorted_projects.filter((t=>"finished"!==t.status))}},methods:{openNewProject(t){this.show_create_modal=!1,this.$router.push(`/projects/${t}`)}}},x=v,w=(r(7919),(0,p.Z)(x,a,o,!1,null,"1f3cb536",null)),g=w.exports},2476:function(t,e,r){"use strict";r.r(e);var a=r(8081),o=r.n(a),s=r(3645),c=r.n(s),n=c()(o());n.push([t.id,"._topLabel[data-v-53de7100]{text-align:left}",""]),e["default"]=n},3552:function(t,e,r){"use strict";r.r(e);var a=r(8081),o=r.n(a),s=r(3645),c=r.n(s),n=c()(o());n.push([t.id,"._projectCard[data-v-38fce0f1]{border:0;border-radius:0;box-shadow:none}",""]),e["default"]=n},2778:function(t,e,r){"use strict";r.r(e);var a=r(8081),o=r.n(a),s=r(3645),c=r.n(s),n=c()(o());n.push([t.id,"._project[data-v-05b52b33]{position:relative}._projectInfos[data-v-05b52b33]{display:flex;flex-flow:row wrap;align-items:stretch;margin:0 auto;overflow:hidden;background:#fff}._projectInfos.is--preview[data-v-05b52b33]{border-bottom:2px solid #b9b9b9;box-shadow:0 1px 4px rgba(0,0,0,.1)}._projectInfos>*[data-v-05b52b33]{flex:10 1 320px}._projectInfos>._projectInfos--meta[data-v-05b52b33]{flex:1 0 260px;max-height:calc(50vw - 130px)}._projectInfos--infos[data-v-05b52b33]{display:flex;flex-flow:column nowrap;gap:calc(var(--spacing)/2);place-content:center;transition:all .4s}._projectInfos--infos>*[data-v-05b52b33]{max-width:66ch}._imageSelect[data-v-05b52b33]{background:#fff;position:relative}._projectInfos--cover[data-v-05b52b33]{position:relative;overflow:hidden;min-width:280px;min-height:280px;aspect-ratio:1/1;--color1:var(--c-gris);--color2:var(--c-gris_clair)}._projectInfos--cover.is--empty[data-v-05b52b33]{background:radial-gradient(circle,transparent 20%,var(--color1) 20%,var(--color1) 80%,transparent 80%,transparent),radial-gradient(circle,transparent 20%,var(--color1) 20%,var(--color1) 80%,transparent 80%,transparent) 15px 15px,linear-gradient(var(--color2) 1.2px,transparent 1.2px) 0 -.6px,linear-gradient(90deg,var(--color2) 1.2px,var(--color1) 1.2px) -.6px 0;background-size:30px 30px,30px 30px,15px 15px,15px 15px}._projectInfos--cover img[data-v-05b52b33]{position:absolute;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}._projectInfos--cover.is--fullscreen img[data-v-05b52b33]{-o-object-fit:contain;object-fit:contain}._projectInfos--cover[data-v-05b52b33]  ._noImage{position:absolute;z-index:-1;width:100%;height:100%;background-color:var(--c-gris_fonce)}._projectInfos--cover[data-v-05b52b33]  ._fsButton{position:absolute;bottom:0;margin:calc(var(--spacing)/1)}._projectInfos--meta[data-v-05b52b33]{display:flex;flex-flow:column nowrap;font-size:90%;overflow:auto}._projectInfos--meta>*[data-v-05b52b33]{flex:0 0 260px;border:1px solid var(--c-gris)}._projectInfos--meta[data-v-05b52b33]>:first-child{border-top:0 solid #000}._projectInfos--meta[data-v-05b52b33]>:not(:last-child){border-bottom:0 solid #000}._projectInfos--open[data-v-05b52b33]{display:flex;justify-content:center;margin:calc(var(--spacing)*1)}._projectInfos--open a[data-v-05b52b33]{transition:all .25s cubic-bezier(.19,1,.22,1)}._projectInfos--open a[data-v-05b52b33]:focus,._projectInfos--open a[data-v-05b52b33]:hover{transform:translateY(-4px) rotate(-2deg);box-shadow:0 3px 6px rgba(0,0,0,.16),0 3px 6px rgba(0,0,0,.23)}",""]),e["default"]=n},8511:function(t,e,r){"use strict";r.r(e);var a=r(8081),o=r.n(a),s=r(3645),c=r.n(s),n=c()(o());n.push([t.id,"._projectsView[data-v-1f3cb536]{padding:calc(var(--spacing)*1)}._projectsList[data-v-1f3cb536]{display:grid;grid-auto-rows:max-content;grid-gap:calc(var(--spacing)/1);align-items:flex-start;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));border-radius:6px;overflow:hidden}._projectsList>*[data-v-1f3cb536]{box-shadow:0 1px 4px rgba(0,0,0,.1);width:100%}._projectsList[data-v-1f3cb536]  ._projectInfos{min-height:100%;display:block}._title[data-v-1f3cb536]{text-align:center}",""]),e["default"]=n},672:function(t,e,r){var a=r(2476);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var o=r(1982).Z;o("08e42dca",a,!0,{sourceMap:!1,shadowMode:!1})},2655:function(t,e,r){var a=r(3552);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var o=r(1982).Z;o("4d002b02",a,!0,{sourceMap:!1,shadowMode:!1})},4546:function(t,e,r){var a=r(2778);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var o=r(1982).Z;o("0505b752",a,!0,{sourceMap:!1,shadowMode:!1})},7919:function(t,e,r){var a=r(8511);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var o=r(1982).Z;o("6922fef3",a,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=ProjectsView.js.map