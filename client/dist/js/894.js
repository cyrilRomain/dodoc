(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[894],{98656:function(t,e,i){"use strict";i.d(e,{Z:function(){return d}});var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"_mediaPicker"},[i("PickMediaFromProjects",{attrs:{path:t.current_project_path,mode:"multiple",meta_filenames_already_present:t.meta_filenames_already_present},on:{selectMedias:function(e){return t.$emit("selectMedias",e)},close:function(e){return t.$emit("close")}}})],1)},o=[],s={props:{publication_path:String,meta_filenames_already_present:Array},components:{},data(){return{}},async created(){},beforeDestroy(){},watch:{},computed:{current_project_path(){const t=this.getParent(this.publication_path);return this.getParent(t)}},methods:{}},n=s,l=(i(7298),i(1001)),r=(0,l.Z)(n,a,o,!1,null,"2ce62bab",null),d=r.exports},94989:function(t,e,i){"use strict";i.d(e,{Z:function(){return h}});var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"_moduleCreator"},[t.show_module_selector||!t.is_collapsed?i("div",{staticClass:"_typePicker"},[i("button",{staticClass:"u-button u-button_bleumarine",attrs:{type:"button"},on:{click:t.createText}},[i("sl-icon",{staticStyle:{"font-size":"var(--icon-size)"},attrs:{name:"fonts",label:t.$t("add_text")}})],1),i("button",{staticClass:"u-button u-button_bleumarine",attrs:{type:"button"},on:{click:function(e){t.show_media_picker=!0}}},[i("sl-icon",{staticStyle:{"font-size":"var(--icon-size)"},attrs:{name:"image",label:t.$t("add_medias")}})],1),t.show_media_picker?i("MediaPicker",{attrs:{publication_path:t.publication_path,meta_filenames_already_present:t.meta_filenames_already_present},on:{selectMedias:t.createMosaic,close:function(e){t.show_media_picker=!1}}}):t._e(),i("button",{staticClass:"u-button u-button_bleumarine",attrs:{type:"button"},on:{click:function(e){t.show_link_picker=!0}}},[i("sl-icon",{staticStyle:{"font-size":"var(--icon-size)"},attrs:{name:"link",label:t.$t("add_link")}})],1),t.show_link_picker?i("LinkPicker",{attrs:{publication_path:t.publication_path},on:{embed:t.createEmbed,close:function(e){t.show_link_picker=!1}}}):t._e(),!0===t.show_shapes?t._l(t.shapes,(function(e){return i("button",{key:e.type,staticClass:"u-button u-button_bleumarine",attrs:{type:"button"},on:{click:function(i){return t.createModule({module_type:e.type,addtl_meta:e.addtl_meta})}}},[i("sl-icon",{staticStyle:{"font-size":"var(--icon-size)"},attrs:{name:e.icon,label:t.$t(e.type)}})],1)})):t._e()],2):t._e(),t.is_collapsed?i("button",{staticClass:"u-button _showModuleSelector _sideBtns",style:t.show_module_selector?"transform: rotate(45deg);":"",attrs:{type:"button"},on:{click:function(e){t.show_module_selector=!t.show_module_selector}}},[i("sl-icon",{attrs:{name:"plus-circle"}})],1):t._e(),i("transition",{attrs:{name:"dropzone",duration:150}},[t.show_dropzone?i("DropZone",{on:{mediaDropped:t.createMosaic}}):t._e()],1)],1)},o=[],s=(i(57658),i(98656)),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("BaseModal2",{on:{close:function(e){return t.$emit("close")}}},[i("div",{staticClass:"_linkPicker"},[i("div",{staticClass:"_urlBox"},[i("DLabel",{attrs:{str:t.$t("input_url"),instructions:t.$t("input_url_instr")}}),i("input",{directives:[{name:"model",rawName:"v-model",value:t.full_url,expression:"full_url"}],attrs:{type:"url",placeholder:"https://"},domProps:{value:t.full_url},on:{input:function(e){e.target.composing||(t.full_url=e.target.value)}}})],1),i("div",{staticClass:"u-instructions"},[t._v(" PeerTube, YouTube, Vimeo, etc. "+t._s(t.$t("for_example"))+"Â  "),t._l(["https://peertube.fr/w/wB6M6CHdfpWXpozVnqjbde","https://www.youtube.com/watch?v=Bn6zdyCAwJs","https://vimeo.com/447785086","https://observablehq.com/embed/@fil/bertin1953-glsl?cells=canvas"],(function(e,a){return i("button",{key:a,staticClass:"u-buttonLink",attrs:{type:"button"},domProps:{innerHTML:t._s(e)},on:{click:function(i){t.full_url=e}}})}))],2),i("br"),i("div",{key:t.full_url},["any"===t.url_to_site.type?[i("iframe",{staticClass:"_siteIframe",attrs:{src:t.url_to_site.src,frameborder:"0"}})]:i("vue-plyr",[i("div",{staticClass:"plyr__video-embed"},[i("iframe",{attrs:{src:t.url_to_site.src,allowfullscreen:"",allowtransparency:"",allow:"autoplay; fullscreen",sandbox:"allow-same-origin allow-scripts allow-popups",frameborder:"0"}})])])],2),i("br"),t.full_url?i("div",{staticClass:"_selectBtn"},[i("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}},[t._v(" "+t._s(t.$t("cancel"))+" ")]),i("button",{staticClass:"u-button u-button_bleuvert",attrs:{type:"button"},on:{click:function(e){return t.$emit("embed",t.full_url)}}},[t._v(" "+t._s(t.$t("embed"))+" ")])]):t._e()])])},l=[],r={props:{publication_path:String},components:{},data(){return{full_url:"https://"}},async created(){},beforeDestroy(){},watch:{},computed:{url_to_site(){return!!this.full_url&&this.transformURL({url:this.full_url,autoplay:!1})}},methods:{}},d=r,u=(i(70586),i(1001)),c=(0,u.Z)(d,n,l,!1,null,"5f9b4bb8",null),_=c.exports,p={props:{publication_path:String,meta_filenames_already_present:Array,addtl_meta:Object,context:String,show_shapes:Boolean,is_collapsed:{type:Boolean,default:!0}},components:{MediaPicker:s.Z,LinkPicker:_},data(){return{show_module_selector:!1,show_media_picker:!1,show_link_picker:!1,show_dropzone:!1,shapes:[{type:"ellipsis",icon:"circle-fill",addtl_meta:{background_color:"#1d327f"}},{type:"rectangle",icon:"square-fill",addtl_meta:{background_color:"#ffbe32"}},{type:"line",icon:"dash-lg",addtl_meta:{outline_width:1,outline_color:"#000000"}},{type:"arrow",icon:"arrow-right-square",addtl_meta:{outline_width:1,outline_color:"#000000"}}],is_saving:!1}},created(){},mounted(){this.$eventHub.$on("mediadrag.start",this.showDropzone),this.$eventHub.$on("mediadrag.end",this.hideDropzone)},beforeDestroy(){this.$eventHub.$off("mediadrag.start",this.showDropzone),this.$eventHub.$off("mediadrag.end",this.hideDropzone)},watch:{},computed:{},methods:{async createMosaic({meta_filename:t,path_to_source_media_metas:e}){let i=[];if(t?i.push({meta_filename:t}):e&&e.map((t=>{const e=this.getFilename(t);i.push({meta_filename_in_project:e})})),"page_by_page"===this.context&&(i=i.map((t=>(t.objectFit="contain",t)))),"page_by_page"===this.context)for(const o of i){var a;const t=this.getSourceMedia({source_media:o,folder_path:this.publication_path});let e={};null!==t&&void 0!==t&&null!==(a=t.$infos)&&void 0!==a&&a.ratio&&(e.height=this.$root.default_new_module_width*t.$infos.ratio),await this.createModule({module_type:"mosaic",source_medias:[o],addtl_meta:e})}else await this.createModule({module_type:"mosaic",source_medias:i});this.show_media_picker=!1},async createEmbed(t){const e=await this.$api.uploadText({path:this.publication_path,filename:"url.txt",content:t,additional_meta:{module_type:this.module_type,$type:"url"}});this.createMosaic({meta_filename:e})},async createText(){const t=await this.$api.uploadText({path:this.publication_path,filename:"text.txt",content:"",additional_meta:{caption:"plip",module_type:this.module_type}}),e=[{meta_filename:t}];await this.createModule({module_type:"text",source_medias:e})},async createModule({module_type:t,source_medias:e=[],addtl_meta:i={}}){const a=await this.createMetaForModule({module_type:t,source_medias:e,addtl_meta:i});this.$emit("addModule",{meta_filename:a}),this.show_module_selector=!1},async createMetaForModule({module_type:t,source_medias:e,addtl_meta:i}){let a={module_type:t,source_medias:e,requested_slug:"module"};return this.addtl_meta&&Object.assign(a,this.addtl_meta,i),await this.$api.uploadFile({path:this.publication_path,additional_meta:a}).catch((t=>{throw this.$alertify.delay(4e3).error(t),t}))},showDropzone(){this.show_dropzone=!0},hideDropzone(){this.show_dropzone=!1}}},m=p,b=(i(95539),(0,u.Z)(m,a,o,!1,null,"1ba70b6d",null)),h=b.exports},218:function(t,e,i){"use strict";i.d(e,{Z:function(){return M}});var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"_publicationModule",class:{"is--shape":t.is_shape,"has--fsButton":t.show_fs_button}},[t.can_edit&&"page_by_page"!==t.page_template?i("div",{staticClass:"_sideOptions"},[i("span",[t.$listeners.hasOwnProperty("moveUp")&&"first"!==t.module_position&&"alone"!==t.module_position?i("button",{staticClass:"_sideBtns _moveBefore",attrs:{type:"button"},on:{click:function(e){return t.$emit("moveUp")}}},[i("svg",{staticStyle:{transform:"rotate(90deg)"},attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 168 168"}},[i("path",{staticStyle:{fill:"currentColor"},attrs:{d:"M87.46,49.46,73.39,64.77a65.3,65.3,0,0,1-6.15,6.15A47.8,47.8,0,0,1,61,75.29H131.6V91.14H61A39.1,39.1,0,0,1,67,95.51q2.81,2.46,6.36,6.15L87.46,117,74.48,128,34.17,83.21,74.48,38.39Z"}})])]):t._e()]),i("div",{staticClass:"_options"},[i("button",{staticClass:"_sideBtns",class:{"is--active":t.show_advanced_menu},attrs:{type:"button"},on:{click:function(e){e.stopPropagation(),t.show_advanced_menu=!t.show_advanced_menu}}},[i("svg",{staticStyle:{fill:"currentColor"},attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"24",height:"24",viewBox:"0 0 48 48","xml:space":"preserve"}},[i("circle",{attrs:{cx:"12",cy:"24",r:"4"}}),i("circle",{attrs:{cx:"24",cy:"24",r:"4"}}),i("circle",{attrs:{cx:"36",cy:"24",r:"4"}})])]),t.show_advanced_menu?i("div",{staticClass:"_advanced_menu"},[i("sl-button",{attrs:{variant:"default",size:"small",pill:""}},[t._v(" "+t._s(t.$t("module.label."+t.publimodule.module_type))+" ")]),i("div",{staticClass:"_buttonRow"},[i("button",{staticClass:"u-button",attrs:{type:"button",disabled:!t.publimodule.size||100===t.publimodule.size},on:{click:function(e){return t.updateMeta({size:100})}}},[t._v(" 100% ")]),i("button",{staticClass:"u-button",attrs:{type:"button",disabled:66.6===t.publimodule.size},on:{click:function(e){return t.updateMeta({size:66.6})}}},[t._v(" 66% ")]),i("button",{staticClass:"u-button",attrs:{type:"button",disabled:50===t.publimodule.size},on:{click:function(e){return t.updateMeta({size:50})}}},[t._v(" 50% ")]),i("button",{staticClass:"u-button",attrs:{type:"button",disabled:33.3===t.publimodule.size},on:{click:function(e){return t.updateMeta({size:33.3})}}},[t._v(" 33% ")])]),100!==t.publimodule.size?i("div",{staticClass:"_buttonRow"},[i("button",{staticClass:"u-button",attrs:{type:"button",disabled:!t.publimodule.align||"left"===t.publimodule.align},on:{click:function(e){return t.updateMeta({align:"left"})}}},[i("sl-icon",{attrs:{name:"align-start"}})],1),i("button",{staticClass:"u-button",attrs:{type:"button",disabled:"center"===t.publimodule.align},on:{click:function(e){return t.updateMeta({align:"center"})}}},[i("sl-icon",{attrs:{name:"align-center"}})],1),i("button",{staticClass:"u-button",attrs:{type:"button",disabled:"right"===t.publimodule.align},on:{click:function(e){return t.updateMeta({align:"right"})}}},[i("sl-icon",{attrs:{name:"align-end"}})],1)]):t._e(),i("div",{staticClass:"_buttonRow"},[i("button",{staticClass:"u-button",attrs:{type:"button"},on:{click:t.duplicateModule}},[t._v(" "+t._s(t.$t("duplicate"))+" ")]),i("button",{staticClass:"u-button",attrs:{type:"button"},on:{click:t.removeModule}},[t._v(" "+t._s(t.$t("remove"))+" ")])])],1):t._e()]),i("span",[t.$listeners.hasOwnProperty("moveDown")&&"last"!==t.module_position&&"alone"!==t.module_position?i("button",{staticClass:"_sideBtns _moveAfter",attrs:{type:"button"},on:{click:function(e){return t.$emit("moveDown")}}},[i("svg",{staticStyle:{transform:"rotate(90deg)"},attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 168 168"}},[i("path",{staticStyle:{fill:"currentColor"},attrs:{d:"M78.31,117l14.07-15.31a65.3,65.3,0,0,1,6.15-6.15,47.52,47.52,0,0,1,6.29-4.37H34.17V75.29h70.65a39.1,39.1,0,0,1-6.08-4.37q-2.8-2.46-6.36-6.15L78.31,49.46l13-11.07L131.6,83.21,91.29,128Z"}})])]):t._e()])]):t._e(),i("div",{staticClass:"_content",style:t.media_styles},["mosaic"===t.publimodule.module_type?i("ModuleMosaic",{attrs:{publimodule:t.publimodule,can_edit:t.can_edit,context:t.context,page_template:t.page_template,number_of_max_medias:t.number_of_max_medias,show_fs_button:t.show_fs_button},on:{updateMeta:t.updateMeta,remove:t.removeModule}}):"carousel"===t.publimodule.module_type?i("ModuleCarousel",{attrs:{publimodule:t.publimodule,context:t.context,can_edit:t.can_edit}}):"text"===t.publimodule.module_type&&t.first_media?i("CollaborativeEditor2",{ref:"textBloc",attrs:{path:t.first_media.$path,content:t.first_media.$content,scrollingContainer:t.$el,line_selected:!1,can_edit:t.can_edit},on:{lineClicked:function(e){return t.$emit("lineClicked",e)},contentIsEdited:function(e){return t.$emit("contentIsEdited",e)},contentIsNotEdited:function(e){return t.$emit("contentIsNotEdited",e)}}}):t.is_shape?[i("svg",{attrs:{viewBox:"0 0 100 100",preserveAspectRatio:"none",xmlns:"http://www.w3.org/2000/svg"}},["ellipsis"===t.publimodule.module_type?i("circle",{attrs:{cx:"50",cy:"50",r:50-t.publimodule.outline_width*t.magnification/8,"vector-effect":"non-scaling-stroke"}}):"rectangle"===t.publimodule.module_type?i("rect",{attrs:{x:t.publimodule.outline_width*t.magnification/4,y:t.publimodule.outline_width*t.magnification/4,width:100-t.publimodule.outline_width*t.magnification/2,height:100-t.publimodule.outline_width*t.magnification/2,"vector-effect":"non-scaling-stroke",rx:t.borderRadius/2||0,ry:t.borderRadius/2||0}}):"line"===t.publimodule.module_type?i("g",[i("rect",{attrs:{width:"100",height:"100","vector-effect":"non-scaling-stroke",stroke:"none",rx:t.borderRadius/2||0,ry:t.borderRadius/2||0}}),i("line",{attrs:{x1:t.publimodule.outline_width*t.magnification/4||0,y1:"50",x2:100-(t.publimodule.outline_width*t.magnification/4||0),y2:"50","vector-effect":"non-scaling-stroke"}})]):"arrow"===t.publimodule.module_type?i("g",[i("rect",{attrs:{width:"100",height:"100","vector-effect":"non-scaling-stroke",stroke:"none",rx:t.borderRadius/2||0,ry:t.borderRadius/2||0}}),i("line",{attrs:{x1:t.publimodule.outline_width*t.magnification/4||0,y1:"50",x2:100-(t.publimodule.outline_width*t.magnification/4||0),y2:"50","vector-effect":"non-scaling-stroke"}}),i("g",{attrs:{transform:"\n              translate("+(100-(t.publimodule.outline_width*t.magnification/4||0))+", 50)",preserveAspectRatio:""}},[i("line",{attrs:{x1:"0",y1:"0",x2:"-10",y2:"-10","vector-effect":"non-scaling-stroke"}}),i("line",{attrs:{x1:"0",y1:"0",x2:"-10",y2:"10","vector-effect":"non-scaling-stroke"}})])]):t._e()])]:"free_drawing"===t.publimodule.module_type?void 0:i("small",[t._v(t._s(t.$t("nothing_to_show")))])],2)])},o=[],s=(i(52262),i(24506),i(26699),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"fade_fast",mode:"out-in"}},[i("div",{key:t.is_multiple_medias?"multiple":"single",staticClass:"_moduleMosaic",class:{"is--multipleMedias":t.is_multiple_medias},style:"--number_of_medias: "+t.medias_with_linked.length},[i("div",{staticClass:"_mediaGrid"},[t._l(t.medias_with_linked,(function(e,a){return[i("div",{key:e._linked_media&&e._linked_media.$path||"no_media_"+a,staticClass:"_mediaGrid--item",style:t.itemStyle({media_with_linked:e})},[e._linked_media?i("MediaContent",{attrs:{file:e._linked_media,resolution:"preview"===t.context?220:1600,context:t.context,show_fs_button:t.show_fs_button}}):i("span",{staticClass:"_noSourceMedia u-instructions",domProps:{textContent:t._s(t.$t("source_media_missing"))}}),t.can_edit?i("div",{staticClass:"_btnRow"},[(t.is_multiple_medias||"page_by_page"===t.page_template&&!t.single_media_displayed_at_full_ratio)&&e.objectFit&&"cover"!==e.objectFit?i("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(e){return t.frameFit({index:a,opt:{objectFit:"cover"}})}}},[t._v(" "+t._s(t.$t("object_fit_cover"))+" ")]):t._e(),(t.is_multiple_medias||"page_by_page"===t.page_template&&!t.single_media_displayed_at_full_ratio)&&"contain"!==e.objectFit?i("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(e){return t.frameFit({index:a,opt:{objectFit:"contain"}})}}},[t._v(" "+t._s(t.$t("object_fit_contain"))+" ")]):t._e(),t.is_multiple_medias?i("button",{staticClass:"u-buttonLink",attrs:{type:"button"},on:{click:function(e){return t.removeMediaAtIndex(a)}}},[t._v(" "+t._s(t.$t("remove"))+" ")]):t._e()]):t._e()],1)]})),t.can_edit&&(!t.number_of_max_medias||t.medias_with_linked.length<t.number_of_max_medias)?i("div",{staticClass:"_mediaPickerTile"},[t.show_media_picker?i("MediaPicker",{attrs:{publication_path:t.publication_path},on:{selectMedia:t.selectMedia,close:function(e){t.show_media_picker=!1}}}):i("sl-icon-button",{staticClass:"u-colorBleuvert",attrs:{name:"plus-circle-fill",label:t.$t("add_media")},on:{click:function(e){t.show_media_picker=!0}}}),i("transition",{attrs:{name:"dropzone",duration:150}},[t.show_dropzone&&t.medias_with_linked.length<t.number_of_max_medias?i("div",{staticClass:"_dropzone"},[i("DropZone",{on:{mediaDropped:t.selectMedia}})],1):t._e()])],1):t._e()],2)])])}),n=[],l=(i(57658),i(98656)),r={props:{publimodule:Object,can_edit:Boolean,context:{type:String,default:"full"},page_template:String,number_of_max_medias:[Boolean,Number],show_fs_button:Boolean},components:{MediaPicker:l.Z},data(){return{show_media_picker:!1,show_dropzone:!1}},created(){},mounted(){this.$eventHub.$on("mediadrag.start",this.showDropzone),this.$eventHub.$on("mediadrag.end",this.hideDropzone)},beforeDestroy(){this.$eventHub.$off("mediadrag.start",this.showDropzone),this.$eventHub.$off("mediadrag.end",this.hideDropzone)},watch:{},computed:{publication_path(){return this.getParent(this.publimodule.$path)},single_media_displayed_at_full_ratio(){var t;if(this.medias_with_linked.length>1)return!1;const e=null===(t=this.medias_with_linked[0]._linked_media.$infos)||void 0===t?void 0:t.ratio;return Math.round(10*e)===Math.round(this.publimodule.height/this.publimodule.width*10)},medias_with_linked(){return this.publimodule.source_medias?this.publimodule.source_medias.map((t=>{const e=this.getSourceMedia({source_media:t,folder_path:this.publication_path});return Object.assign({},t,{_linked_media:e})})):[]},is_multiple_medias(){return this.medias_with_linked.length>1}},methods:{selectMedia({path_to_source_media_meta:t}){const e=this.publimodule.source_medias.slice();e.push({path:t}),this.$emit("updateMeta",{source_medias:e}),this.show_media_picker=!1},removeMediaAtIndex(t){const e=this.publimodule.source_medias.slice();e.splice(t,1),0===e.length?this.$emit("remove"):this.$emit("updateMeta",{source_medias:e})},frameFit({index:t,opt:e}){const i=this.publimodule.source_medias.slice();Object.assign(i[t],e),this.$emit("updateMeta",{source_medias:i})},itemStyle({media_with_linked:t}){let e={};return e["--object-fit"]=t.objectFit||"cover",e},showDropzone(){this.show_dropzone=!0},hideDropzone(){this.show_dropzone=!1}}},d=r,u=(i(1420),i(1001)),c=(0,u.Z)(d,s,n,!1,null,"69869ebb",null),_=c.exports,p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._v(" ModuleCarousel "),t._l(t.medias,(function(e){return i("div",{key:e.$path},[e?i("MediaContent",{attrs:{file:e,resolution:1600,context:"full"}}):t._e()],1)}))],2)},m=[],b={props:{publimodule:Object,medias:Array},components:{},data(){return{}},created(){},mounted(){},beforeDestroy(){},watch:{},computed:{},methods:{}},h=b,f=(0,u.Z)(h,p,m,!1,null,"1491e03e",null),v=f.exports,g={props:{publimodule:Object,module_position:String,can_edit:Boolean,magnification:Number,borderRadius:Number,context:String,page_template:String,number_of_max_medias:{type:[Boolean,Number],default:!1}},components:{ModuleMosaic:_,ModuleCarousel:v},data(){return{show_advanced_menu:!1}},created(){},mounted(){this.$eventHub.$on(`module.enable_edit.${this.module_meta_filename}`,this.enableEditForText),this.$eventHub.$on(`module.duplicate.${this.module_meta_filename}`,this.duplicateModule),this.$eventHub.$on(`module.remove.${this.module_meta_filename}`,this.removeModule)},beforeDestroy(){this.$eventHub.$off(`module.enable_edit.${this.module_meta_filename}`,this.enableEditForText),this.$eventHub.$off(`module.duplicate.${this.module_meta_filename}`,this.duplicateModule),this.$eventHub.$off(`module.remove.${this.module_meta_filename}`,this.removeModule)},watch:{},computed:{module_meta_filename(){return this.publimodule.$path.split("/").at(-1)},is_shape(){return["ellipsis","rectangle","line","arrow"].includes(this.publimodule.module_type)},show_fs_button(){return"page_by_page"!==this.page_template||!0===this.publimodule.show_fs_button},first_media(){if(!this.publimodule.source_medias||0===this.publimodule.source_medias.length)return!1;const t=this.publimodule.source_medias[0];if(t){const e=this.getParent(this.publimodule.$path);return this.getSourceMedia({source_media:t,folder_path:e})}return!1},media_styles(){let t=0;return"center"===this.publimodule.align&&(66.6===this.publimodule.size?t=16.6:50===this.publimodule.size?t=25:33.3===this.publimodule.size&&(t=33.3)),"right"===this.publimodule.align&&(66.6===this.publimodule.size?t=33.3:50===this.publimodule.size?t=50:33.3===this.publimodule.size&&(t=66.6)),{"--module-width":this.publimodule.size||100,"--module-margin-left":t}}},methods:{async updateMeta(t){await this.$api.updateMeta({path:this.publimodule.$path,new_meta:t}).catch((t=>{throw this.$alertify.delay(4e3).error(t),t}))},enableEditForText(){this.$nextTick((()=>{this.$refs.textBloc&&this.$refs.textBloc.enableEditor()}))},async duplicateModule(){let t={};"page_by_page"===this.page_template&&(t.x=(this.publimodule.x||0)+10,t.y=(this.publimodule.y||0)+10);const e=await this.duplicateModuleWithSourceMedias({og_module:this.publimodule,addtl_meta_to_module:t});this.$emit("duplicate",e)},async removeModule(){await this.$api.deleteItem({path:this.publimodule.$path}).catch((t=>{throw this.$alertify.delay(4e3).error(t),t})),this.$emit("remove")}}},w=g,y=(i(85163),(0,u.Z)(w,a,o,!1,null,"b2d08bba",null)),M=y.exports},14894:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return c}});var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"_storyTemplate"},[t.can_edit?i("div",{staticClass:"_settings"},[i("details",[i("summary",[t._v(t._s(t.$t("settings")))]),i("RangeValueInput",{staticClass:"u-spacingBottom",attrs:{label:t.$t("story_width"),value:t.publication.story_width,min:0,max:2400,step:1,ticks:[320,480,800,1200,2400],default_value:800,suffix:"px"},on:{save:function(e){return t.updatePubliMeta({story_width:e})}}}),i("ToggleInput",{attrs:{content:!0!==t.publication.story_is_not_responsive,label:t.$t("responsive"),options:{true:t.$t("responsive_instr"),false:t.$t("not_responsive_instr")}},on:{"update:content":function(e){return t.updatePubliMeta({story_is_not_responsive:!e})}}})],1)]):t._e(),i("div",{staticClass:"_storyContainer"},[i("div",{staticClass:"_storyContent",style:t.story_styles},[i("transition-group",{attrs:{tag:"div",name:"StoryModules",appear:"",duration:700}},[t._l(t.modules_list,(function(e,a){return[i("PublicationModule",{key:e,staticClass:"_mediaPublication",attrs:{publimodule:t.findModuleFromMetaFilename(e),module_position:1===t.modules_list.length?"alone":0===a?"first":a===t.modules_list.length-1?"last":"inbetween",can_edit:t.can_edit},on:{resize:function(i){return t.resize({meta_filename:e,new_size:i})},moveUp:function(i){return t.moveTo({meta_filename:e,dir:-1})},moveDown:function(i){return t.moveTo({meta_filename:e,dir:1})},duplicate:function(i){return t.duplicatePublicationMedia({source_meta_filename:e,copy_meta_filename:i})},remove:function(i){return t.removeModuleFromList(e)}}}),i("div",{key:"mc_"+a,staticClass:"_spacer"},[t.can_edit?i("ModuleCreator",{attrs:{publication_path:t.publication.$path,meta_filenames_already_present:t.meta_filenames_already_present},on:{addModule:function(e){var i=e.meta_filename;return t.insertModuleMetaFilenameToList({meta_filename:i,index:a+1})}}}):t._e()],1)]}))],2)],1)]),!t.can_edit||t.modules_list&&0!==t.modules_list.length?t._e():i("ModuleCreator",{attrs:{publication_path:t.publication.$path},on:{addModule:t.appendModuleMetaFilenameToList}})],1)},o=[],s=(i(85827),i(57658),i(94989)),n=i(218),l={props:{publication:Object,can_edit:Boolean},components:{ModuleCreator:s.Z,PublicationModule:n.Z},data(){return{medias:[],fetch_publication_error:null}},created(){},async mounted(){},beforeDestroy(){},watch:{},computed:{story_styles(){const t=(this.publication.story_width||800)+"px";return!0===this.publication.story_is_not_responsive?{width:t,maxWidth:"none"}:{maxWidth:t}},modules_list(){if(this.publication.modules_list&&Array.isArray(this.publication.modules_list)){const t=this.publication.modules_list.reduce(((t,e)=>{const i=this.findModuleFromMetaFilename(e);return i&&t.push(e),t}),[]);return t}return[]},meta_filenames_already_present(){return this.modules_list.reduce(((t,e)=>{const i=this.findModuleFromMetaFilename(e);return i.source_medias&&i.source_medias.map((e=>{e.meta_filename_in_project&&t.push(e.meta_filename_in_project)})),t}),[])}},methods:{async appendModuleMetaFilenameToList({meta_filename:t}){const e=this.modules_list.slice();e.push(t),await this.updateMeta({new_meta:{modules_list:e}}),this.toggleNewModuleEdit({meta_filename:t})},async insertModuleMetaFilenameToList({meta_filename:t,index:e}){const i=this.modules_list.slice();i.splice(e,0,t),await this.updateMeta({new_meta:{modules_list:i}}),this.toggleNewModuleEdit({meta_filename:t})},async updatePubliMeta(t){return await this.$api.updateMeta({path:this.publication.$path,new_meta:t})},async updateMeta({new_meta:t}){this.fetch_status="pending",this.fetch_error=null;try{this.response=await this.$api.updateMeta({path:this.publication.$path,new_meta:t}),this.fetch_status="success"}catch(e){this.fetch_status="error",this.fetch_error=e.response.data}},findModuleFromMetaFilename(t){return this.publication.$files?this.publication.$files.find((e=>{const i=e.$path.substring(e.$path.lastIndexOf("/")+1);return i===t})):[]},async moveTo({meta_filename:t,dir:e}){let i=this.modules_list.slice();const a=i.findIndex((e=>e===t));return!(a+e<0)&&(!(a+e>i.length-1)&&(i.move(a,a+e),void(this.response=await this.updatePubliMeta({modules_list:i}))))},async duplicatePublicationMedia({source_meta_filename:t,copy_meta_filename:e}){let i=this.modules_list.slice();const a=i.findIndex((e=>e===t));i.splice(a+1,0,e),this.response=await this.updatePubliMeta({modules_list:i})},async removeModuleFromList(t){let e=this.modules_list.slice();e=e.filter((e=>e!==t)),this.response=await this.updatePubliMeta({modules_list:e})},toggleNewModuleEdit({meta_filename:t}){setTimeout((()=>{console.log(`emit module.enable_edit.${t}`),this.$eventHub.$emit(`module.enable_edit.${t}`)}),50)}}},r=l,d=(i(98548),i(1001)),u=(0,d.Z)(r,a,o,!1,null,"6b9642cd",null),c=u.exports},53024:function(t,e,i){"use strict";i.r(e);var a=i(8081),o=i.n(a),s=i(23645),n=i.n(s),l=n()(o());l.push([t.id,"._linkPicker[data-v-5f9b4bb8]{width:100%;margin:0 auto}._addMediaBtn[data-v-5f9b4bb8]{text-align:center;padding:calc(var(--spacing)*1)}._selectBtn[data-v-5f9b4bb8]{display:flex;place-items:center;justify-content:center;width:100%;gap:calc(var(--spacing)/1);background:#fff}iframe[data-v-5f9b4bb8]{width:100%;aspect-ratio:4/3}",""]),e["default"]=l},89162:function(t,e,i){"use strict";i.r(e);var a=i(8081),o=i.n(a),s=i(23645),n=i.n(s),l=n()(o());l.push([t.id,"._mediaPicker[data-v-2ce62bab]{width:100%;margin:0 auto}._addMediaBtn[data-v-2ce62bab]{text-align:center;padding:calc(var(--spacing)*1)}",""]),e["default"]=l},54246:function(t,e,i){"use strict";i.r(e);var a=i(8081),o=i.n(a),s=i(23645),n=i.n(s),l=n()(o());l.push([t.id,"._moduleCreator[data-v-1ba70b6d]{position:relative;display:flex;justify-content:center;align-items:center;width:100%;pointer-events:none;color:var(--c-bleuvert);border-radius:1rem;--icon-size:1.2rem}._moduleCreator>*[data-v-1ba70b6d]{pointer-events:auto}._typePicker[data-v-1ba70b6d]{display:flex;flex-flow:row wrap;justify-content:flex-start;gap:calc(var(--spacing)/4)}._dropNotice[data-v-1ba70b6d]{pointer-events:none}sl-icon-button[data-v-1ba70b6d]::part(base){font-size:1.5em;color:var(--c-bleuvert)}._showModuleSelector[data-v-1ba70b6d]{transition:all .4s cubic-bezier(.19,1,.22,1)}._sideBtns[data-v-1ba70b6d]{--side-width:24px;display:block;padding:calc(var(--spacing)/2);border-radius:calc(var(--side-width)/2);background:transparent;font-size:1.4em;color:var(--c-noir);display:flex}._sideBtns[data-v-1ba70b6d]:focus,._sideBtns[data-v-1ba70b6d]:hover{background:rgba(0,0,0,.1)}",""]),e["default"]=l},91023:function(t,e,i){"use strict";i.r(e);var a=i(8081),o=i.n(a),s=i(23645),n=i.n(s),l=n()(o());l.push([t.id,"._moduleMosaic[data-v-69869ebb]{--number_of_medias:1;position:relative}._mediaGrid[data-v-69869ebb]{position:relative;width:100%}._moduleMosaic.is--multipleMedias ._mediaGrid[data-v-69869ebb]{display:flex;flex-flow:row nowrap;gap:calc(var(--spacing)/4);transition:flex .25s cubic-bezier(.19,1,.22,1)}._mediaGrid>._mediaGrid--item[data-v-69869ebb]{position:relative;transition:flex .25s cubic-bezier(.19,1,.22,1)}._moduleMosaic.is--multipleMedias ._mediaGrid>._mediaGrid--item[data-v-69869ebb]{aspect-ratio:1/1;overflow:hidden;background:var(--c-gris_clair);flex:1 1 calc(100%/var(--number_of_medias))}._moduleMosaic.is--multipleMedias ._mediaGrid>._mediaGrid--item[data-v-69869ebb]  ._mediaContent{width:100%;height:100%}._moduleMosaic.is--multipleMedias ._mediaGrid>._mediaGrid--item[data-v-69869ebb]  ._mediaContent ._mediaContent--iframe,._moduleMosaic.is--multipleMedias ._mediaGrid>._mediaGrid--item[data-v-69869ebb]  ._mediaContent ._mediaContent--image,._moduleMosaic.is--multipleMedias ._mediaGrid>._mediaGrid--item[data-v-69869ebb]  ._mediaContent .plyr--video{position:absolute;height:100%;width:100%;-o-object-fit:cover;object-fit:cover;-o-object-fit:var(--object-fit);object-fit:var(--object-fit)}._mediaPickerTile[data-v-69869ebb]{position:absolute;top:0;left:auto;right:0;display:flex;place-content:center;height:100%;align-items:center;pointer-events:none}._mediaPickerTile>*[data-v-69869ebb]{pointer-events:auto}._btnRow[data-v-69869ebb]{position:absolute;padding:calc(var(--spacing)/2);top:0;right:0;left:auto;z-index:100;display:flex;flex-flow:row wrap;gap:calc(var(--spacing)/2)}._btnRow button[data-v-69869ebb]{border-radius:4px;color:#fff;text-shadow:0 0 4px rgba(0,0,0,.8)}._dropzone[data-v-69869ebb]{position:absolute;width:100%;height:100%}._dropzone[data-v-69869ebb]  ._dropNotice{transform:rotate(-90deg)}sl-icon-button[data-v-69869ebb]::part(base){font-size:1.5em;color:var(--c-bleuvert)}._noSourceMedia[data-v-69869ebb]{display:flex;align-items:center;justify-content:center;width:100%;height:100%}",""]),e["default"]=l},60099:function(t,e,i){"use strict";i.r(e);var a=i(8081),o=i.n(a),s=i(23645),n=i.n(s),l=n()(o());l.push([t.id,"._publicationModule[data-v-b2d08bba]{position:relative;padding:0 calc(var(--spacing)*2)}._publicationModule.is--shape ._content[data-v-b2d08bba],._publicationModule.is--shape svg[data-v-b2d08bba]{overflow:visible;stroke-linejoin:arcs;stroke-linecap:round}._publicationModule.is--shape svg[data-v-b2d08bba]{width:100%;height:100%}._publicationModule ._content[data-v-b2d08bba]{width:calc(var(--module-width)*1%);margin-left:calc(var(--module-margin-left)*1%);transition:all .4s cubic-bezier(.19,1,.22,1)}._sideOptions[data-v-b2d08bba]{position:absolute;top:0;height:100%;right:100%;background:var(--active-color);background:rgba(0,0,0,.05);pointer-events:none;display:flex;flex-flow:column nowrap;justify-content:space-between;--side-width:24px;width:var(--side-width);border-radius:calc(var(--side-width)/2)}._sideOptions.is--pageByPage[data-v-b2d08bba]{display:none}._sideOptions>*[data-v-b2d08bba]{pointer-events:auto}._sideBtns[data-v-b2d08bba]{display:block;width:var(--side-width);height:var(--side-width);padding:0;border-radius:calc(var(--side-width)/2);background:transparent}._sideBtns[data-v-b2d08bba]:focus,._sideBtns[data-v-b2d08bba]:hover{background:rgba(0,0,0,.1)}._advanced_menu[data-v-b2d08bba]{position:absolute;z-index:10;left:100%;top:50%;transform:translateY(-50%);background:#fff;background:var(--active-color);margin:2px;border-radius:4px;flex-flow:column nowrap}._advanced_menu[data-v-b2d08bba],._menu[data-v-b2d08bba]{padding:calc(var(--spacing)/2);display:flex;gap:calc(var(--spacing)/4)}._menu[data-v-b2d08bba]{width:100%;justify-content:flex-end}._menu.is--overlaid[data-v-b2d08bba]{position:absolute;top:0;right:0;z-index:10}._options[data-v-b2d08bba]{position:relative}._buttonRow[data-v-b2d08bba]{display:flex;gap:calc(var(--spacing)/4)}",""]),e["default"]=l},72957:function(t,e,i){"use strict";i.r(e);var a=i(8081),o=i.n(a),s=i(23645),n=i.n(s),l=n()(o());l.push([t.id,"._storyTemplate[data-v-6b9642cd]{display:flex;justify-content:center;flex-flow:column nowrap;align-items:center;margin:0 auto calc(var(--spacing)*4)}._settings[data-v-6b9642cd]{position:relative;top:0;right:0;display:flex;justify-content:flex-end;background:#fff;padding:calc(var(--spacing)/8) calc(var(--spacing)/4);margin:calc(var(--spacing)/2) auto 0;max-width:240px}._storyContainer[data-v-6b9642cd]{width:100%}._storyContent[data-v-6b9642cd]{width:100%;background:#fff;max-width:800px;padding:calc(var(--spacing)*1) 0;margin:calc(var(--spacing)/2) auto;border-radius:6px;box-shadow:0 1px 4px rgba(0,0,0,.2);transition:all .4s cubic-bezier(.19,1,.22,1)}._mediaPublication[data-v-6b9642cd]{position:relative;margin-bottom:0}._mediaPublication[data-v-6b9642cd]  ._content{min-height:72px}._mediaPublication[data-v-6b9642cd]  ._floatingEditBtn[data-action=disable]{display:none}._spacer[data-v-6b9642cd]{min-height:3rem;display:flex;align-items:center;justify-content:center;padding:calc(var(--spacing)/4) 0}",""]),e["default"]=l},70586:function(t,e,i){var a=i(53024);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var o=i(31982).Z;o("652c5b6c",a,!0,{sourceMap:!1,shadowMode:!1})},7298:function(t,e,i){var a=i(89162);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var o=i(31982).Z;o("fe556992",a,!0,{sourceMap:!1,shadowMode:!1})},95539:function(t,e,i){var a=i(54246);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var o=i(31982).Z;o("6506654f",a,!0,{sourceMap:!1,shadowMode:!1})},1420:function(t,e,i){var a=i(91023);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var o=i(31982).Z;o("1e61219b",a,!0,{sourceMap:!1,shadowMode:!1})},85163:function(t,e,i){var a=i(60099);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var o=i(31982).Z;o("5ec387be",a,!0,{sourceMap:!1,shadowMode:!1})},98548:function(t,e,i){var a=i(72957);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var o=i(31982).Z;o("0a0c257e",a,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=894.js.map